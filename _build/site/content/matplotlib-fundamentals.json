{"version":2,"kind":"Article","sha256":"e132b44d9f0add0dfcae382f49bb525621552cc7bb352366620bd9f78f73bfe5","slug":"matplotlib-fundamentals","location":"/03-scientific-computing-with-python/02-scientific-computing-core/08-matplotlib-fundamentals.md","dependencies":[],"frontmatter":{"title":"Chapter 8: Matplotlib - Visualizing Your Universe","content_includes_title":false,"authors":[{"nameParsed":{"literal":"Anna Rosen","given":"Anna","family":"Rosen"},"name":"Anna Rosen","orcid":"0000-0003-4423-0660","email":"alrosen@sdsu.edu","affiliations":["San Diego State University"],"id":"contributors-myst-generated-uid-0","corresponding":true}],"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"MIT","url":"https://opensource.org/licenses/MIT","name":"MIT License","free":true,"osi":true}},"github":"https://github.com/astrobytes-edu/astr596-modeling-universe","subject":"Modeling the Universe","venue":{"title":"ASTR 596 - Fall 2025","url":"https://www.anna-rosen.com"},"keywords":["computational astrophysics","python","numerical methods","machine learning","monte carlo","neural networks","radiative transfer","bayesian inference","JAX"],"affiliations":[{"id":"San Diego State University","name":"San Diego State University"}],"numbering":{"title":{"offset":2}},"edit_url":"https://github.com/astrobytes-edu/astr596-modeling-universe/blob/main/03-scientific-computing-with-python/02-scientific-computing-core/08-matplotlib-fundamentals.md","exports":[{"format":"md","filename":"08-matplotlib-fundamentals.md","url":"/08-matplotlib-fundam-eb2ff58bd472ae4c15481e6bcde16aa1.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Learning Objectives","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yq0UCa5sGH"}],"identifier":"learning-objectives","label":"Learning Objectives","html_id":"learning-objectives","implicit":true,"key":"xXDoamLTDw"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"By the end of this chapter, you will be able to:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yp7jfudeXC"}],"key":"yO2ZO4lGKq"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Create publication-quality scientific plots using Matplotlib’s object-oriented interface","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"njlk9OW6uQ"}],"key":"FOJCWvf87F"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Master the anatomy of a figure: axes, subplots, labels, and legends","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"skkShc9tWG"}],"key":"aZFEcRSbA3"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Visualize astronomical data including light curves, spectra, and images","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"CbV0ITmRE5"}],"key":"vpf7DR8a4W"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Choose appropriate scaling (linear, log, semilog) for different data relationships","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"TQUBVx8ckL"}],"key":"bajg0AnlUk"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Experiment iteratively to find the most revealing visualization","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"DHg8crxSYA"}],"key":"Nvk5BwfXOs"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Build reusable plotting modules for common astronomical visualizations","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"TuADNN02fv"}],"key":"oZvReAiuU3"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Apply appropriate color maps and scaling for different types of data","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"ZEtIgimRpc"}],"key":"D9L68Ttp9a"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Export figures in various formats with proper resolution and sizing","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"uByrCjRA00"}],"key":"AuGf1XUBMn"}],"key":"hiHzoSazUz"},{"type":"heading","depth":2,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Prerequisites Check","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Jobb4o4vUy"}],"identifier":"prerequisites-check","label":"Prerequisites Check","html_id":"prerequisites-check","implicit":true,"key":"cLqt2jKiwk"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Before starting this chapter, verify you can:","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"jPwLRVWCes"}],"key":"yUo0fVTyJy"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"✓ Create and manipulate NumPy arrays (Chapter 7)","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"TvmXuiDRLb"}],"key":"rBNG8s4Bqa"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"✓ Perform array operations and indexing (Chapter 7)","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"PWRW1gp62J"}],"key":"I8nn27b8qR"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"✓ Use array methods like mean(), std(), max() (Chapter 7)","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"eKPTFG0HeC"}],"key":"DCeULp3j2e"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"✓ Generate random numbers with NumPy (Chapter 7)","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"MxWIoJKz24"}],"key":"V4pxq4EdBz"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"✓ Work with 2D arrays and meshgrid (Chapter 7)","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"ILKSjZ4LHk"}],"key":"U6D5WEUllI"},{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"✓ Read and write files (Chapter 6)","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"VsyqnLyEhC"}],"key":"R2G3Y0QP8l"}],"key":"ia8ShrKnV7"},{"type":"heading","depth":3,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Self-Assessment Diagnostic","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"jR95wuIqOm"}],"identifier":"self-assessment-diagnostic","label":"Self-Assessment Diagnostic","html_id":"self-assessment-diagnostic","implicit":true,"key":"YG63sWgNof"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Test your readiness by predicting the outputs and identifying any issues:","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"gUoO0JcBUB"}],"key":"gmJQMneeKS"}],"key":"ZdInocsMCS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\n\n# Question 1: What shape will this array have?\nx = np.linspace(0, 10, 100)\ny = np.sin(x)\n# Shape of y: _______\n\n# Question 2: What will this boolean mask select?\ndata = np.array([1, 5, 3, 8, 2, 9])\nmask = data > 5\nselected = data[mask]\n# selected contains: _______\n\n# Question 3: What's wrong with this code?\n# matrix = np.array([[1, 2], [3, 4]])\n# result = matrix + [10, 20, 30]  # Will this work?\n# Your answer: _______\n\n# Question 4: What will this create?\nX, Y = np.meshgrid(np.arange(5), np.arange(3))\n# Shape of X and Y: _______","key":"X9i7VVEKUf"},{"type":"output","id":"_FaxqA2GxuVyjhjbS2AcB","data":[],"key":"j2uMxbgaGA"}],"key":"KDUhdcGhCf"},{"type":"block","children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Self-Assessment Answers","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"JKyYQedpWl"}],"key":"eqa4fyzpfF"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":54,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"Shape of y: ","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"F5JJl4HKiI"},{"type":"inlineCode","value":"(100,)","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"xX4QGHhX7N"},{"type":"text","value":" - 1D array with 100 elements","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"H8Xc240gwu"}],"key":"o5u4q4vF1j"},{"type":"listItem","spread":true,"position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"selected contains: ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"o8pBwbQbHr"},{"type":"inlineCode","value":"[8, 9]","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"ZAbGue0Uqq"},{"type":"text","value":" - values greater than 5","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"BfIv1b6LMM"}],"key":"dyQYi4CbS4"},{"type":"listItem","spread":true,"position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"Broadcasting error - shapes (2,2) and (3,) are incompatible","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"pLVUbumB4j"}],"key":"gUNRM9o4cS"},{"type":"listItem","spread":true,"position":{"start":{"line":57,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"Shape of X and Y: Both are ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"IrxXjGnSiD"},{"type":"inlineCode","value":"(3, 5)","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"Wi1EqvgliN"},{"type":"text","value":" - 2D grids","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"kfTSfRJRDY"}],"key":"mC9GVAjxvg"}],"key":"SBwj9mSxCn"},{"type":"paragraph","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"If you got all four correct, you’re ready for Matplotlib! If not, review Chapter 7.","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"y6FCI0sZwl"}],"key":"iQx1vMz6Tk"}],"key":"NwFyNcReLN"},{"type":"heading","depth":2,"position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"Chapter Overview","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"H1br0Dz5Gv"}],"identifier":"chapter-overview","label":"Chapter Overview","html_id":"chapter-overview","implicit":true,"key":"hhq5HIei8V"},{"type":"paragraph","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"Data without visualization is like a telescope without an eyepiece — you might have collected photons from distant galaxies, but you can’t see the universe they reveal. Every major astronomical discovery of the past century has been communicated through carefully crafted visualizations: Hubble’s plot showing the expanding universe (Hubble 1929), Hertzsprung and Russell’s diagram revealing stellar evolution, the power spectrum of the cosmic microwave background proving inflation theory. These weren’t just pretty pictures; they were visual arguments that changed our understanding of the cosmos. Matplotlib (Hunter 2007), the foundational plotting library for scientific Python, gives you the power to create these kinds of transformative visualizations, turning your NumPy arrays into insights that can be shared, published, and understood.","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"wleCRocweV"}],"key":"dY3uW2rap0"},{"type":"paragraph","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"text","value":"But here’s what many tutorials won’t tell you: Matplotlib isn’t just a plotting library — it’s an artist’s studio. Like an artist selecting brushes, canvases, and colors, you’ll learn to choose plot types, figure sizes, and colormaps that best express your data’s story. Creating a great visualization isn’t about following rigid rules; it’s about ","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"QgPZQ2uMq7"},{"type":"strong","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"text","value":"experimentation","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"Gsm0eY5jL3"}],"key":"X6tf2ikbjD"},{"type":"text","value":", iteration, and developing an aesthetic sense for what works. You’ll discover that the difference between a confusing plot and a revealing one often comes down to trying different scales — linear versus logarithmic, different color mappings, or simply adjusting the aspect ratio. This chapter embraces that experimental nature, teaching you not just the mechanics of plotting but the art of visual exploration. You’ll learn to approach each dataset as a unique challenge, trying multiple visualizations until you find the one that makes the patterns jump off the page.","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"sItm3tSS9N"}],"key":"dxMQu7AqlE"},{"type":"paragraph","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"This chapter introduces Matplotlib’s two main interfaces — ","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"UNsdsquPvH"},{"type":"strong","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"pyplot","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"x0F3vfbfZ5"}],"key":"rxalsICkEa"},{"type":"text","value":" for quick exploration and the ","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"yEdwgJI1TJ"},{"type":"strong","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"object-oriented API","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"CTNhxPzGgc"}],"key":"ZqzbySFICu"},{"type":"text","value":" for full control — but focuses on the latter because it’s what you’ll use for research. You’ll master the anatomy of a ","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"D2BDdSvde1"},{"type":"strong","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"figure","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"mJN38qHUno"}],"key":"H0PkAI7QAR"},{"type":"text","value":", understanding how figures contain ","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"bJ22KPaDVa"},{"type":"strong","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"axes","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"orwBHkm7Nn"}],"key":"dKI3g6zQ1O"},{"type":"text","value":", how axes contain plots, and how every element can be customized. You’ll learn the astronomical visualization canon: ","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"TCwVPrGsqt"},{"type":"strong","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"light curves","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"Qz7h6YtlOT"}],"key":"bZOe5NpL42"},{"type":"text","value":" that reveal exoplanets, ","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"RR5dpiLClb"},{"type":"strong","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"spectra","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"SoFfAq7M85"}],"key":"iEacp5uYvp"},{"type":"text","value":" that encode stellar chemistry, ","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"UPGN39Eipu"},{"type":"strong","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"color-magnitude diagrams","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"aFaPdniTqh"}],"key":"vZkx6uvP2w"},{"type":"text","value":" that map stellar populations, and images that capture the structure of galaxies. Most crucially, you’ll develop visualization taste — the ability to choose the right plot type, scale, and layout to honestly and effectively communicate your scientific findings. By the chapter’s end, you won’t just make plots; you’ll craft visual narratives that can stand alongside those historic diagrams that revolutionized astronomy. And you’ll have built your own library of plotting functions, turning common visualizations into single function calls that encode your hard-won knowledge about what works.","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"xqFOgoABmp"}],"key":"rNQpH7fKgk"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"📚 Essential Resource: Matplotlib Documentation","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"OxesupiOAm"}],"key":"LIe7QtRnzl"},{"type":"paragraph","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"Matplotlib is vast, and this chapter covers the essential ~20% you’ll use 80% of the time. The official documentation at ","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"IEd60PZUk9"},{"type":"strong","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"link","url":"https://matplotlib.org/","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"https://​matplotlib​.org/","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"YSb8ogqdw5"}],"urlSource":"https://matplotlib.org/","key":"AzUzfc2fYk"}],"key":"pLCf0oFM1K"},{"type":"text","value":" is your comprehensive reference for:","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"YlTIA9H8e9"}],"key":"a1IYf44BYk"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":75,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"Gallery of examples: ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"HjMNLdEoyg"},{"type":"link","url":"https://matplotlib.org/stable/gallery/index.html","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"https://​matplotlib​.org​/stable​/gallery​/index​.html","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"LYiuONYzPS"}],"urlSource":"https://matplotlib.org/stable/gallery/index.html","key":"FIgg6j9P17"}],"key":"rI9ukAhPKs"},{"type":"listItem","spread":true,"position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"Detailed API reference: ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"LCDfGVocbS"},{"type":"link","url":"https://matplotlib.org/stable/api/index.html","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"https://​matplotlib​.org​/stable​/api​/index​.html","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"oHjdSxvAZK"}],"urlSource":"https://matplotlib.org/stable/api/index.html","key":"stJ9fi2J5Q"}],"key":"Z0La9zi3da"},{"type":"listItem","spread":true,"position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"Tutorials for specific plot types","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"PjnmmU3exY"}],"key":"kcDhyVMTuE"},{"type":"listItem","spread":true,"position":{"start":{"line":78,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"text","value":"Colormaps reference: ","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"Rf4wN74XJ7"},{"type":"link","url":"https://matplotlib.org/stable/tutorials/colors/colormaps.html","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"text","value":"https://​matplotlib​.org​/stable​/tutorials​/colors​/colormaps​.html","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"rKhZKjeLdD"}],"urlSource":"https://matplotlib.org/stable/tutorials/colors/colormaps.html","key":"NryG1GvnlC"}],"key":"tgzsn7fomm"}],"key":"MLcocw12Pk"},{"type":"paragraph","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"strong","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"Pro tip","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"eOUJvmO31N"}],"key":"zyX3HZWVwS"},{"type":"text","value":": The Matplotlib gallery is incredibly valuable — find a plot similar to what you want, then adapt its code. Every plot in the gallery includes complete, downloadable source code. When you see a beautiful plot in a paper and wonder “How did they do that?”, the gallery often has the answer.","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"jrHx5iPKge"}],"key":"yQrBcl4J1U"},{"type":"paragraph","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"strong","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"Essential bookmark","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"xevH91sarW"}],"key":"yELQ34joZh"},{"type":"text","value":": The “Anatomy of a Figure” guide at ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"Eqo4pgEuQN"},{"type":"link","url":"https://matplotlib.org/stable/tutorials/introductory/usage.html","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"https://​matplotlib​.org​/stable​/tutorials​/introductory​/usage​.html","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"G2rSipMDqh"}],"urlSource":"https://matplotlib.org/stable/tutorials/introductory/usage.html","key":"Zh0Elj57gO"},{"type":"text","value":" — keep this open while learning!","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"VuOrRztCz0"}],"key":"TkLKFKcQCi"}],"class":"important","key":"d4rhTeBL0o"},{"type":"heading","depth":2,"position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"8.1 Matplotlib as Your Artistic Medium","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"txpNCdbVAA"}],"identifier":"id-8-1-matplotlib-as-your-artistic-medium","label":"8.1 Matplotlib as Your Artistic Medium","html_id":"id-8-1-matplotlib-as-your-artistic-medium","implicit":true,"key":"QfSGbOQYAg"},{"type":"paragraph","position":{"start":{"line":87,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"text","value":"{margin} ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"vyXytnpIpi"},{"type":"strong","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"pyplot","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"ysW5Cr43zm"}],"key":"hAZRMafHjp"},{"type":"text","value":"\nMatplotlib’s MATLAB-like procedural interface for quick plotting.","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"fyml8bt7Wo"}],"key":"A8oVP7UwQ7"},{"type":"paragraph","position":{"start":{"line":90,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"{margin} ","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"cNboiBXVBI"},{"type":"strong","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"text","value":"Object-Oriented API","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"Mdr4SkvED6"}],"key":"W9jnB0GWMf"},{"type":"text","value":"\nMatplotlib’s powerful interface providing full control over every plot element.","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"ZhUR3K59R7"}],"key":"LcOadVsk3N"},{"type":"paragraph","position":{"start":{"line":93,"column":1},"end":{"line":94,"column":1}},"children":[{"type":"text","value":"{margin} ","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"zgB7cuGDZH"},{"type":"strong","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"Figure","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"SuPe94EUkz"}],"key":"sqjm06380l"},{"type":"text","value":"\nThe overall container for all plot elements, like a canvas.","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"vN89Gj7wDA"}],"key":"sC5nGvpzVx"},{"type":"paragraph","position":{"start":{"line":96,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"text","value":"{margin} ","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"HJlJ5WX2xM"},{"type":"strong","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"children":[{"type":"text","value":"Axes","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"fBxQqwuxnb"}],"key":"qkg6JpEldA"},{"type":"text","value":"\nThe plotting area within a figure where data is visualized.","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"Nb3CgpKBXr"}],"key":"rR3Zbz3XLo"},{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":100,"column":1}},"children":[{"type":"text","value":"{margin} ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"O5xEzU83se"},{"type":"strong","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"Experimentation","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"n0zN1t698K"}],"key":"iMLx4bMXFD"},{"type":"text","value":"\nThe iterative process of trying different visualizations to find the most revealing representation.","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"idjGTNibgM"}],"key":"N8ZtI63Zlx"},{"type":"paragraph","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"text","value":"Before we dive into technical details, let’s establish a fundamental principle: creating visualizations is an inherently creative act. You’re not just displaying data; you’re making countless aesthetic choices that affect how your message is received. Consider these two philosophies:","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"TZtJTfSWVo"}],"key":"O1T2CLigzq"}],"key":"H3QDmi1tQP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\n# Generate some data - a damped oscillation\ntime = np.linspace(0, 10, 1000)\nsignal = np.exp(-time/3) * np.sin(2 * np.pi * time)\n\n# Approach 1: The Default Plot (technically correct but uninspiring)\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 5))\n\nax1.plot(time, signal)\nax1.set_title('Default: Technically Correct')\n\n# Approach 2: The Artistic Plot (same data, different choices)\nax2.plot(time, signal, color='#2E86AB', linewidth=2, alpha=0.8)\nax2.fill_between(time, signal, alpha=0.2, color='#2E86AB')\nax2.axhline(y=0, color='#A23B72', linestyle='-', linewidth=0.5, alpha=0.5)\nax2.set_xlabel('Time (s)', fontsize=11, fontweight='light')\nax2.set_ylabel('Amplitude', fontsize=11, fontweight='light')\nax2.set_title('Artistic: Same Data, Better Story', fontsize=13, fontweight='bold')\nax2.grid(True, alpha=0.15, linestyle='-', linewidth=0.5)\nax2.spines['top'].set_visible(False)\nax2.spines['right'].set_visible(False)\n\nplt.tight_layout()\nplt.show()","key":"QU3zd2Xtud"},{"type":"output","id":"Pb4lLVXBqNgFUXeWHRWpA","data":[],"key":"YilehFctMn"}],"key":"oUyFSCzr3w"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"Both plots show the same data, but the second one makes deliberate choices about color, transparency, and styling that make it more engaging. This is what we mean by being an artist with Matplotlib — every element is under your control, and those choices matter.","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"XwTfid4YxW"}],"key":"kaB3dy6Sn2"},{"type":"heading","depth":3,"position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"text","value":"The Experimentation Mindset","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"nc45NMPUTx"}],"identifier":"the-experimentation-mindset","label":"The Experimentation Mindset","html_id":"the-experimentation-mindset","implicit":true,"key":"SoCKaZEA7B"},{"type":"paragraph","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"Creating effective visualizations requires ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"HSaS61Kycy"},{"type":"strong","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"experimentation","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"TTtTsmS2S9"}],"key":"WqUJOLqp0P"},{"type":"text","value":". You rarely get it right on the first try. Here’s a realistic workflow:","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"cGkGtIQmun"}],"key":"rwY1kwBafg"}],"key":"r0C9p2cPqW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Real data: stellar magnitudes with a power-law distribution\nnp.random.seed(42)\nmasses = np.random.pareto(2.35, 1000) + 0.1  # Stellar IMF (Salpeter 1955)\nluminosities = masses ** 3.5  # Mass-luminosity relation\nluminosities += np.random.normal(0, 0.1 * luminosities)  # Add scatter\n\n# Try different visualizations to find what reveals the pattern best\nfig, axes = plt.subplots(2, 3, figsize=(12, 8))\n\n# Attempt 1: Simple scatter\naxes[0, 0].scatter(masses, luminosities, s=1, alpha=0.5)\naxes[0, 0].set_title('Linear Scale: Pattern Hidden')\naxes[0, 0].set_xlabel('Mass (M☉)')\naxes[0, 0].set_ylabel('Luminosity (L☉)')\n\n# Attempt 2: Log-log reveals power law!\naxes[0, 1].loglog(masses, luminosities, '.', markersize=2, alpha=0.5)\naxes[0, 1].set_title('Log-Log: Power Law Revealed!')\naxes[0, 1].set_xlabel('Mass (M☉)')\naxes[0, 1].set_ylabel('Luminosity (L☉)')\n\n# Attempt 3: Semilog-x (wrong choice for this data)\naxes[0, 2].semilogx(masses, luminosities, '.', markersize=2, alpha=0.5)\naxes[0, 2].set_title('Semilog-X: Not Helpful Here')\naxes[0, 2].set_xlabel('Mass (M☉)')\naxes[0, 2].set_ylabel('Luminosity (L☉)')\n\n# Attempt 4: 2D histogram for density\nh = axes[1, 0].hist2d(np.log10(masses), np.log10(luminosities), \n                       bins=30, cmap='YlOrRd')\naxes[1, 0].set_title('2D Histogram: Shows Density')\naxes[1, 0].set_xlabel('log(Mass)')\naxes[1, 0].set_ylabel('log(Luminosity)')\n\n# Attempt 5: Hexbin for large datasets\naxes[1, 1].hexbin(masses, luminosities, gridsize=20, \n                  xscale='log', yscale='log', cmap='Blues')\naxes[1, 1].set_title('Hexbin: Good for Large N')\naxes[1, 1].set_xlabel('Mass (M☉)')\naxes[1, 1].set_ylabel('Luminosity (L☉)')\n\n# Attempt 6: Contours with scatter overlay\nfrom scipy.stats import gaussian_kde\nxy = np.vstack([np.log10(masses), np.log10(luminosities)])\nz = gaussian_kde(xy)(xy)\nidx = z.argsort()\nx, y, z = np.log10(masses)[idx], np.log10(luminosities)[idx], z[idx]\naxes[1, 2].scatter(x, y, c=z, s=1, cmap='viridis')\naxes[1, 2].set_title('KDE-Colored: Shows Structure')\naxes[1, 2].set_xlabel('log(Mass)')\naxes[1, 2].set_ylabel('log(Luminosity)')\n\nplt.suptitle('Experimentation Reveals the Best Visualization', \n             fontsize=14, fontweight='bold')\nplt.tight_layout()\nplt.show()\n\nprint(\"Key Lesson: The log-log plot immediately reveals the power-law relationship\")\nprint(\"that was completely hidden in the linear plot. Always experiment!\")","key":"vORbgNPlD7"},{"type":"output","id":"JN0iGN7RYVUutFytazlq1","data":[],"key":"hOQKpBFqWP"}],"key":"Bfo4AbBTRx"},{"type":"block","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"🎯 The More You Know: How a Plot Saved Dark Energy","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"Ta0uFLvqaW"}],"key":"lJs6jBfnks"},{"type":"paragraph","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"text","value":"In 1998, two teams were racing to measure the universe’s deceleration by observing Type Ia supernovae — “standard candles” whose known brightness reveals their distance. The Supernova Cosmology Project, led by Saul Perlmutter, and the High-Z Supernova Search Team, led by Brian Schmidt and Adam Riess, expected to find the expansion slowing down due to gravity.","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"OPuim4N6bS"}],"key":"EtkaBREih5"},{"type":"paragraph","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"children":[{"type":"text","value":"The critical moment came not from sophisticated analysis but from visualization choices. The teams tried dozens of ways to plot their data: magnitude versus redshift, distance versus redshift, logarithmic scales, linear scales. Nothing showed a clear pattern. Then Adam Riess had an idea: instead of plotting raw magnitudes, plot the ","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"d1DSwsEBNq"},{"type":"emphasis","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"children":[{"type":"text","value":"residuals","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"dPoLgPnw94"}],"key":"C6PVpPEMdC"},{"type":"text","value":" — the difference between observed and expected magnitudes for a matter-only universe (Riess et al. 1998).","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"Uqgz2uSE3F"}],"key":"L2tPPu8GLw"},{"type":"code","lang":"python","value":"# Simplified version of the Nobel Prize-winning plot\nz = np.array([0.01, 0.1, 0.3, 0.5, 0.7, 0.9])  # Redshift\n# Expected magnitudes for matter-only universe\nm_expected = 5 * np.log10(z * 3000) + 25  # Simplified\n# Observed magnitudes (dimmer than expected!)\nm_observed = m_expected + 0.25 * z  # Supernovae are dimmer!\n\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 5))\n\n# Original plot - pattern not obvious\nax1.plot(z, m_observed, 'ro', markersize=8)\nax1.plot(z, m_expected, 'b--', label='Expected (matter only)')\nax1.set_xlabel('Redshift (z)')\nax1.set_ylabel('Magnitude')\nax1.set_title('Original Plot: Hard to See')\nax1.legend()\n\n# Residual plot - acceleration jumps out!\nax2.plot(z, m_observed - m_expected, 'ro', markersize=8)\nax2.axhline(y=0, color='k', linestyle='--', label='No acceleration')\nax2.set_xlabel('Redshift (z)')\nax2.set_ylabel('Δm (observed - expected)')\nax2.set_title('Residual Plot: Universe Accelerating!')\nax2.legend()","position":{"start":{"line":208,"column":1},"end":{"line":233,"column":1}},"key":"mYzoy4J7cO"},{"type":"paragraph","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"children":[{"type":"text","value":"The residual plot made it obvious: supernovae were consistently dimmer than expected. The universe wasn’t just expanding; it was accelerating! This visualization choice — the result of experimentation and artistic judgment — led to a Nobel Prize (Perlmutter et al. 1999). Sometimes the difference between confusion and clarity is how you choose to plot your data.","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"UbfNAR5BwX"}],"key":"l73bAbMFQF"}],"class":"note, story","key":"XEJYkq13aV"},{"type":"heading","depth":2,"position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"children":[{"type":"text","value":"8.2 Anatomy of a Figure","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"key":"MCE9uNawau"}],"identifier":"id-8-2-anatomy-of-a-figure","label":"8.2 Anatomy of a Figure","html_id":"id-8-2-anatomy-of-a-figure","implicit":true,"key":"GFAyjSHqWw"},{"type":"paragraph","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"children":[{"type":"text","value":"Understanding Matplotlib’s hierarchy is crucial for controlling your visualizations. Nicolas P. Rougier created the definitive visualization of this anatomy (Rougier 2018), which has become the standard reference:","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"key":"uKZfc0xPZX"}],"key":"TFubcC3f8T"}],"key":"y9LoyNYy0S"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# The Complete Anatomy of a Matplotlib Figure\n# Copyright (c) 2016 Nicolas P. Rougier - MIT License\n# Adapted from: http://github.com/rougier/figure-anatomy\n# This brilliant visualization shows every component of a Matplotlib figure\n\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom matplotlib.ticker import MultipleLocator, FuncFormatter\n\nnp.random.seed(123)\n\n# Create the figure with Rougier's specifications\nX = np.linspace(0.5, 3.5, 100)\nY1 = 3 + np.cos(X)\nY2 = 1 + np.cos(1 + X/0.75)/2\nY3 = np.random.uniform(Y1, Y2, len(X))\n\nfig = plt.figure(figsize=(8, 8), facecolor=\"w\")\nax = fig.add_subplot(1, 1, 1, aspect=1)\n\n# Configure the tick system\ndef minor_tick(x, pos):\n    if not x % 1.0:\n        return \"\"\n    return \"%.2f\" % x\n\nax.xaxis.set_major_locator(MultipleLocator(1.000))\nax.xaxis.set_minor_locator(MultipleLocator(0.250))\nax.yaxis.set_major_locator(MultipleLocator(1.000))\nax.yaxis.set_minor_locator(MultipleLocator(0.250))\nax.xaxis.set_minor_formatter(FuncFormatter(minor_tick))\n\nax.set_xlim(0, 4)\nax.set_ylim(0, 4)\n\nax.tick_params(which='major', width=1.0, length=10)\nax.tick_params(which='minor', width=1.0, length=5, labelsize=10, labelcolor='0.25')\n\n# Add the plot elements\nax.grid(linestyle=\"--\", linewidth=0.5, color='.25', zorder=-10)\nax.plot(X, Y1, c=(0.25, 0.25, 1.00), lw=2, label=\"Blue signal\", zorder=10)\nax.plot(X, Y2, c=(1.00, 0.25, 0.25), lw=2, label=\"Red signal\")\nax.scatter(X, Y3, c='w', edgecolors='black', linewidth=0.5)\n\nax.set_title(\"Anatomy of a figure\", fontsize=20)\nax.set_xlabel(\"X axis label\")\nax.set_ylabel(\"Y axis label\")\nax.legend(frameon=False)\n\n# Add annotations for each component\ndef circle(x, y, radius=0.15):\n    from matplotlib.patches import Circle\n    from matplotlib.patheffects import withStroke\n    circle = Circle((x, y), radius, clip_on=False, zorder=10, linewidth=1,\n                    edgecolor='black', facecolor=(0, 0, 0, .0125),\n                    path_effects=[withStroke(linewidth=5, foreground='w')])\n    ax.add_artist(circle)\n\ndef text(x, y, text):\n    ax.text(x, y, text, backgroundcolor=\"white\",\n            ha='center', va='top', weight='bold', color='blue')\n\n# Label all the components\ncircle(0.50, -0.05)\ntext(0.50, -0.25, \"Minor tick label\")\n\ncircle(4.00, 2.00)\ntext(4.00, 1.80, \"Major tick\")\n\ncircle(1.80, -0.22)\ntext(1.80, -0.4, \"X axis label\")\n\ncircle(1.75, 2.80)\ntext(1.75, 2.60, \"Line\\n(line plot)\")\n\ncircle(3.20, 1.75)\ntext(3.20, 1.55, \"Markers\\n(scatter plot)\")\n\ncircle(3.00, 3.00)\ntext(3.00, 2.80, \"Grid\")\n\ncircle(3.70, 3.75)\ntext(3.70, 3.55, \"Legend\")\n\ncircle(0.5, 0.5)\ntext(0.5, 0.3, \"Axes\")\n\ncircle(-0.3, 0.65)\ntext(-0.3, 0.45, \"Figure\")\n\n# Add the spines annotation\nax.annotate('Spines', xy=(4.0, 0.35), xycoords='data',\n            xytext=(3.3, 0.5), textcoords='data',\n            weight='bold', color='blue',\n            arrowprops=dict(arrowstyle='->', connectionstyle=\"arc3\", color='blue'))\n\nplt.suptitle(\"Credit: Nicolas P. Rougier (http://github.com/rougier/figure-anatomy)\",\n             fontsize=10, family=\"monospace\", color='.5')\nplt.tight_layout()\nplt.show()","key":"UG2Znoz9Kc"},{"type":"output","id":"HmsnBdkJe4oTCtiTgIv-l","data":[],"key":"qhx0deLlAf"}],"key":"YKAEmXjUtJ"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"children":[{"type":"text","value":"This brilliant visualization by Rougier (2018) shows how every element — from the figure container down to individual tick labels — forms part of Matplotlib’s hierarchical structure. Understanding these relationships is what gives you the power to customize every aspect of your plots.","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"key":"duOgF9YAyS"}],"key":"CsLcSYblJT"},{"type":"heading","depth":3,"position":{"start":{"line":347,"column":1},"end":{"line":347,"column":1}},"children":[{"type":"text","value":"Working with the Object-Oriented Interface","position":{"start":{"line":347,"column":1},"end":{"line":347,"column":1}},"key":"RHKhA5YRH7"}],"identifier":"working-with-the-object-oriented-interface","label":"Working with the Object-Oriented Interface","html_id":"working-with-the-object-oriented-interface","implicit":true,"key":"R9i8SV9mNa"},{"type":"paragraph","position":{"start":{"line":349,"column":1},"end":{"line":350,"column":1}},"children":[{"type":"text","value":"{margin} ","position":{"start":{"line":349,"column":1},"end":{"line":349,"column":1}},"key":"kkLIQ26j4q"},{"type":"strong","position":{"start":{"line":349,"column":1},"end":{"line":349,"column":1}},"children":[{"type":"text","value":"Backend","position":{"start":{"line":349,"column":1},"end":{"line":349,"column":1}},"key":"vE6z5tzklN"}],"key":"O9AaMmbERv"},{"type":"text","value":"\nThe rendering engine Matplotlib uses to create and display figures.","position":{"start":{"line":349,"column":1},"end":{"line":349,"column":1}},"key":"lWLoEH0kvz"}],"key":"rIi6aIIVwJ"},{"type":"paragraph","position":{"start":{"line":352,"column":1},"end":{"line":352,"column":1}},"children":[{"type":"text","value":"Now that you understand the anatomy, let’s see how to manipulate these elements:","position":{"start":{"line":352,"column":1},"end":{"line":352,"column":1}},"key":"J8qgjXj49q"}],"key":"yELC9N715s"}],"key":"sn7bKiguKu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create a figure with explicit control over components\nfig = plt.figure(figsize=(10, 6))\n\n# Add axes manually to see the structure\n# [left, bottom, width, height] in figure coordinates (0-1)\nax_main = fig.add_axes([0.1, 0.3, 0.7, 0.6])   # Main plot\nax_zoom = fig.add_axes([0.65, 0.6, 0.2, 0.2])  # Inset zoom\nax_residual = fig.add_axes([0.1, 0.05, 0.7, 0.2])  # Residual panel\n\n# Generate data\nx = np.linspace(0, 10, 100)\ny = np.sin(x) * np.exp(-x/10)\ny_model = np.sin(x) * np.exp(-x/10.5)  # Slightly different model\n\n# Main plot\nax_main.plot(x, y, 'ko', markersize=3, alpha=0.5, label='Data')\nax_main.plot(x, y_model, 'r-', linewidth=2, label='Model')\nax_main.set_ylabel('Signal', fontsize=12)\nax_main.legend(loc='upper right')\nax_main.grid(True, alpha=0.3)\n\n# Zoom inset\nzoom_mask = (x > 3) & (x < 5)\nax_zoom.plot(x[zoom_mask], y[zoom_mask], 'ko', markersize=2)\nax_zoom.plot(x[zoom_mask], y_model[zoom_mask], 'r-', linewidth=1)\nax_zoom.set_xlim(3, 5)\nax_zoom.grid(True, alpha=0.3)\nax_zoom.set_title('Zoom', fontsize=9)\n\n# Residuals\nresiduals = y - y_model\nax_residual.scatter(x, residuals, s=5, alpha=0.5, color='blue')\nax_residual.axhline(y=0, color='red', linestyle='--', linewidth=1)\nax_residual.set_xlabel('Time', fontsize=12)\nax_residual.set_ylabel('Residuals', fontsize=10)\nax_residual.grid(True, alpha=0.3)\n\nfig.suptitle('Explicit Control Over Figure Components', fontsize=14, fontweight='bold')\nplt.show()","key":"Lk5n0whp5U"},{"type":"output","id":"z47nxdL5hzkIBbITVWHCv","data":[],"key":"cRQRspqXfk"}],"key":"vulsUshRW9"},{"type":"block","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"💡 Computational Thinking Box: Figure Memory Management","position":{"start":{"line":396,"column":1},"end":{"line":396,"column":1}},"key":"XpymDzgWSE"}],"key":"EBQdu17lpc"},{"type":"paragraph","position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"children":[{"type":"strong","position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"children":[{"type":"text","value":"PATTERN: Managing Memory with Many Plots","position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"key":"IMS8CyQKft"}],"key":"XowKwSg3pw"}],"key":"YVoD3A74kp"},{"type":"paragraph","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"children":[{"type":"text","value":"When creating many figures in a loop (common when processing astronomical surveys), memory usage can explode if not managed properly:","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"hChYRXNvoy"}],"key":"y0vO5yE4fQ"},{"type":"code","lang":"python","value":"# BAD: Memory leak - figures accumulate!\nfor i in range(100):\n    plt.figure()\n    plt.plot(data[i])\n    plt.savefig(f'plot_{i}.png')\n    # Figure stays in memory!\n\n# GOOD: Explicitly close figures\nfor i in range(100):\n    fig, ax = plt.subplots()\n    ax.plot(data[i])\n    fig.savefig(f'plot_{i}.png')\n    plt.close(fig)  # Free memory!\n\n# BETTER: Use context manager\nfor i in range(100):\n    with plt.subplots() as (fig, ax):\n        ax.plot(data[i])\n        fig.savefig(f'plot_{i}.png')\n    # Automatically closed!","position":{"start":{"line":403,"column":1},"end":{"line":424,"column":1}},"key":"Jt3ggg7Yu7"},{"type":"paragraph","position":{"start":{"line":426,"column":1},"end":{"line":426,"column":1}},"children":[{"type":"text","value":"For large surveys processing thousands of objects, this difference between memory leak and proper management can mean the difference between success and crashing!","position":{"start":{"line":426,"column":1},"end":{"line":426,"column":1}},"key":"UuQARVrhoS"}],"key":"PVikLzHwDT"}],"class":"tip","key":"NUX9LSgYRq"},{"type":"heading","depth":2,"position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"children":[{"type":"text","value":"8.3 Choosing the Right Scale: Linear, Log, and Everything Between","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"key":"kYtKHwIN5N"}],"identifier":"id-8-3-choosing-the-right-scale-linear-log-and-everything-between","label":"8.3 Choosing the Right Scale: Linear, Log, and Everything Between","html_id":"id-8-3-choosing-the-right-scale-linear-log-and-everything-between","implicit":true,"key":"tViMTg7ej3"},{"type":"paragraph","position":{"start":{"line":431,"column":1},"end":{"line":432,"column":1}},"children":[{"type":"text","value":"{margin} ","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"key":"vMFEx8DZfp"},{"type":"strong","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"children":[{"type":"text","value":"Linear Scale","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"key":"Q7thGRTIYg"}],"key":"Mo4YKmP9XC"},{"type":"text","value":"\nEqual steps in data correspond to equal distances on the plot.","position":{"start":{"line":431,"column":1},"end":{"line":431,"column":1}},"key":"RON8UzzoE2"}],"key":"qu03RttMd0"},{"type":"paragraph","position":{"start":{"line":434,"column":1},"end":{"line":435,"column":1}},"children":[{"type":"text","value":"{margin} ","position":{"start":{"line":434,"column":1},"end":{"line":434,"column":1}},"key":"cXFHvFlO35"},{"type":"strong","position":{"start":{"line":434,"column":1},"end":{"line":434,"column":1}},"children":[{"type":"text","value":"Logarithmic Scale","position":{"start":{"line":434,"column":1},"end":{"line":434,"column":1}},"key":"Pfwg3o2kS2"}],"key":"gdJRb6kbbS"},{"type":"text","value":"\nEqual multiplicative factors correspond to equal distances on the plot.","position":{"start":{"line":434,"column":1},"end":{"line":434,"column":1}},"key":"hSajoHqFmj"}],"key":"gnx7ukCWMF"},{"type":"paragraph","position":{"start":{"line":437,"column":1},"end":{"line":438,"column":1}},"children":[{"type":"text","value":"{margin} ","position":{"start":{"line":437,"column":1},"end":{"line":437,"column":1}},"key":"b7Hp3y4lVV"},{"type":"strong","position":{"start":{"line":437,"column":1},"end":{"line":437,"column":1}},"children":[{"type":"text","value":"Power Law","position":{"start":{"line":437,"column":1},"end":{"line":437,"column":1}},"key":"OdNbwLIDkc"}],"key":"nwaQa1CfJ7"},{"type":"text","value":"\nA relationship where y ∝ x^n appears as a straight line on a log-log plot.","position":{"start":{"line":437,"column":1},"end":{"line":437,"column":1}},"key":"IwVXi8ZbYW"}],"key":"LZy1aCRMSv"},{"type":"paragraph","position":{"start":{"line":440,"column":1},"end":{"line":440,"column":1}},"children":[{"type":"text","value":"One of the most important skills in data visualization is choosing the right scale for your axes. The wrong scale can hide patterns; the right scale makes them obvious:","position":{"start":{"line":440,"column":1},"end":{"line":440,"column":1}},"key":"vcVUjsQEho"}],"key":"d3AWzhCH5g"}],"key":"OhflfwrClb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Generate different types of relationships\nx = np.logspace(-1, 3, 100)  # 0.1 to 1000\n\n# Different mathematical relationships\nlinear = 2 * x + 5\nquadratic = 0.5 * x**2\nexponential = np.exp(x/100)\npower_law = 10 * x**(-1.5)\nlogarithmic = 50 * np.log10(x) + 10\n\n# Create a comprehensive comparison\nfig, axes = plt.subplots(5, 4, figsize=(14, 16))\n\ndatasets = [\n    (linear, 'Linear: y = 2x + 5'),\n    (quadratic, 'Quadratic: y = 0.5x²'),\n    (exponential, 'Exponential: y = e^(x/100)'),\n    (power_law, 'Power Law: y = 10x^(-1.5)'),\n    (logarithmic, 'Logarithmic: y = 50log(x) + 10')\n]\n\nfor i, (data, title) in enumerate(datasets):\n    # Linear-linear\n    axes[i, 0].plot(x, data, 'b-', linewidth=2)\n    axes[i, 0].set_title(f'{title}\\nLinear-Linear')\n    axes[i, 0].grid(True, alpha=0.3)\n    \n    # Log-log\n    axes[i, 1].loglog(x, np.abs(data), 'r-', linewidth=2)\n    axes[i, 1].set_title('Log-Log')\n    axes[i, 1].grid(True, alpha=0.3, which='both')\n    \n    # Semilog-x\n    axes[i, 2].semilogx(x, data, 'g-', linewidth=2)\n    axes[i, 2].set_title('Semilog-X')\n    axes[i, 2].grid(True, alpha=0.3)\n    \n    # Semilog-y\n    axes[i, 3].semilogy(x, np.abs(data), 'm-', linewidth=2)\n    axes[i, 3].set_title('Semilog-Y')\n    axes[i, 3].grid(True, alpha=0.3)\n\n# Highlight which scale reveals linearity\naxes[0, 0].set_facecolor('#E8F4F8')  # Linear shows linear\naxes[2, 3].set_facecolor('#F8E8E8')  # Semilogy shows exponential\naxes[3, 1].set_facecolor('#F8F8E8')  # Loglog shows power law\naxes[4, 2].set_facecolor('#E8F8E8')  # Semilogx shows logarithmic\n\nfig.suptitle('Choose the Scale that Reveals Your Data\\'s Nature', \n             fontsize=16, fontweight='bold')\nplt.tight_layout()\nplt.show()\n\nprint(\"Key insight: The 'right' scale makes relationships linear!\")\nprint(\"- Power laws → log-log\")\nprint(\"- Exponential growth → semilog-y\")\nprint(\"- Logarithmic growth → semilog-x\")","key":"XrMKs547YL"},{"type":"output","id":"MQQ5-M6CwlYJp-QVwEO4q","data":[],"key":"UFoIIoJ2r8"}],"key":"hfQEwHdOrU"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":502,"column":1},"end":{"line":502,"column":1}},"children":[{"type":"text","value":"Practical Guidelines for Scale Selection","position":{"start":{"line":502,"column":1},"end":{"line":502,"column":1}},"key":"OUcoUyPFxf"}],"identifier":"practical-guidelines-for-scale-selection","label":"Practical Guidelines for Scale Selection","html_id":"practical-guidelines-for-scale-selection","implicit":true,"key":"KgZvm3Ilqt"}],"key":"AQwaMhQ8Lq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Real astronomical example: Galaxy luminosity function\nnp.random.seed(42)\n\n# Schechter function parameters (Schechter 1976)\nL_star = 1e10  # Characteristic luminosity\nalpha = -1.25  # Faint-end slope\nphi_star = 0.01  # Normalization\n\n# Generate galaxy luminosities\nL = np.logspace(7, 12, 1000)\nphi = phi_star * (L/L_star)**alpha * np.exp(-L/L_star)\n\n# Add observational scatter\nobserved_phi = phi * np.random.lognormal(0, 0.2, len(phi))\n\nfig, axes = plt.subplots(2, 2, figsize=(10, 10))\n\n# Linear scale - useless for this data\naxes[0, 0].plot(L, observed_phi, '.', markersize=1, alpha=0.5)\naxes[0, 0].set_xlabel('Luminosity (L☉)')\naxes[0, 0].set_ylabel('Φ (Number density)')\naxes[0, 0].set_title('Linear Scale: Cannot See Structure')\n\n# Log-log - reveals power law at faint end\naxes[0, 1].loglog(L, observed_phi, '.', markersize=1, alpha=0.5, label='Data')\naxes[0, 1].loglog(L, phi, 'r-', linewidth=2, label='Schechter Function')\naxes[0, 1].set_xlabel('Luminosity (L☉)')\naxes[0, 1].set_ylabel('Φ (Number density)')\naxes[0, 1].set_title('Log-Log: Reveals Power Law + Exponential Cutoff')\naxes[0, 1].legend()\n\n# Semilog-y - emphasizes exponential cutoff\naxes[1, 0].semilogx(L, observed_phi, '.', markersize=1, alpha=0.5)\naxes[1, 0].semilogx(L, phi, 'r-', linewidth=2)\naxes[1, 0].set_xlabel('Luminosity (L☉)')\naxes[1, 0].set_ylabel('Φ (Number density)')\naxes[1, 0].set_title('Semilog-X: Emphasizes Bright End Cutoff')\n\n# Custom: log-log with ratio to model\nratio = observed_phi / phi\naxes[1, 1].semilogx(L, ratio, '.', markersize=1, alpha=0.5)\naxes[1, 1].axhline(y=1, color='red', linestyle='--', linewidth=2)\naxes[1, 1].set_xlabel('Luminosity (L☉)')\naxes[1, 1].set_ylabel('Observed / Model')\naxes[1, 1].set_title('Residual Plot: Shows Systematic Deviations')\naxes[1, 1].set_ylim(0.1, 10)\n\nfig.suptitle('Galaxy Luminosity Function: Scale Choice Matters', \n             fontsize=14, fontweight='bold')\nplt.tight_layout()\nplt.show()","key":"vRFbptWzNy"},{"type":"output","id":"wFmXZDx96yeCdXxkQJ-nx","data":[],"key":"AzpUT4ckSf"}],"key":"m5Zf2yUpRP"},{"type":"block","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"🔍 Check Your Understanding","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"key":"coCpoFxMLX"}],"key":"X0KecC3mQA"},{"type":"paragraph","position":{"start":{"line":561,"column":1},"end":{"line":561,"column":1}},"children":[{"type":"text","value":"You have data showing radioactive decay: counts versus time. Which scale would best reveal the half-life?","position":{"start":{"line":561,"column":1},"end":{"line":561,"column":1}},"key":"V0zf9kU90B"}],"key":"crUJTPwByT"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Answer","position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"key":"GygqB62NNY"}],"key":"C6rx42s8eO"},{"type":"paragraph","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"children":[{"type":"strong","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"children":[{"type":"text","value":"Semilog-y (linear time, log counts)","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"key":"jAkJN4juKR"}],"key":"MDxF7s33lH"},{"type":"text","value":" is the best choice!","position":{"start":{"line":564,"column":1},"end":{"line":564,"column":1}},"key":"SltUkeuhQg"}],"key":"ESnwYntx67"},{"type":"paragraph","position":{"start":{"line":566,"column":1},"end":{"line":567,"column":1}},"children":[{"type":"text","value":"Radioactive decay follows N(t) = N₀ * e^(-λt), which becomes:\nlog(N) = log(N₀) - λt","position":{"start":{"line":566,"column":1},"end":{"line":566,"column":1}},"key":"YJq5eDpidL"}],"key":"nZaWnMGwQ8"},{"type":"paragraph","position":{"start":{"line":569,"column":1},"end":{"line":569,"column":1}},"children":[{"type":"text","value":"On a semilog-y plot, this appears as a straight line with slope -λ. The half-life is clearly visible as the time for the counts to drop by half (constant vertical distance on the log scale).","position":{"start":{"line":569,"column":1},"end":{"line":569,"column":1}},"key":"AKdBbmpFuc"}],"key":"E41GRy86tK"},{"type":"code","lang":"python","value":"t = np.linspace(0, 5, 100)\nN0 = 1000\nhalf_life = 1.5\ndecay_rate = np.log(2) / half_life\ncounts = N0 * np.exp(-decay_rate * t)\n\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(10, 4))\n\n# Linear - curve makes half-life hard to read\nax1.plot(t, counts)\nax1.set_title('Linear: Half-life unclear')\n\n# Semilog-y - straight line, half-life obvious\nax2.semilogy(t, counts)\nax2.axhline(y=N0/2, color='r', linestyle='--', label=f't₁/₂ = {half_life}')\nax2.set_title('Semilog-y: Half-life clear!')\nax2.legend()","position":{"start":{"line":571,"column":1},"end":{"line":589,"column":1}},"key":"qPDEhRS6ja"}],"key":"G39G5Pk4fO"}],"class":"question","key":"qfozgWA6BC"},{"type":"code","lang":"","value":"\n## 8.4 Building Your Plotting Toolkit: Reusable Functions\n\nAs you develop as a scientific programmer, you'll find yourself making similar plots repeatedly. Instead of copying and pasting code, build a library of plotting functions that encode your hard-won knowledge about what works:\n\n```{code-cell} python\n# Example: A reusable light curve plotting function\ndef plot_light_curve(time, flux, flux_err=None, period=None, \n                     title=None, figsize=(12, 8)):\n    \"\"\"\n    Create a publication-quality light curve plot with optional phase folding.\n    \n    Parameters\n    ----------\n    time : array-like\n        Time values (days)\n    flux : array-like\n        Flux or magnitude values\n    flux_err : array-like, optional\n        Flux uncertainties\n    period : float, optional\n        Period for phase folding (days)\n    title : str, optional\n        Plot title\n    figsize : tuple, optional\n        Figure size (width, height)\n    \n    Returns\n    -------\n    fig, axes : matplotlib figure and axes objects\n    \"\"\"\n    if period is not None:\n        fig, axes = plt.subplots(2, 2, figsize=figsize)\n        axes = axes.flatten()\n    else:\n        fig, axes = plt.subplots(1, 1, figsize=(figsize[0], figsize[1]/2))\n        axes = [axes]  # Make it iterable\n    \n    # Main light curve\n    ax = axes[0]\n    if flux_err is not None:\n        ax.errorbar(time, flux, yerr=flux_err, fmt='k.', markersize=2,\n                   alpha=0.5, elinewidth=0.5, capsize=0)\n    else:\n        ax.scatter(time, flux, s=1, alpha=0.5, color='black')\n    \n    ax.set_xlabel('Time (days)', fontsize=11)\n    ax.set_ylabel('Relative Flux', fontsize=11)\n    ax.set_title('Light Curve' if title is None else title, fontsize=12)\n    ax.grid(True, alpha=0.3)\n    \n    # If period provided, add phase-folded plot\n    if period is not None:\n        phase = (time % period) / period\n        \n        # Phase folded\n        ax = axes[1]\n        if flux_err is not None:\n            ax.errorbar(phase, flux, yerr=flux_err, fmt='b.', markersize=2,\n                       alpha=0.3, elinewidth=0.5, capsize=0)\n        else:\n            ax.scatter(phase, flux, s=1, alpha=0.3, color='blue')\n        ax.set_xlabel('Phase', fontsize=11)\n        ax.set_ylabel('Relative Flux', fontsize=11)\n        ax.set_title(f'Phase Folded (P = {period:.3f} days)', fontsize=12)\n        ax.set_xlim(0, 1)\n        ax.grid(True, alpha=0.3)\n        \n        # Double-plotted phase folded\n        ax = axes[2]\n        phase_double = np.concatenate([phase, phase + 1])\n        flux_double = np.concatenate([flux, flux])\n        if flux_err is not None:\n            err_double = np.concatenate([flux_err, flux_err])\n            ax.errorbar(phase_double, flux_double, yerr=err_double, \n                       fmt='r.', markersize=2, alpha=0.3, \n                       elinewidth=0.5, capsize=0)\n        else:\n            ax.scatter(phase_double, flux_double, s=1, alpha=0.3, color='red')\n        ax.set_xlabel('Phase', fontsize=11)\n        ax.set_ylabel('Relative Flux', fontsize=11)\n        ax.set_title('Double Phase Plot', fontsize=12)\n        ax.set_xlim(0, 2)\n        ax.grid(True, alpha=0.3)\n        \n        # Binned phase curve\n        ax = axes[3]\n        n_bins = 50\n        phase_bins = np.linspace(0, 1, n_bins + 1)\n        binned_flux = []\n        binned_err = []\n        bin_centers = []\n        \n        for i in range(n_bins):\n            mask = (phase >= phase_bins[i]) & (phase < phase_bins[i+1])\n            if mask.sum() > 0:\n                binned_flux.append(np.median(flux[mask]))\n                binned_err.append(np.std(flux[mask]) / np.sqrt(mask.sum()))\n                bin_centers.append((phase_bins[i] + phase_bins[i+1]) / 2)\n        \n        ax.errorbar(bin_centers, binned_flux, yerr=binned_err,\n                   fmt='go-', markersize=4, linewidth=1, capsize=3)\n        ax.set_xlabel('Phase', fontsize=11)\n        ax.set_ylabel('Relative Flux', fontsize=11)\n        ax.set_title(f'Binned ({n_bins} bins)', fontsize=12)\n        ax.set_xlim(0, 1)\n        ax.grid(True, alpha=0.3)\n    \n    plt.tight_layout()\n    return fig, axes\n\n# Test the function with synthetic data\nnp.random.seed(42)\ntime = np.linspace(0, 30, 500)\nperiod = 2.3456  # days\nphase = 2 * np.pi * time / period\nflux = 1.0 - 0.01 * np.sin(phase)**2  # Transit-like signal\nflux += np.random.normal(0, 0.002, len(time))  # Add noise\nflux_err = np.ones_like(flux) * 0.002\n\nfig, axes = plot_light_curve(time, flux, flux_err, period=period, \n                            title='Exoplanet Transit Light Curve')\nplt.show()\n\nprint(\"This reusable function encodes best practices:\")\nprint(\"- Automatic phase folding when period is provided\")\nprint(\"- Double phase plot to see continuity\")\nprint(\"- Binned version to see average behavior\")\nprint(\"- Consistent styling throughout\")\n```\n\n### Building a Personal Plotting Library\n\nHere's a template for organizing your plotting functions:\n\n```{code-cell} python\n# my_astro_plots.py - Your personal plotting library\n\ndef plot_spectrum(wavelength, flux, flux_err=None, lines=None, \n                  title=None, figsize=(12, 5)):\n    \"\"\"Plot a stellar spectrum with optional line identification.\"\"\"\n    fig, ax = plt.subplots(figsize=figsize)\n    \n    # Plot spectrum\n    ax.plot(wavelength, flux, 'k-', linewidth=0.8, label='Spectrum')\n    \n    if flux_err is not None:\n        ax.fill_between(wavelength, flux - flux_err, flux + flux_err,\n                        alpha=0.3, color='gray', label='Uncertainty')\n    \n    # Mark spectral lines\n    if lines is not None:\n        for wave, name in lines:\n            ax.axvline(x=wave, color='red', linestyle=':', alpha=0.5)\n            ax.text(wave, ax.get_ylim()[1]*0.95, name, \n                   rotation=90, va='top', ha='right', fontsize=8)\n    \n    ax.set_xlabel('Wavelength (Å)', fontsize=11)\n    ax.set_ylabel('Normalized Flux', fontsize=11)\n    ax.set_title('Spectrum' if title is None else title, fontsize=12)\n    ax.grid(True, alpha=0.3)\n    ax.legend(loc='best')\n    \n    return fig, ax\n\ndef plot_cmd(color, magnitude, title=None, figsize=(8, 10)):\n    \"\"\"Create a color-magnitude diagram.\"\"\"\n    fig, ax = plt.subplots(figsize=figsize)\n    \n    # 2D histogram for density\n    h = ax.hist2d(color, magnitude, bins=50, cmap='YlOrBr', \n                  density=True)\n    \n    ax.set_xlabel('Color (B-V)', fontsize=11)\n    ax.set_ylabel('Absolute Magnitude', fontsize=11)\n    ax.invert_yaxis()  # Astronomical convention\n    ax.set_title('Color-Magnitude Diagram' if title is None else title, \n                fontsize=12)\n    \n    plt.colorbar(h[3], ax=ax, label='Density')\n    \n    return fig, ax\n\ndef plot_finding_chart(ra, dec, image=None, sources=None, \n                       figsize=(10, 10)):\n    \"\"\"Create a finding chart with marked sources.\"\"\"\n    fig, ax = plt.subplots(figsize=figsize, \n                           subplot_kw={'projection': 'rectilinear'})\n    \n    if image is not None:\n        im = ax.imshow(image, cmap='gray_r', origin='lower',\n                      extent=[ra.min(), ra.max(), dec.min(), dec.max()])\n        plt.colorbar(im, ax=ax, label='Intensity')\n    \n    if sources is not None:\n        for source in sources:\n            circle = plt.Circle((source['ra'], source['dec']), \n                               source.get('radius', 0.1),\n                               fill=False, color='red', linewidth=2)\n            ax.add_patch(circle)\n            ax.text(source['ra'], source['dec'] + 0.15, \n                   source.get('name', ''), \n                   ha='center', color='red')\n    \n    ax.set_xlabel('RA (degrees)', fontsize=11)\n    ax.set_ylabel('Dec (degrees)', fontsize=11)\n    ax.set_title('Finding Chart', fontsize=12)\n    ax.invert_xaxis()  # RA increases to the left\n    \n    return fig, ax\n\n# Example usage\nprint(\"Your personal plotting library is ready!\")\nprint(\"Available functions:\")\nprint(\"  - plot_light_curve(): For time series photometry\")\nprint(\"  - plot_spectrum(): For spectroscopic data\") \nprint(\"  - plot_cmd(): For color-magnitude diagrams\")\nprint(\"  - plot_finding_chart(): For sky position plots\")\n```\n\n:::{admonition} 💡 Computational Thinking Box: DRY Principle in Plotting\n:class: tip\n\n**PATTERN: Don't Repeat Yourself (DRY)**\n\nEvery time you copy-paste plotting code, you're creating technical debt. Instead, abstract common patterns into functions:\n\n```python\n# BAD: Copying and modifying\nfig, ax = plt.subplots()\nax.plot(data1)\nax.set_xlabel('Time (s)')\nax.set_ylabel('Flux')\nax.grid(True, alpha=0.3)\n# ... 50 lines later, same code with data2\n\n# GOOD: Reusable function\ndef plot_time_series(data, xlabel='Time (s)', ylabel='Flux', **kwargs):\n    fig, ax = plt.subplots(**kwargs)\n    ax.plot(data)\n    ax.set_xlabel(xlabel)\n    ax.set_ylabel(ylabel)\n    ax.grid(True, alpha=0.3)\n    return fig, ax\n\n# Now you can customize without repetition\nfig1, ax1 = plot_time_series(data1, ylabel='X-ray Flux')\nfig2, ax2 = plot_time_series(data2, ylabel='Optical Flux')\n```\n\nBenefits:\n- Consistency across all your plots\n- Easy to update style everywhere at once\n- Encode domain knowledge (like inverting magnitude axis)\n- Share with collaborators\n- Build your reputation for quality figures","position":{"start":{"line":591,"column":1},"end":{"line":848,"column":1}},"key":"gWVuNUMfvL"},{"type":"heading","depth":2,"position":{"start":{"line":850,"column":1},"end":{"line":850,"column":1}},"children":[{"type":"text","value":"8.5 Essential Plot Types for Astronomy","position":{"start":{"line":850,"column":1},"end":{"line":850,"column":1}},"key":"l5sqN1UFjS"}],"identifier":"id-8-5-essential-plot-types-for-astronomy","label":"8.5 Essential Plot Types for Astronomy","html_id":"id-8-5-essential-plot-types-for-astronomy","implicit":true,"key":"VvPdtwydQo"},{"type":"paragraph","position":{"start":{"line":852,"column":1},"end":{"line":853,"column":1}},"children":[{"type":"text","value":"{margin} ","position":{"start":{"line":852,"column":1},"end":{"line":852,"column":1}},"key":"Pj55aUcNxB"},{"type":"strong","position":{"start":{"line":852,"column":1},"end":{"line":852,"column":1}},"children":[{"type":"text","value":"Light Curve","position":{"start":{"line":852,"column":1},"end":{"line":852,"column":1}},"key":"erR7pFum43"}],"key":"OE1h2BR8mU"},{"type":"text","value":"\nA plot showing how an object’s brightness varies over time.","position":{"start":{"line":852,"column":1},"end":{"line":852,"column":1}},"key":"C9rUG7PfGa"}],"key":"F9GIRC2OyL"},{"type":"paragraph","position":{"start":{"line":855,"column":1},"end":{"line":856,"column":1}},"children":[{"type":"text","value":"{margin} ","position":{"start":{"line":855,"column":1},"end":{"line":855,"column":1}},"key":"cCwQrm6fNW"},{"type":"strong","position":{"start":{"line":855,"column":1},"end":{"line":855,"column":1}},"children":[{"type":"text","value":"Spectrum","position":{"start":{"line":855,"column":1},"end":{"line":855,"column":1}},"key":"mWjmxEireu"}],"key":"x4Ux1KSBfD"},{"type":"text","value":"\nA plot showing intensity as a function of wavelength or frequency.","position":{"start":{"line":855,"column":1},"end":{"line":855,"column":1}},"key":"UHd8EiVb7L"}],"key":"UY1GeX0hVC"},{"type":"heading","depth":3,"position":{"start":{"line":858,"column":1},"end":{"line":858,"column":1}},"children":[{"type":"text","value":"Line Plots: Time Series and Spectra","position":{"start":{"line":858,"column":1},"end":{"line":858,"column":1}},"key":"Vthqa0tNp6"}],"identifier":"line-plots-time-series-and-spectra","label":"Line Plots: Time Series and Spectra","html_id":"line-plots-time-series-and-spectra","implicit":true,"key":"Dl4RGe1d6f"},{"type":"paragraph","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"children":[{"type":"strong","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"children":[{"type":"text","value":"Line plots","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"key":"aQk2CHOTel"}],"key":"ETnPeJwpiG"},{"type":"text","value":" are workhorses for astronomical data:","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"key":"sarxHKclGJ"}],"key":"ZtPugiFrfd"}],"key":"xpD3xa40cv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Generate realistic stellar spectrum\nnp.random.seed(42)\nwavelength = np.linspace(4000, 7000, 1000)  # Angstroms\ncontinuum = 1 - 0.0001 * (wavelength - 5500)**2 / 1e6  # Continuum shape\n\n# Add absorption lines (H-alpha, H-beta, etc.)\nlines = [(6563, 50, 0.3), (4861, 30, 0.25), (4340, 25, 0.2)]  # center, width, depth\nspectrum = continuum.copy()\nfor center, width, depth in lines:\n    spectrum *= (1 - depth * np.exp(-0.5 * ((wavelength - center) / width)**2))\n\n# Add noise\nspectrum += np.random.normal(0, 0.01, len(wavelength))\n\n# Create publication-quality spectrum plot\nfig, ax = plt.subplots(figsize=(12, 5))\n\nax.plot(wavelength, spectrum, 'k-', linewidth=0.8, label='Observed')\nax.axhline(y=1, color='gray', linestyle='--', alpha=0.5, label='Continuum')\n\n# Mark important lines\nfor center, width, depth in lines:\n    ax.axvline(x=center, color='red', linestyle=':', alpha=0.5)\n    ax.text(center, 0.65, f'{center}Å', rotation=90, \n            va='bottom', ha='right', fontsize=9)\n\nax.set_xlabel('Wavelength (Å)', fontsize=12)\nax.set_ylabel('Normalized Flux', fontsize=12)\nax.set_title('Stellar Spectrum with Balmer Lines', fontsize=14)\nax.set_xlim(4000, 7000)\nax.set_ylim(0.6, 1.1)\nax.grid(True, alpha=0.2)\nax.legend(loc='lower right')\n\nplt.tight_layout()\nplt.show()","key":"AyND9nHAo7"},{"type":"output","id":"zGmoSgsbRYgMiMFaXNZAM","data":[],"key":"LiqYenumnI"}],"key":"ugVE1kTcQP"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":901,"column":1},"end":{"line":901,"column":1}},"children":[{"type":"text","value":"Scatter Plots: Correlations and Diagrams","position":{"start":{"line":901,"column":1},"end":{"line":901,"column":1}},"key":"Owllm4SF9R"}],"identifier":"scatter-plots-correlations-and-diagrams","label":"Scatter Plots: Correlations and Diagrams","html_id":"scatter-plots-correlations-and-diagrams","implicit":true,"key":"OXaPpCkksm"},{"type":"paragraph","position":{"start":{"line":903,"column":1},"end":{"line":903,"column":1}},"children":[{"type":"strong","position":{"start":{"line":903,"column":1},"end":{"line":903,"column":1}},"children":[{"type":"text","value":"Scatter plots","position":{"start":{"line":903,"column":1},"end":{"line":903,"column":1}},"key":"i2Iq5pb1ds"}],"key":"laqndhA8Wv"},{"type":"text","value":" reveal relationships between variables:","position":{"start":{"line":903,"column":1},"end":{"line":903,"column":1}},"key":"r5iAavXYcS"}],"key":"F5DC3lG69t"}],"key":"RyXZfd8URj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create a color-magnitude diagram (CMD)\nnp.random.seed(42)\n\n# Main sequence stars\nn_ms = 500\ncolor_ms = np.random.uniform(-0.3, 2.0, n_ms)\nmag_ms = 4 * color_ms + np.random.normal(0, 0.5, n_ms) + 4\n\n# Red giants\nn_rg = 100\ncolor_rg = np.random.uniform(0.8, 2.0, n_rg)\nmag_rg = np.random.normal(0, 0.5, n_rg)\n\n# White dwarfs\nn_wd = 50\ncolor_wd = np.random.uniform(-0.3, 0.5, n_wd)\nmag_wd = np.random.normal(11, 0.5, n_wd)\n\n# Create the CMD\nfig, ax = plt.subplots(figsize=(8, 10))\n\nax.scatter(color_ms, mag_ms, c='navy', s=10, alpha=0.6, label='Main Sequence')\nax.scatter(color_rg, mag_rg, c='red', s=30, alpha=0.7, label='Red Giants')\nax.scatter(color_wd, mag_wd, c='lightblue', s=20, alpha=0.8, label='White Dwarfs')\n\nax.set_xlabel('B - V Color Index', fontsize=12)\nax.set_ylabel('V Magnitude', fontsize=12)\nax.set_title('Color-Magnitude Diagram\\n(Hertzsprung-Russell Diagram)', fontsize=14)\nax.invert_yaxis()  # Astronomical convention\nax.grid(True, alpha=0.3)\nax.legend(loc='upper left')\n\n# Add annotations\nax.annotate('Turn-off point', xy=(0.6, 6), xytext=(1.2, 7),\n            arrowprops=dict(arrowstyle='->', color='black', alpha=0.5))\n\nplt.tight_layout()\nplt.show()","key":"AfeojGo6qX"},{"type":"output","id":"I9tpgcucbdCp969EVm1cK","data":[],"key":"vEGDhUrcck"}],"key":"La6Kz2ymYH"},{"type":"block","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"⚠️ Common Bug Alert: Histogram Binning","position":{"start":{"line":946,"column":1},"end":{"line":946,"column":1}},"key":"OaUzmJMD2b"}],"key":"VqqYWMzN2C"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# DANGER: Wrong binning can hide or create features!\ndata = np.random.normal(0, 1, 1000)\n\nfig, axes = plt.subplots(1, 3, figsize=(12, 4))\n\n# Too few bins - loses structure\naxes[0].hist(data, bins=5)\naxes[0].set_title('Too Few Bins (5)')\n\n# Just right - shows distribution\naxes[1].hist(data, bins=30)\naxes[1].set_title('Appropriate Bins (30)')\n\n# Too many bins - adds noise\naxes[2].hist(data, bins=200)\naxes[2].set_title('Too Many Bins (200)')\n\nplt.tight_layout()\nplt.show()\n\n# Use Sturges' rule or Freedman-Diaconis rule for automatic binning:\n# bins='auto' uses the maximum of Sturges and Freedman-Diaconis","key":"L4g8irSMJr"},{"type":"output","id":"MGxXoNn8qSJYAQx-wZ7SF","data":[],"key":"HUSevflcFL"}],"key":"PiHHqq2XWR"},{"type":"paragraph","position":{"start":{"line":974,"column":1},"end":{"line":974,"column":1}},"children":[{"type":"text","value":"Always experiment with bin sizes or use automatic binning algorithms!","position":{"start":{"line":974,"column":1},"end":{"line":974,"column":1}},"key":"TxS3w943KA"}],"key":"JVz3qmnG2v"}],"class":"warning","key":"ImwIWwoGku"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"🔍 Check Your Understanding","position":{"start":{"line":977,"column":1},"end":{"line":977,"column":1}},"key":"OMRvl1toV6"}],"key":"ss0Egwh15d"},{"type":"paragraph","position":{"start":{"line":980,"column":1},"end":{"line":980,"column":1}},"children":[{"type":"text","value":"What’s the difference between ","position":{"start":{"line":980,"column":1},"end":{"line":980,"column":1}},"key":"EQFLqzCzJs"},{"type":"inlineCode","value":"plt.plot()","position":{"start":{"line":980,"column":1},"end":{"line":980,"column":1}},"key":"bNZlRYD6QP"},{"type":"text","value":" and ","position":{"start":{"line":980,"column":1},"end":{"line":980,"column":1}},"key":"ufuJ8NprVO"},{"type":"inlineCode","value":"ax.plot()","position":{"start":{"line":980,"column":1},"end":{"line":980,"column":1}},"key":"Al1ErqeY8e"},{"type":"text","value":"? When would you use each?","position":{"start":{"line":980,"column":1},"end":{"line":980,"column":1}},"key":"awiT9q4Zs3"}],"key":"g2WUUrLU90"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Answer","position":{"start":{"line":982,"column":1},"end":{"line":982,"column":1}},"key":"vlooIOhVUV"}],"key":"ZIm4vs5Lld"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":983,"column":1},"end":{"line":985,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":983,"column":1},"end":{"line":983,"column":1}},"children":[{"type":"inlineCode","value":"plt.plot()","position":{"start":{"line":983,"column":1},"end":{"line":983,"column":1}},"key":"RFYWqD1cdi"},{"type":"text","value":" uses the pyplot interface and operates on the “current” axes","position":{"start":{"line":983,"column":1},"end":{"line":983,"column":1}},"key":"mbbG52oLi5"}],"key":"vWfFMGdEqV"},{"type":"listItem","spread":true,"position":{"start":{"line":984,"column":1},"end":{"line":985,"column":1}},"children":[{"type":"inlineCode","value":"ax.plot()","position":{"start":{"line":984,"column":1},"end":{"line":984,"column":1}},"key":"yGONetT14c"},{"type":"text","value":" uses the object-oriented interface and explicitly specifies which axes to use","position":{"start":{"line":984,"column":1},"end":{"line":984,"column":1}},"key":"XSX4WKxB2k"}],"key":"i6zG2i7fF7"}],"key":"Eof2hWacEW"},{"type":"paragraph","position":{"start":{"line":986,"column":1},"end":{"line":986,"column":1}},"children":[{"type":"text","value":"Use ","position":{"start":{"line":986,"column":1},"end":{"line":986,"column":1}},"key":"aLpEWh0h3V"},{"type":"inlineCode","value":"plt.plot()","position":{"start":{"line":986,"column":1},"end":{"line":986,"column":1}},"key":"y8b5s7QKmX"},{"type":"text","value":" for:","position":{"start":{"line":986,"column":1},"end":{"line":986,"column":1}},"key":"pypbv71gYO"}],"key":"r6bj7968aY"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":987,"column":1},"end":{"line":990,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":987,"column":1},"end":{"line":987,"column":1}},"children":[{"type":"text","value":"Quick, exploratory plots","position":{"start":{"line":987,"column":1},"end":{"line":987,"column":1}},"key":"dg6ow8RvGv"}],"key":"WGQHi3OC1I"},{"type":"listItem","spread":true,"position":{"start":{"line":988,"column":1},"end":{"line":988,"column":1}},"children":[{"type":"text","value":"Simple single-panel figures","position":{"start":{"line":988,"column":1},"end":{"line":988,"column":1}},"key":"WGdYd4ARbu"}],"key":"LSzcd7V9j3"},{"type":"listItem","spread":true,"position":{"start":{"line":989,"column":1},"end":{"line":990,"column":1}},"children":[{"type":"text","value":"Interactive work in Jupyter notebooks","position":{"start":{"line":989,"column":1},"end":{"line":989,"column":1}},"key":"AJEMiXI4sY"}],"key":"h95GqNZrVP"}],"key":"LiiyMBmkOU"},{"type":"paragraph","position":{"start":{"line":991,"column":1},"end":{"line":991,"column":1}},"children":[{"type":"text","value":"Use ","position":{"start":{"line":991,"column":1},"end":{"line":991,"column":1}},"key":"r7j8VOX9Yi"},{"type":"inlineCode","value":"ax.plot()","position":{"start":{"line":991,"column":1},"end":{"line":991,"column":1}},"key":"w71FwueG9Q"},{"type":"text","value":" for:","position":{"start":{"line":991,"column":1},"end":{"line":991,"column":1}},"key":"JzuWcDyllH"}],"key":"j0ZLjD8zvL"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":992,"column":1},"end":{"line":996,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":992,"column":1},"end":{"line":992,"column":1}},"children":[{"type":"text","value":"Multi-panel figures","position":{"start":{"line":992,"column":1},"end":{"line":992,"column":1}},"key":"SEDDRTVE9t"}],"key":"stUPNxH1Ab"},{"type":"listItem","spread":true,"position":{"start":{"line":993,"column":1},"end":{"line":993,"column":1}},"children":[{"type":"text","value":"Publication-quality plots","position":{"start":{"line":993,"column":1},"end":{"line":993,"column":1}},"key":"leAufkih88"}],"key":"cTUzS56a1D"},{"type":"listItem","spread":true,"position":{"start":{"line":994,"column":1},"end":{"line":994,"column":1}},"children":[{"type":"text","value":"Any situation where you need fine control","position":{"start":{"line":994,"column":1},"end":{"line":994,"column":1}},"key":"p3KDnrNctF"}],"key":"JqDyceU22D"},{"type":"listItem","spread":true,"position":{"start":{"line":995,"column":1},"end":{"line":996,"column":1}},"children":[{"type":"text","value":"Scripts that generate many figures","position":{"start":{"line":995,"column":1},"end":{"line":995,"column":1}},"key":"W94fwsjkM7"}],"key":"eawlVXdKFK"}],"key":"jL0oV6qEMS"},{"type":"paragraph","position":{"start":{"line":997,"column":1},"end":{"line":997,"column":1}},"children":[{"type":"text","value":"In research, always prefer ","position":{"start":{"line":997,"column":1},"end":{"line":997,"column":1}},"key":"I50AbUTJpD"},{"type":"inlineCode","value":"ax.plot()","position":{"start":{"line":997,"column":1},"end":{"line":997,"column":1}},"key":"fGxxFIYDIp"},{"type":"text","value":" for reproducibility and control!","position":{"start":{"line":997,"column":1},"end":{"line":997,"column":1}},"key":"YagtPFJ1J8"}],"key":"FY1U6QNfTn"}],"key":"xxINZZdl5V"}],"class":"question","key":"tHPHQ7yRxk"},{"type":"code","lang":"","value":"\n## 8.6 Images and 2D Data Visualization\n\n{margin} **Colormap**\nA mapping from data values to colors for visualization.\n\n{margin} **Normalization**\nScaling data values to a standard range for display.\n\nAstronomical images require special consideration for display:\n\n```{code-cell} python\n# Create synthetic galaxy image\nnp.random.seed(42)\nx = np.linspace(-5, 5, 200)\ny = np.linspace(-5, 5, 200)\nX, Y = np.meshgrid(x, y)\n\n# Exponential disk profile\nR = np.sqrt(X**2 + Y**2)\ndisk = np.exp(-R / 1.5)\n\n# Add spiral arms (simplified)\ntheta = np.arctan2(Y, X)\nspiral = 1 + 0.3 * np.sin(2 * theta - R)\ngalaxy = disk * spiral\n\n# Add noise and background\ngalaxy += np.random.normal(0, 0.02, galaxy.shape)\ngalaxy += 0.1  # Sky background\n\n# Display with different scaling\nfig, axes = plt.subplots(2, 3, figsize=(12, 8))\n\n# Linear scale\nim1 = axes[0, 0].imshow(galaxy, cmap='gray', origin='lower')\naxes[0, 0].set_title('Linear Scale')\nplt.colorbar(im1, ax=axes[0, 0], fraction=0.046)\n\n# Log scale\nfrom matplotlib.colors import LogNorm\ngalaxy_positive = galaxy - galaxy.min() + 1e-3  # Ensure positive\nim2 = axes[0, 1].imshow(galaxy_positive, cmap='gray', \n                         norm=LogNorm(), origin='lower')\naxes[0, 1].set_title('Log Scale')\nplt.colorbar(im2, ax=axes[0, 1], fraction=0.046)\n\n# Histogram equalization (adaptive)\nfrom matplotlib.colors import PowerNorm\nim3 = axes[0, 2].imshow(galaxy, cmap='gray', \n                         norm=PowerNorm(gamma=0.5), origin='lower')\naxes[0, 2].set_title('Power Scale (γ=0.5)')\nplt.colorbar(im3, ax=axes[0, 2], fraction=0.046)\n\n# Different colormaps\nim4 = axes[1, 0].imshow(galaxy, cmap='viridis', origin='lower')\naxes[1, 0].set_title('Viridis Colormap')\nplt.colorbar(im4, ax=axes[1, 0], fraction=0.046)\n\nim5 = axes[1, 1].imshow(galaxy, cmap='hot', origin='lower')\naxes[1, 1].set_title('Hot Colormap')\nplt.colorbar(im5, ax=axes[1, 1], fraction=0.046)\n\nim6 = axes[1, 2].imshow(galaxy, cmap='twilight', origin='lower')\naxes[1, 2].set_title('Twilight Colormap')\nplt.colorbar(im6, ax=axes[1, 2], fraction=0.046)\n\nfor ax in axes.flat:\n    ax.set_xlabel('X (pixels)')\n    ax.set_ylabel('Y (pixels)')\n\nfig.suptitle('Galaxy Image with Different Displays', fontsize=14)\nplt.tight_layout()\nplt.show()\n```\n\n:::{admonition} 🌟 Why This Matters: Finding Exoplanets in Pixels\n:class: info, important\n\nThe Kepler Space Telescope (Borucki et al. 2010) discovered over 2,600 exoplanets not through pretty pictures, but through careful analysis of pixel data. Each star was just a few pixels on the CCD, and the challenge was detecting brightness changes of 0.01% buried in noise.\n\nThe key was visualization. The Kepler team developed specialized image displays showing:\n1. The target pixel file (TPF) - raw pixel values over time\n2. The optimal aperture - which pixels to sum for photometry\n3. The background estimation - critical for accurate measurements\n\n```python\n# Simplified Kepler pixel analysis\n# Create synthetic stellar image with transit\ntime_points = 50\nimage_size = 11\nimages = np.zeros((time_points, image_size, image_size))\n\n# Add star (Gaussian PSF)\nx, y = np.mgrid[0:image_size, 0:image_size]\nstar_x, star_y = 5, 5\nfor t in range(time_points):\n    psf = 1000 * np.exp(-((x - star_x)**2 + (y - star_y)**2) / 4)\n    \n    # Add transit dip\n    if 20 < t < 25:\n        psf *= 0.99  # 1% dip\n    \n    images[t] = psf + np.random.normal(0, 5, (image_size, image_size))\n\n# Optimal aperture (pixels to sum)\naperture = ((x - star_x)**2 + (y - star_y)**2) < 6\n\n# Extract light curve\nlight_curve = [img[aperture].sum() for img in images]\n```\n\nThis pixel-level visualization revealed not just transiting planets, but also asteroseismology signals, stellar rotation, and even reflected light from hot Jupiters. The ability to visualize and understand pixel data literally opened up new worlds!","position":{"start":{"line":999,"column":1},"end":{"line":1113,"column":1}},"key":"Jwgmq6Pp4U"},{"type":"heading","depth":2,"position":{"start":{"line":1115,"column":1},"end":{"line":1115,"column":1}},"children":[{"type":"text","value":"8.7 Color Theory and Publication Standards","position":{"start":{"line":1115,"column":1},"end":{"line":1115,"column":1}},"key":"iwwIIMPr5y"}],"identifier":"id-8-7-color-theory-and-publication-standards","label":"8.7 Color Theory and Publication Standards","html_id":"id-8-7-color-theory-and-publication-standards","implicit":true,"key":"CBtg3MFxuW"},{"type":"paragraph","position":{"start":{"line":1117,"column":1},"end":{"line":1118,"column":1}},"children":[{"type":"text","value":"{margin} ","position":{"start":{"line":1117,"column":1},"end":{"line":1117,"column":1}},"key":"HShqORwqSD"},{"type":"strong","position":{"start":{"line":1117,"column":1},"end":{"line":1117,"column":1}},"children":[{"type":"text","value":"DPI","position":{"start":{"line":1117,"column":1},"end":{"line":1117,"column":1}},"key":"TlIHFy03bU"}],"key":"KNnvrtNGsn"},{"type":"text","value":"\nDots per inch, determining figure resolution for printing or display.","position":{"start":{"line":1117,"column":1},"end":{"line":1117,"column":1}},"key":"SRNw32N0zi"}],"key":"lf0lSQIoCi"},{"type":"paragraph","position":{"start":{"line":1120,"column":1},"end":{"line":1121,"column":1}},"children":[{"type":"text","value":"{margin} ","position":{"start":{"line":1120,"column":1},"end":{"line":1120,"column":1}},"key":"dfL355EOre"},{"type":"strong","position":{"start":{"line":1120,"column":1},"end":{"line":1120,"column":1}},"children":[{"type":"text","value":"LaTeX","position":{"start":{"line":1120,"column":1},"end":{"line":1120,"column":1}},"key":"hBBZGK8peF"}],"key":"uSrSfqpmuR"},{"type":"text","value":"\nA typesetting system commonly used for scientific publications, supported by Matplotlib for mathematical notation.","position":{"start":{"line":1120,"column":1},"end":{"line":1120,"column":1}},"key":"J4JIDHhzXS"}],"key":"I6hzhnVDx6"},{"type":"paragraph","position":{"start":{"line":1123,"column":1},"end":{"line":1124,"column":1}},"children":[{"type":"text","value":"{margin} ","position":{"start":{"line":1123,"column":1},"end":{"line":1123,"column":1}},"key":"AwQL3BryWD"},{"type":"strong","position":{"start":{"line":1123,"column":1},"end":{"line":1123,"column":1}},"children":[{"type":"text","value":"GridSpec","position":{"start":{"line":1123,"column":1},"end":{"line":1123,"column":1}},"key":"hy0MdGd1hU"}],"key":"WZ1OHgkfbT"},{"type":"text","value":"\nMatplotlib’s flexible system for creating complex subplot layouts.","position":{"start":{"line":1123,"column":1},"end":{"line":1123,"column":1}},"key":"rqs3DNdquo"}],"key":"UtVRXUz39H"},{"type":"paragraph","position":{"start":{"line":1126,"column":1},"end":{"line":1126,"column":1}},"children":[{"type":"text","value":"Choosing appropriate ","position":{"start":{"line":1126,"column":1},"end":{"line":1126,"column":1}},"key":"dVc6i0x9fX"},{"type":"strong","position":{"start":{"line":1126,"column":1},"end":{"line":1126,"column":1}},"children":[{"type":"text","value":"colormaps","position":{"start":{"line":1126,"column":1},"end":{"line":1126,"column":1}},"key":"KQhf5lBSpr"}],"key":"PyQB65Y5kx"},{"type":"text","value":" is crucial for honest data representation (Crameri et al. 2020):","position":{"start":{"line":1126,"column":1},"end":{"line":1126,"column":1}},"key":"k9LuBJUEAM"}],"key":"Qlf9CBx1lH"}],"key":"rZgs2Npczx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Demonstrate perceptual uniformity\ndata = np.random.randn(10, 10)\n\nfig, axes = plt.subplots(2, 4, figsize=(14, 7))\n\n# Bad colormaps (not perceptually uniform)\nbad_cmaps = ['jet', 'rainbow', 'nipy_spectral', 'gist_ncar']\nfor ax, cmap in zip(axes[0], bad_cmaps):\n    im = ax.imshow(data, cmap=cmap)\n    ax.set_title(f'{cmap} (Avoid!)')\n    ax.axis('off')\n    plt.colorbar(im, ax=ax, fraction=0.046)\n\n# Good colormaps (perceptually uniform)\ngood_cmaps = ['viridis', 'plasma', 'cividis', 'twilight']\nfor ax, cmap in zip(axes[1], good_cmaps):\n    im = ax.imshow(data, cmap=cmap)\n    ax.set_title(f'{cmap} (Good!)')\n    ax.axis('off')\n    plt.colorbar(im, ax=ax, fraction=0.046)\n\nfig.suptitle('Perceptually Uniform vs Non-Uniform Colormaps', fontsize=14)\nplt.tight_layout()\nplt.show()","key":"KAfFEraGIu"},{"type":"output","id":"PPya-gpwPnesKDk5at6tH","data":[],"key":"SEn4uceUzW"}],"key":"uvde1UtEdA"},{"type":"block","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"⚠️ Common Bug Alert: DPI and Figure Sizes","position":{"start":{"line":1155,"column":1},"end":{"line":1155,"column":1}},"key":"i5nVGlpIY9"}],"key":"PEn2mjw5GG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Figure size confusion - physical vs pixel size\nfig1, ax1 = plt.subplots(figsize=(6, 4), dpi=100)  # 600x400 pixels\nfig2, ax2 = plt.subplots(figsize=(6, 4), dpi=200)  # 1200x800 pixels\n\nax1.text(0.5, 0.5, f'Size: {fig1.get_size_inches()}\\nDPI: {fig1.dpi}\\n' + \n         f'Pixels: {fig1.get_size_inches()[0]*fig1.dpi:.0f}x' +\n         f'{fig1.get_size_inches()[1]*fig1.dpi:.0f}',\n         transform=ax1.transAxes, ha='center', va='center')\nax1.set_title('100 DPI')\n\nax2.text(0.5, 0.5, f'Size: {fig2.get_size_inches()}\\nDPI: {fig2.dpi}\\n' +\n         f'Pixels: {fig2.get_size_inches()[0]*fig2.dpi:.0f}x' +\n         f'{fig2.get_size_inches()[1]*fig2.dpi:.0f}',\n         transform=ax2.transAxes, ha='center', va='center')\nax2.set_title('200 DPI')\n\nplt.show()\n\n# For publication: typical requirements\n# - ApJ: 300 DPI for print, figure width = 3.5\" (single column) or 7\" (full page)\n# - Nature: 300-600 DPI, maximum width 183mm\n# - Screen: 72-100 DPI is sufficient","key":"U8D6T7xzzd"},{"type":"output","id":"X35y7x0MGgaWSDVLkm7RD","data":[],"key":"mhnwX3ajhz"}],"key":"BTwlVwhfX8"}],"class":"warning","key":"b39oKzEy3c"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"🔍 Check Your Understanding","position":{"start":{"line":1184,"column":1},"end":{"line":1184,"column":1}},"key":"ihh1yOcyFa"}],"key":"L3HwMErXN5"},{"type":"paragraph","position":{"start":{"line":1187,"column":1},"end":{"line":1187,"column":1}},"children":[{"type":"text","value":"Why is the ‘jet’ colormap problematic for scientific visualization?","position":{"start":{"line":1187,"column":1},"end":{"line":1187,"column":1}},"key":"v3v6j6ZSU4"}],"key":"PLZqdFw8yK"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Answer","position":{"start":{"line":1189,"column":1},"end":{"line":1189,"column":1}},"key":"er9r2CiXgW"}],"key":"WhLQ1ZC8Oz"},{"type":"paragraph","position":{"start":{"line":1190,"column":1},"end":{"line":1190,"column":1}},"children":[{"type":"text","value":"The ‘jet’ colormap has several serious issues (Wong 2011):","position":{"start":{"line":1190,"column":1},"end":{"line":1190,"column":1}},"key":"cYGXI7Qo6i"}],"key":"obfOtS1RRj"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":1192,"column":1},"end":{"line":1196,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1192,"column":1},"end":{"line":1192,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1192,"column":1},"end":{"line":1192,"column":1}},"children":[{"type":"text","value":"Not perceptually uniform","position":{"start":{"line":1192,"column":1},"end":{"line":1192,"column":1}},"key":"VrsNC5brZ8"}],"key":"AIvNsNxrWZ"},{"type":"text","value":": Equal steps in data don’t appear as equal steps in color","position":{"start":{"line":1192,"column":1},"end":{"line":1192,"column":1}},"key":"wcfMT2sxHK"}],"key":"kd4erfHZBo"},{"type":"listItem","spread":true,"position":{"start":{"line":1193,"column":1},"end":{"line":1193,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1193,"column":1},"end":{"line":1193,"column":1}},"children":[{"type":"text","value":"Creates false features","position":{"start":{"line":1193,"column":1},"end":{"line":1193,"column":1}},"key":"GlyGWpSNfM"}],"key":"cttlcMpFar"},{"type":"text","value":": Bright bands at yellow and cyan create artificial boundaries","position":{"start":{"line":1193,"column":1},"end":{"line":1193,"column":1}},"key":"OVeGAanyPg"}],"key":"X1Vxpw9hR2"},{"type":"listItem","spread":true,"position":{"start":{"line":1194,"column":1},"end":{"line":1194,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1194,"column":1},"end":{"line":1194,"column":1}},"children":[{"type":"text","value":"Not colorblind-friendly","position":{"start":{"line":1194,"column":1},"end":{"line":1194,"column":1}},"key":"kvzHLlkt22"}],"key":"lDrACuFv4U"},{"type":"text","value":": Red-green confusion affects ~8% of males","position":{"start":{"line":1194,"column":1},"end":{"line":1194,"column":1}},"key":"vqMDigRClF"}],"key":"XZzOMXdjaM"},{"type":"listItem","spread":true,"position":{"start":{"line":1195,"column":1},"end":{"line":1196,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1195,"column":1},"end":{"line":1195,"column":1}},"children":[{"type":"text","value":"Poor grayscale conversion","position":{"start":{"line":1195,"column":1},"end":{"line":1195,"column":1}},"key":"xTV4MUMsS4"}],"key":"yarwNyih2h"},{"type":"text","value":": Loses information when printed in black and white","position":{"start":{"line":1195,"column":1},"end":{"line":1195,"column":1}},"key":"xGC9AV9Qgk"}],"key":"oFB2U25TT5"}],"key":"rLXjAOp2EI"},{"type":"paragraph","position":{"start":{"line":1197,"column":1},"end":{"line":1197,"column":1}},"children":[{"type":"text","value":"Example of the problem:","position":{"start":{"line":1197,"column":1},"end":{"line":1197,"column":1}},"key":"bSEDO7bOeO"}],"key":"ypQzVoMIhM"},{"type":"code","lang":"python","value":"# Linear data appears to have features with jet\nlinear_data = np.outer(np.ones(10), np.arange(100))\n\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(10, 4))\nax1.imshow(linear_data, cmap='jet', aspect='auto')\nax1.set_title('Jet: False features appear')\nax2.imshow(linear_data, cmap='viridis', aspect='auto')\nax2.set_title('Viridis: Smooth gradient')","position":{"start":{"line":1198,"column":1},"end":{"line":1207,"column":1}},"key":"UKpA76il0Y"},{"type":"paragraph","position":{"start":{"line":1209,"column":1},"end":{"line":1209,"column":1}},"children":[{"type":"text","value":"Always use perceptually uniform colormaps like viridis, plasma, or cividis for scientific data!","position":{"start":{"line":1209,"column":1},"end":{"line":1209,"column":1}},"key":"DMTrBh7SHr"}],"key":"m145P5Uo38"}],"key":"zLlsSAjR92"}],"class":"question","key":"XtLlAeHocv"},{"type":"code","lang":"","value":"\n## 8.8 Practice Exercises\n\n### Exercise 1: Creating a Complete Astronomical Figure\n\nBuild a publication-quality multi-wavelength light curve:\n\n**Part A: Generate realistic data (5 minutes)**\n\n```{code-cell} python\n# Simulate multi-wavelength observations of a flaring star\nnp.random.seed(42)\n\n# Time array (days)\ntime = np.linspace(0, 30, 300)\n\n# Base stellar brightness (different in each band)\nbase_optical = 12.0  # magnitude\nbase_xray = 1e-12    # erg/s/cm^2\nbase_radio = 10.0    # mJy\n\n# Add periodic variation (rotation)\nperiod = 5.3  # days\nphase = 2 * np.pi * time / period\n\noptical = base_optical - 0.1 * np.sin(phase)\nxray = base_xray * (1 + 0.2 * np.sin(phase + 0.5))\nradio = base_radio * (1 + 0.15 * np.sin(phase - 0.3))\n\n# Add flares at specific times\nflare_times = [8, 15, 22]\nflare_widths = [0.5, 0.3, 0.7]\n\nfor ft, fw in zip(flare_times, flare_widths):\n    flare_profile = np.exp(-0.5 * ((time - ft) / fw)**2)\n    optical -= 0.5 * flare_profile  # Brightening (lower magnitude)\n    xray *= (1 + 10 * flare_profile)  # X-ray enhancement\n    radio *= (1 + 3 * flare_profile)  # Radio enhancement\n\n# Add realistic noise\noptical += np.random.normal(0, 0.02, len(time))\nxray *= (1 + np.random.normal(0, 0.1, len(time)))\nradio *= (1 + np.random.normal(0, 0.05, len(time)))\n\nprint(f\"Generated {len(time)} observations over {time.max():.1f} days\")\nprint(f\"Detected {len(flare_times)} flares\")\n```\n\n**Part B: Create the multi-panel figure (10 minutes)**\n\n```{code-cell} python\n# Create publication-quality figure\nfig = plt.figure(figsize=(10, 8))\n\n# Use GridSpec for custom layout\nfrom matplotlib.gridspec import GridSpec\ngs = GridSpec(4, 1, height_ratios=[2, 2, 2, 1], hspace=0)\n\n# Optical light curve\nax1 = fig.add_subplot(gs[0])\nax1.scatter(time, optical, s=10, alpha=0.6, color='blue')\nax1.set_ylabel('V Magnitude', fontsize=11)\nax1.invert_yaxis()  # Astronomical convention\nax1.grid(True, alpha=0.3)\nax1.set_xlim(0, 30)\nax1.tick_params(labelbottom=False)\n\n# Mark flares\nfor ft in flare_times:\n    ax1.axvline(x=ft, color='red', linestyle='--', alpha=0.5)\nax1.text(0.02, 0.98, 'Optical', transform=ax1.transAxes,\n         fontweight='bold', va='top')\n\n# X-ray light curve (log scale)\nax2 = fig.add_subplot(gs[1], sharex=ax1)\nax2.semilogy(time, xray, 'r-', linewidth=0.8, alpha=0.8)\nax2.set_ylabel('X-ray Flux\\n(erg/s/cm²)', fontsize=11)\nax2.grid(True, alpha=0.3)\nax2.tick_params(labelbottom=False)\nax2.text(0.02, 0.98, 'X-ray', transform=ax2.transAxes,\n         fontweight='bold', va='top')\n\n# Radio light curve\nax3 = fig.add_subplot(gs[2], sharex=ax1)\nax3.plot(time, radio, 'g-', linewidth=1)\nax3.set_ylabel('Radio Flux\\n(mJy)', fontsize=11)\nax3.grid(True, alpha=0.3)\nax3.tick_params(labelbottom=False)\nax3.text(0.02, 0.98, 'Radio', transform=ax3.transAxes,\n         fontweight='bold', va='top')\n\n# Hardness ratio\nax4 = fig.add_subplot(gs[3], sharex=ax1)\nhardness = xray / (xray.mean())  # Normalized X-ray\nax4.plot(time, hardness, 'k-', linewidth=0.8)\nax4.set_ylabel('Hardness\\nRatio', fontsize=11)\nax4.set_xlabel('Time (days)', fontsize=12)\nax4.grid(True, alpha=0.3)\nax4.set_xlim(0, 30)\n\n# Overall title\nfig.suptitle('Multi-wavelength Observations of Flare Star', \n             fontsize=14, fontweight='bold', y=0.995)\n\nplt.show()\n```\n\n**Part C: Export and document (5 minutes)**\n\n```{code-cell} python\n# Create a function to save figures properly\ndef save_publication_figure(fig, basename, formats=['pdf', 'png']):\n    \"\"\"\n    Save figure in multiple formats with proper settings.\n    \n    Parameters\n    ----------\n    fig : matplotlib.figure.Figure\n        Figure to save\n    basename : str\n        Base filename without extension\n    formats : list\n        List of formats to save\n    \"\"\"\n    for fmt in formats:\n        filename = f\"{basename}.{fmt}\"\n        \n        if fmt == 'pdf':\n            fig.savefig(filename, format='pdf', dpi=300,\n                       bbox_inches='tight', transparent=True)\n        elif fmt == 'png':\n            fig.savefig(filename, format='png', dpi=300,\n                       bbox_inches='tight', transparent=False,\n                       facecolor='white')\n        elif fmt == 'svg':\n            fig.savefig(filename, format='svg',\n                       bbox_inches='tight', transparent=True)\n        \n        print(f\"Saved: {filename}\")\n    \n    # Also save the data for reproducibility\n    data_file = f\"{basename}_data.npz\"\n    np.savez(data_file, time=time, optical=optical, \n             xray=xray, radio=radio)\n    print(f\"Saved data: {data_file}\")\n\n# Example usage (commented out to avoid creating files)\n# save_publication_figure(fig, 'flare_star_multiwave')\n\nprint(\"Figure ready for publication!\")\nprint(\"\\nChecklist:\")\nprint(\"✓ All axes labeled with units\")\nprint(\"✓ Multi-wavelength data aligned\")\nprint(\"✓ Flares marked consistently\")\nprint(\"✓ Professional styling applied\")\nprint(\"✓ Ready for ApJ submission (7-inch width)\")\n```\n\n### Exercise 2: Exploring Scaling Effects\n\nUnderstand how different scales reveal different features:\n\n```{code-cell} python\n\"\"\"\nPart 1: Generate power-law distributed data\n\"\"\"\nnp.random.seed(42)\n# Simulate galaxy cluster masses (power law distribution)\nn_galaxies = 5000\nmasses = np.random.pareto(1.5, n_galaxies) + 1  # M ∝ N^(-2.5)\nmasses *= 1e11  # Solar masses\n\n# Add measurement uncertainty\nmasses_observed = masses * np.random.lognormal(0, 0.1, n_galaxies)\n\nprint(f\"Generated {n_galaxies} galaxy masses\")\nprint(f\"Mass range: {masses_observed.min():.2e} to {masses_observed.max():.2e} M☉\")\n```\n\n```{code-cell} python\n\"\"\"\nPart 2: Try different visualizations\n\"\"\"\nfig, axes = plt.subplots(2, 3, figsize=(14, 8))\n\n# Linear histogram - useless for power law\naxes[0, 0].hist(masses_observed, bins=50, alpha=0.7, color='blue')\naxes[0, 0].set_xlabel('Mass (M☉)')\naxes[0, 0].set_ylabel('Count')\naxes[0, 0].set_title('Linear Scale: Useless for Power Law')\n\n# Log-scale x-axis\naxes[0, 1].hist(masses_observed, bins=np.logspace(11, 15, 50), \n                alpha=0.7, color='green')\naxes[0, 1].set_xscale('log')\naxes[0, 1].set_xlabel('Mass (M☉)')\naxes[0, 1].set_ylabel('Count')\naxes[0, 1].set_title('Log X-axis: Better but not ideal')\n\n# Log-log scale reveals power law\naxes[0, 2].hist(masses_observed, bins=np.logspace(11, 15, 50), \n                alpha=0.7, color='red')\naxes[0, 2].set_xscale('log')\naxes[0, 2].set_yscale('log')\naxes[0, 2].set_xlabel('Mass (M☉)')\naxes[0, 2].set_ylabel('Count')\naxes[0, 2].set_title('Log-Log: Power Law Revealed!')\n\n# Cumulative distribution\nsorted_masses = np.sort(masses_observed)\ncumulative = np.arange(1, len(sorted_masses) + 1) / len(sorted_masses)\n\naxes[1, 0].plot(sorted_masses, cumulative, 'b-', linewidth=2)\naxes[1, 0].set_xlabel('Mass (M☉)')\naxes[1, 0].set_ylabel('Cumulative Fraction')\naxes[1, 0].set_title('Linear CDF')\n\naxes[1, 1].loglog(sorted_masses, 1 - cumulative, 'r-', linewidth=2)\naxes[1, 1].set_xlabel('Mass (M☉)')\naxes[1, 1].set_ylabel('Fraction > M')\naxes[1, 1].set_title('Log-Log Complementary CDF: Slope = Power Law Index')\n\n# Rank-frequency plot\nranks = np.arange(1, len(sorted_masses) + 1)\naxes[1, 2].loglog(ranks, sorted_masses[::-1], 'g.', markersize=1)\naxes[1, 2].set_xlabel('Rank')\naxes[1, 2].set_ylabel('Mass (M☉)')\naxes[1, 2].set_title('Rank-Frequency: Alternative Power Law View')\n\nplt.suptitle('Same Data, Different Scales, Different Insights', \n             fontsize=14, fontweight='bold')\nplt.tight_layout()\nplt.show()\n```\n\n### Exercise 3: Debug This!\n\n```{code-cell} python\n\"\"\"\nDebug This! Find and fix the visualization problems.\n\"\"\"\n\ndef plot_hr_diagram_broken(b_v, abs_mag):\n    \"\"\"This function has several plotting issues. Can you fix them?\"\"\"\n    # BUG 1: Figure too small for publication\n    # fig, ax = plt.subplots(figsize=(4, 3))  \n    fig, ax = plt.subplots(figsize=(8, 10))  # FIXED: Appropriate size\n    \n    # BUG 2: Wrong plot type for scattered data\n    # ax.plot(b_v, abs_mag, 'b-')  \n    ax.scatter(b_v, abs_mag, s=20, alpha=0.6, c=b_v, cmap='RdYlBu_r')  # FIXED\n    \n    # BUG 3: Y-axis not inverted (astronomical convention)\n    # ax.set_ylim(-10, 15)  \n    ax.set_ylim(15, -10)  # FIXED: Inverted for magnitudes\n    \n    # BUG 4: No axis labels or units\n    # ax.set_xlabel('x')\n    # ax.set_ylabel('y')\n    ax.set_xlabel('B - V Color Index', fontsize=12)  # FIXED\n    ax.set_ylabel('Absolute Magnitude (M$_V$)', fontsize=12)  # FIXED\n    \n    # BUG 5: No title\n    ax.set_title('Hertzsprung-Russell Diagram', fontsize=14, fontweight='bold')\n    \n    # BUG 6: No grid for reference\n    ax.grid(True, alpha=0.3)  # FIXED\n    \n    # BUG 7: Using jet colormap\n    # (Already fixed above with RdYlBu_r)\n    \n    # Add colorbar\n    plt.colorbar(ax.collections[0], ax=ax, label='B - V Color')\n    \n    return fig, ax\n\n# Test with synthetic data\nnp.random.seed(42)\nn_stars = 1000\n\n# Main sequence\nb_v_ms = np.random.uniform(-0.3, 2.0, n_stars)\nabs_mag_ms = 4.5 * b_v_ms + np.random.normal(0, 1, n_stars) + 2\n\n# Giants branch\nb_v_gb = np.random.uniform(0.5, 2.0, 200)\nabs_mag_gb = np.random.normal(-1, 1, 200)\n\n# Combine\nb_v_all = np.concatenate([b_v_ms, b_v_gb])\nabs_mag_all = np.concatenate([abs_mag_ms, abs_mag_gb])\n\n# Create fixed plot\nfig, ax = plot_hr_diagram_broken(b_v_all, abs_mag_all)\nplt.show()\n\nprint(\"Fixed issues:\")\nprint(\"✓ Increased figure size for readability\")\nprint(\"✓ Changed from line to scatter plot\")\nprint(\"✓ Inverted y-axis (astronomical convention)\")\nprint(\"✓ Added proper axis labels with units\")\nprint(\"✓ Added descriptive title\")\nprint(\"✓ Added grid for reference\")\nprint(\"✓ Used perceptually uniform colormap\")\n```\n\n:::{admonition} 🌟 Why This Matters: The Hubble Tension Revealed Through Visualization\n:class: info, important\n\nThe \"Hubble tension\" — the discrepancy between different measurements of the universe's expansion rate — wasn't discovered through complex statistics but through careful visualization of measurement uncertainties. When plotting H₀ measurements from different methods (CMB, supernovae, gravitational lensing), the error bars don't overlap, revealing a fundamental problem in our understanding of cosmology. Your ability to create clear, honest visualizations with proper error bars might help resolve one of astronomy's biggest mysteries!","position":{"start":{"line":1211,"column":1},"end":{"line":1522,"column":1}},"key":"zLaRF1zehO"},{"type":"heading","depth":2,"position":{"start":{"line":1524,"column":1},"end":{"line":1524,"column":1}},"children":[{"type":"text","value":"Main Takeaways","position":{"start":{"line":1524,"column":1},"end":{"line":1524,"column":1}},"key":"fywK2Fo0Bd"}],"identifier":"main-takeaways","label":"Main Takeaways","html_id":"main-takeaways","implicit":true,"key":"JyVkFqXRih"},{"type":"paragraph","position":{"start":{"line":1526,"column":1},"end":{"line":1526,"column":1}},"children":[{"type":"text","value":"You’ve now mastered the art and science of data visualization with Matplotlib, but more importantly, you’ve learned to think like a visual artist-scientist. The journey from simple plots to publication-ready figures has taught you that visualization isn’t just about displaying data — it’s about experimentation, iteration, and making deliberate aesthetic choices that enhance scientific communication. You’ve discovered that creating effective visualizations requires trying multiple approaches: different scales (linear, log, semilog), different plot types (scatter, line, histogram), and different visual encodings (color, size, transparency) until you find the combination that makes patterns jump off the page. This experimental mindset, combined with the technical skills you’ve developed, transforms you from someone who makes plots into someone who crafts visual arguments that can change how we understand the universe.","position":{"start":{"line":1526,"column":1},"end":{"line":1526,"column":1}},"key":"a77YlemwFu"}],"key":"dScu24bSMj"},{"type":"paragraph","position":{"start":{"line":1528,"column":1},"end":{"line":1528,"column":1}},"children":[{"type":"text","value":"The distinction between Matplotlib’s two interfaces — pyplot and object-oriented — initially seemed like unnecessary complexity, but you now understand it’s about control and reproducibility. While pyplot suffices for quick exploration, the object-oriented approach gives you the artist’s palette you need for research-quality visualizations. You’ve seen how professional figures require attention to countless details: choosing perceptually uniform colormaps over the problematic jet (Crameri et al. 2020), using appropriate scales to reveal power laws or exponential relationships, properly labeling axes with units, and following astronomical conventions like inverting magnitude axes. These aren’t arbitrary rules but hard-won practices that ensure your visualizations communicate honestly and effectively. The famous anatomy figure by Nicolas P. Rougier (2018) that you studied shows how every element — from figure to axes to individual tick marks — is under your control, waiting for your artistic vision.","position":{"start":{"line":1528,"column":1},"end":{"line":1528,"column":1}},"key":"JqsmVxep0V"}],"key":"mTMGTjfXFX"},{"type":"paragraph","position":{"start":{"line":1530,"column":1},"end":{"line":1530,"column":1}},"children":[{"type":"text","value":"Most importantly, you’ve learned to build your own plotting toolkit, creating reusable functions that encode your domain knowledge and aesthetic preferences. Instead of copy-pasting code and creating technical debt, you now write functions like ","position":{"start":{"line":1530,"column":1},"end":{"line":1530,"column":1}},"key":"GtWkexMsvh"},{"type":"inlineCode","value":"plot_light_curve()","position":{"start":{"line":1530,"column":1},"end":{"line":1530,"column":1}},"key":"wf9XWK0idw"},{"type":"text","value":" or ","position":{"start":{"line":1530,"column":1},"end":{"line":1530,"column":1}},"key":"EMVyCmQCTF"},{"type":"inlineCode","value":"plot_spectrum()","position":{"start":{"line":1530,"column":1},"end":{"line":1530,"column":1}},"key":"sYWahykZwE"},{"type":"text","value":" that embody best practices and can be shared with collaborators. This approach follows the DRY (Don’t Repeat Yourself) principle, ensuring consistency across all your visualizations while making it easy to update styles globally. These personal plotting libraries become more valuable over time, accumulating the wisdom of what works for different types of astronomical data. Whether you’re phase-folding light curves to find exoplanets, creating color-magnitude diagrams to study stellar populations, or displaying multi-wavelength observations to understand cosmic phenomena, you have both the technical skills and the artistic sensibility to create visualizations that don’t just show data but tell stories.","position":{"start":{"line":1530,"column":1},"end":{"line":1530,"column":1}},"key":"e2NrUJRggm"}],"key":"V8ZEcFZqVw"},{"type":"paragraph","position":{"start":{"line":1532,"column":1},"end":{"line":1532,"column":1}},"children":[{"type":"text","value":"Looking ahead to robust computing, the visualization skills you’ve developed become essential debugging tools. When your code fails or produces unexpected results, a well-chosen plot can instantly reveal where things went wrong. The ability to quickly visualize intermediate results, check distributions, and compare expected versus actual outputs will make you a more effective debugger and a more reliable scientific programmer. Remember that every great astronomical discovery — from the expanding universe (Hubble 1929) to dark energy (Riess et al. 1998; Perlmutter et al. 1999) to exoplanets (Borucki et al. 2010) — was communicated through a carefully crafted visualization. The skills you’ve developed here put you in that tradition, able to create the kinds of plots that don’t just illustrate findings but reveal new truths about the cosmos.","position":{"start":{"line":1532,"column":1},"end":{"line":1532,"column":1}},"key":"y8vxQbSASf"}],"key":"PE8LqIfBah"},{"type":"heading","depth":2,"position":{"start":{"line":1534,"column":1},"end":{"line":1534,"column":1}},"children":[{"type":"text","value":"Definitions","position":{"start":{"line":1534,"column":1},"end":{"line":1534,"column":1}},"key":"E96R225JhL"}],"identifier":"definitions","label":"Definitions","html_id":"definitions","implicit":true,"key":"zeJVIy178S"},{"type":"paragraph","position":{"start":{"line":1536,"column":1},"end":{"line":1536,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1536,"column":1},"end":{"line":1536,"column":1}},"children":[{"type":"text","value":"Axes","position":{"start":{"line":1536,"column":1},"end":{"line":1536,"column":1}},"key":"vgfGDLudxM"}],"key":"f7ZPdGgvJ5"},{"type":"text","value":": The plotting area within a figure where data is visualized, including the x and y axis, tick marks, and labels.","position":{"start":{"line":1536,"column":1},"end":{"line":1536,"column":1}},"key":"NHrY2Gd4IG"}],"key":"pgsqKcAPhZ"},{"type":"paragraph","position":{"start":{"line":1538,"column":1},"end":{"line":1538,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1538,"column":1},"end":{"line":1538,"column":1}},"children":[{"type":"text","value":"Backend","position":{"start":{"line":1538,"column":1},"end":{"line":1538,"column":1}},"key":"ZYSO0ovuCM"}],"key":"rT2UuoCGEo"},{"type":"text","value":": The rendering engine Matplotlib uses to create and display figures (e.g., Agg, TkAgg, Qt5Agg).","position":{"start":{"line":1538,"column":1},"end":{"line":1538,"column":1}},"key":"DKDAY9gAez"}],"key":"UqHotOzMn9"},{"type":"paragraph","position":{"start":{"line":1540,"column":1},"end":{"line":1540,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1540,"column":1},"end":{"line":1540,"column":1}},"children":[{"type":"text","value":"Colormap","position":{"start":{"line":1540,"column":1},"end":{"line":1540,"column":1}},"key":"TyRmxMigBA"}],"key":"iGTaQzQZuU"},{"type":"text","value":": A mapping from data values to colors for visualization, critical for representing 2D data and images.","position":{"start":{"line":1540,"column":1},"end":{"line":1540,"column":1}},"key":"p40fgEdsz5"}],"key":"u9UcbJW4Zv"},{"type":"paragraph","position":{"start":{"line":1542,"column":1},"end":{"line":1542,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1542,"column":1},"end":{"line":1542,"column":1}},"children":[{"type":"text","value":"DPI","position":{"start":{"line":1542,"column":1},"end":{"line":1542,"column":1}},"key":"QrA7d2UqNG"}],"key":"llcP0JwIfz"},{"type":"text","value":": Dots per inch, determining figure resolution for printing or display, typically 72 for screen and 300+ for print.","position":{"start":{"line":1542,"column":1},"end":{"line":1542,"column":1}},"key":"mxdioOAtfL"}],"key":"s22uYVE4wK"},{"type":"paragraph","position":{"start":{"line":1544,"column":1},"end":{"line":1544,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1544,"column":1},"end":{"line":1544,"column":1}},"children":[{"type":"text","value":"Experimentation","position":{"start":{"line":1544,"column":1},"end":{"line":1544,"column":1}},"key":"LfWBNMN9i5"}],"key":"wVKGTJnaJf"},{"type":"text","value":": The iterative process of trying different visualizations to find the most revealing representation.","position":{"start":{"line":1544,"column":1},"end":{"line":1544,"column":1}},"key":"VubdmBc3I2"}],"key":"vHnyUowffj"},{"type":"paragraph","position":{"start":{"line":1546,"column":1},"end":{"line":1546,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1546,"column":1},"end":{"line":1546,"column":1}},"children":[{"type":"text","value":"Figure","position":{"start":{"line":1546,"column":1},"end":{"line":1546,"column":1}},"key":"ewTWIzBsJ7"}],"key":"DI6XdnwfeP"},{"type":"text","value":": The overall container for all plot elements, like a canvas that holds one or more axes.","position":{"start":{"line":1546,"column":1},"end":{"line":1546,"column":1}},"key":"wAnC4LrF5W"}],"key":"rvKY5Csdhd"},{"type":"paragraph","position":{"start":{"line":1548,"column":1},"end":{"line":1548,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1548,"column":1},"end":{"line":1548,"column":1}},"children":[{"type":"text","value":"GridSpec","position":{"start":{"line":1548,"column":1},"end":{"line":1548,"column":1}},"key":"czjRAcLOL4"}],"key":"LLQIYttiYp"},{"type":"text","value":": Matplotlib’s flexible system for creating complex subplot layouts with varying sizes and positions.","position":{"start":{"line":1548,"column":1},"end":{"line":1548,"column":1}},"key":"Oknzjq8PPk"}],"key":"wKu6Suvk7w"},{"type":"paragraph","position":{"start":{"line":1550,"column":1},"end":{"line":1550,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1550,"column":1},"end":{"line":1550,"column":1}},"children":[{"type":"text","value":"LaTeX","position":{"start":{"line":1550,"column":1},"end":{"line":1550,"column":1}},"key":"bKQqNWxNuj"}],"key":"Imk4o1akke"},{"type":"text","value":": A typesetting system commonly used for scientific publications, supported by Matplotlib for mathematical notation.","position":{"start":{"line":1550,"column":1},"end":{"line":1550,"column":1}},"key":"D0gP7hyN1a"}],"key":"XReDQbKMB3"},{"type":"paragraph","position":{"start":{"line":1552,"column":1},"end":{"line":1552,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1552,"column":1},"end":{"line":1552,"column":1}},"children":[{"type":"text","value":"Light Curve","position":{"start":{"line":1552,"column":1},"end":{"line":1552,"column":1}},"key":"BIvJaDwBZm"}],"key":"ILlJ4owWIB"},{"type":"text","value":": A plot showing how an astronomical object’s brightness varies over time.","position":{"start":{"line":1552,"column":1},"end":{"line":1552,"column":1}},"key":"qZdjPgBNrK"}],"key":"oss4EAOdmX"},{"type":"paragraph","position":{"start":{"line":1554,"column":1},"end":{"line":1554,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1554,"column":1},"end":{"line":1554,"column":1}},"children":[{"type":"text","value":"Linear Scale","position":{"start":{"line":1554,"column":1},"end":{"line":1554,"column":1}},"key":"y8ecG5SbXb"}],"key":"JdfzwttMoL"},{"type":"text","value":": Equal steps in data correspond to equal distances on the plot.","position":{"start":{"line":1554,"column":1},"end":{"line":1554,"column":1}},"key":"GB6Y0slbI0"}],"key":"Zd7sgUuoks"},{"type":"paragraph","position":{"start":{"line":1556,"column":1},"end":{"line":1556,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1556,"column":1},"end":{"line":1556,"column":1}},"children":[{"type":"text","value":"Logarithmic Scale","position":{"start":{"line":1556,"column":1},"end":{"line":1556,"column":1}},"key":"eqrWTHJwt0"}],"key":"SybZY4T6Bd"},{"type":"text","value":": Equal multiplicative factors correspond to equal distances on the plot.","position":{"start":{"line":1556,"column":1},"end":{"line":1556,"column":1}},"key":"of5uaVdoHL"}],"key":"wjMH1WboFg"},{"type":"paragraph","position":{"start":{"line":1558,"column":1},"end":{"line":1558,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1558,"column":1},"end":{"line":1558,"column":1}},"children":[{"type":"text","value":"Normalization","position":{"start":{"line":1558,"column":1},"end":{"line":1558,"column":1}},"key":"VI1ryXarSb"}],"key":"DkEmVGnqMM"},{"type":"text","value":": Scaling data values to a standard range for display, such as linear, logarithmic, or power scaling.","position":{"start":{"line":1558,"column":1},"end":{"line":1558,"column":1}},"key":"TB79zTZha8"}],"key":"cjJ6u9Lb4U"},{"type":"paragraph","position":{"start":{"line":1560,"column":1},"end":{"line":1560,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1560,"column":1},"end":{"line":1560,"column":1}},"children":[{"type":"text","value":"Object-Oriented API","position":{"start":{"line":1560,"column":1},"end":{"line":1560,"column":1}},"key":"mGXvajWp2B"}],"key":"X6bOMe12Ze"},{"type":"text","value":": Matplotlib’s powerful interface providing full control over every plot element through explicit objects.","position":{"start":{"line":1560,"column":1},"end":{"line":1560,"column":1}},"key":"LH5OoS8Qld"}],"key":"g0kXJxyw85"},{"type":"paragraph","position":{"start":{"line":1562,"column":1},"end":{"line":1562,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1562,"column":1},"end":{"line":1562,"column":1}},"children":[{"type":"text","value":"Power Law","position":{"start":{"line":1562,"column":1},"end":{"line":1562,"column":1}},"key":"MEjmy7IzuF"}],"key":"whbHZpz4hd"},{"type":"text","value":": A mathematical relationship where y ∝ x^n, appearing as a straight line on a log-log plot.","position":{"start":{"line":1562,"column":1},"end":{"line":1562,"column":1}},"key":"NSH8dk81BB"}],"key":"GLVAw6Nivf"},{"type":"paragraph","position":{"start":{"line":1564,"column":1},"end":{"line":1564,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1564,"column":1},"end":{"line":1564,"column":1}},"children":[{"type":"text","value":"pyplot","position":{"start":{"line":1564,"column":1},"end":{"line":1564,"column":1}},"key":"rPONFkU8ik"}],"key":"TJHOJty9Pb"},{"type":"text","value":": Matplotlib’s MATLAB-like procedural interface for quick plotting using implicit current figure/axes.","position":{"start":{"line":1564,"column":1},"end":{"line":1564,"column":1}},"key":"ejkasPML1e"}],"key":"btXXOBfNzu"},{"type":"paragraph","position":{"start":{"line":1566,"column":1},"end":{"line":1566,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1566,"column":1},"end":{"line":1566,"column":1}},"children":[{"type":"text","value":"Spectrum","position":{"start":{"line":1566,"column":1},"end":{"line":1566,"column":1}},"key":"ZajN94jhgR"}],"key":"vN4vj0QWji"},{"type":"text","value":": A plot showing intensity as a function of wavelength or frequency, fundamental in astronomical spectroscopy.","position":{"start":{"line":1566,"column":1},"end":{"line":1566,"column":1}},"key":"ynshlTv2tl"}],"key":"gjl8jUPRYn"},{"type":"heading","depth":2,"position":{"start":{"line":1568,"column":1},"end":{"line":1568,"column":1}},"children":[{"type":"text","value":"Key Takeaways","position":{"start":{"line":1568,"column":1},"end":{"line":1568,"column":1}},"key":"P3x9EDJMst"}],"identifier":"key-takeaways","label":"Key Takeaways","html_id":"key-takeaways","implicit":true,"key":"sKOUYh1a9M"},{"type":"paragraph","position":{"start":{"line":1570,"column":1},"end":{"line":1570,"column":1}},"children":[{"type":"text","value":"✓ ","position":{"start":{"line":1570,"column":1},"end":{"line":1570,"column":1}},"key":"TLbtQddeHv"},{"type":"strong","position":{"start":{"line":1570,"column":1},"end":{"line":1570,"column":1}},"children":[{"type":"text","value":"Matplotlib is your artistic medium","position":{"start":{"line":1570,"column":1},"end":{"line":1570,"column":1}},"key":"Nj8paXiStZ"}],"key":"KhZMrxkQCq"},{"type":"text","value":" — Every plot is an opportunity for creative expression and experimentation","position":{"start":{"line":1570,"column":1},"end":{"line":1570,"column":1}},"key":"OBnAytVUfR"}],"key":"HOClUR0RSx"},{"type":"paragraph","position":{"start":{"line":1572,"column":1},"end":{"line":1572,"column":1}},"children":[{"type":"text","value":"✓ ","position":{"start":{"line":1572,"column":1},"end":{"line":1572,"column":1}},"key":"amirAiCwDb"},{"type":"strong","position":{"start":{"line":1572,"column":1},"end":{"line":1572,"column":1}},"children":[{"type":"text","value":"Always experiment with different scales","position":{"start":{"line":1572,"column":1},"end":{"line":1572,"column":1}},"key":"fRiCHJRNYw"}],"key":"vvu5pR2ubr"},{"type":"text","value":" — Linear, log-log, semilog-x, and semilog-y reveal different patterns in your data","position":{"start":{"line":1572,"column":1},"end":{"line":1572,"column":1}},"key":"tnJsDE53wB"}],"key":"Dre4Hat46Z"},{"type":"paragraph","position":{"start":{"line":1574,"column":1},"end":{"line":1574,"column":1}},"children":[{"type":"text","value":"✓ ","position":{"start":{"line":1574,"column":1},"end":{"line":1574,"column":1}},"key":"A1Z5PQAfRY"},{"type":"strong","position":{"start":{"line":1574,"column":1},"end":{"line":1574,"column":1}},"children":[{"type":"text","value":"Use the object-oriented interface for research","position":{"start":{"line":1574,"column":1},"end":{"line":1574,"column":1}},"key":"H92iWrNt18"}],"key":"BnDLiTZeMF"},{"type":"text","value":" — ","position":{"start":{"line":1574,"column":1},"end":{"line":1574,"column":1}},"key":"zeSJlUy3hQ"},{"type":"inlineCode","value":"fig, ax = plt.subplots()","position":{"start":{"line":1574,"column":1},"end":{"line":1574,"column":1}},"key":"d5BzQe8vyY"},{"type":"text","value":" gives you explicit control needed for publication","position":{"start":{"line":1574,"column":1},"end":{"line":1574,"column":1}},"key":"Q976uKn2h0"}],"key":"DHDmnxkRvT"},{"type":"paragraph","position":{"start":{"line":1576,"column":1},"end":{"line":1576,"column":1}},"children":[{"type":"text","value":"✓ ","position":{"start":{"line":1576,"column":1},"end":{"line":1576,"column":1}},"key":"MO2biopMja"},{"type":"strong","position":{"start":{"line":1576,"column":1},"end":{"line":1576,"column":1}},"children":[{"type":"text","value":"Build reusable plotting functions","position":{"start":{"line":1576,"column":1},"end":{"line":1576,"column":1}},"key":"UkEuOkEWlW"}],"key":"cEeyfZjQsv"},{"type":"text","value":" — Create your own library encoding best practices for common astronomical plots","position":{"start":{"line":1576,"column":1},"end":{"line":1576,"column":1}},"key":"EpCmdJvDyf"}],"key":"MlH8ZxudDA"},{"type":"paragraph","position":{"start":{"line":1578,"column":1},"end":{"line":1578,"column":1}},"children":[{"type":"text","value":"✓ ","position":{"start":{"line":1578,"column":1},"end":{"line":1578,"column":1}},"key":"FODUYBZgRa"},{"type":"strong","position":{"start":{"line":1578,"column":1},"end":{"line":1578,"column":1}},"children":[{"type":"text","value":"Choose perceptually uniform colormaps","position":{"start":{"line":1578,"column":1},"end":{"line":1578,"column":1}},"key":"vmJgqvtyBN"}],"key":"VF79ohqcNZ"},{"type":"text","value":" — Use viridis, plasma, or cividis; avoid jet which creates false features","position":{"start":{"line":1578,"column":1},"end":{"line":1578,"column":1}},"key":"AxdvLG1hc0"}],"key":"xe6TLZLi2U"},{"type":"paragraph","position":{"start":{"line":1580,"column":1},"end":{"line":1580,"column":1}},"children":[{"type":"text","value":"✓ ","position":{"start":{"line":1580,"column":1},"end":{"line":1580,"column":1}},"key":"r2t3jV2P3f"},{"type":"strong","position":{"start":{"line":1580,"column":1},"end":{"line":1580,"column":1}},"children":[{"type":"text","value":"Master the anatomy of figures","position":{"start":{"line":1580,"column":1},"end":{"line":1580,"column":1}},"key":"JSsHvTwtRG"}],"key":"uQOBXOGSUh"},{"type":"text","value":" — Understanding Rougier’s diagram empowers you to customize every element","position":{"start":{"line":1580,"column":1},"end":{"line":1580,"column":1}},"key":"j2kUwCZOXH"}],"key":"ybNi426q2Q"},{"type":"paragraph","position":{"start":{"line":1582,"column":1},"end":{"line":1582,"column":1}},"children":[{"type":"text","value":"✓ ","position":{"start":{"line":1582,"column":1},"end":{"line":1582,"column":1}},"key":"PVSkZB7wKw"},{"type":"strong","position":{"start":{"line":1582,"column":1},"end":{"line":1582,"column":1}},"children":[{"type":"text","value":"Different plots for different data","position":{"start":{"line":1582,"column":1},"end":{"line":1582,"column":1}},"key":"BTSfHKsbKS"}],"key":"kh9YdAfidK"},{"type":"text","value":" — Use scatter for measurements, lines for models, histograms for distributions","position":{"start":{"line":1582,"column":1},"end":{"line":1582,"column":1}},"key":"BkAGbBgZee"}],"key":"s1hO63Z6ac"},{"type":"paragraph","position":{"start":{"line":1584,"column":1},"end":{"line":1584,"column":1}},"children":[{"type":"text","value":"✓ ","position":{"start":{"line":1584,"column":1},"end":{"line":1584,"column":1}},"key":"lxK09yM7Jm"},{"type":"strong","position":{"start":{"line":1584,"column":1},"end":{"line":1584,"column":1}},"children":[{"type":"text","value":"Save in appropriate formats","position":{"start":{"line":1584,"column":1},"end":{"line":1584,"column":1}},"key":"WFnXdwk8b3"}],"key":"yI7wzAMZqZ"},{"type":"text","value":" — Vector (PDF, SVG) for plots, raster (PNG) for images, both for safety","position":{"start":{"line":1584,"column":1},"end":{"line":1584,"column":1}},"key":"fpFOM5Iyg3"}],"key":"Z97qICjgT3"},{"type":"paragraph","position":{"start":{"line":1586,"column":1},"end":{"line":1586,"column":1}},"children":[{"type":"text","value":"✓ ","position":{"start":{"line":1586,"column":1},"end":{"line":1586,"column":1}},"key":"dLTf0i5evd"},{"type":"strong","position":{"start":{"line":1586,"column":1},"end":{"line":1586,"column":1}},"children":[{"type":"text","value":"Follow astronomical conventions","position":{"start":{"line":1586,"column":1},"end":{"line":1586,"column":1}},"key":"ns0IW7NK4c"}],"key":"Qm0uP7483q"},{"type":"text","value":" — Invert magnitude axes, use proper coordinate systems, follow field standards","position":{"start":{"line":1586,"column":1},"end":{"line":1586,"column":1}},"key":"m0W0tcXa43"}],"key":"GN5zpS8dx6"},{"type":"paragraph","position":{"start":{"line":1588,"column":1},"end":{"line":1588,"column":1}},"children":[{"type":"text","value":"✓ ","position":{"start":{"line":1588,"column":1},"end":{"line":1588,"column":1}},"key":"tNn8G6Gcfj"},{"type":"strong","position":{"start":{"line":1588,"column":1},"end":{"line":1588,"column":1}},"children":[{"type":"text","value":"Visualization reveals patterns","position":{"start":{"line":1588,"column":1},"end":{"line":1588,"column":1}},"key":"hjntBy85KC"}],"key":"ANMQHbSfP3"},{"type":"text","value":" — The right plot can make invisible relationships obvious, leading to discoveries","position":{"start":{"line":1588,"column":1},"end":{"line":1588,"column":1}},"key":"fkP4idbQl8"}],"key":"oIlTLIgt88"},{"type":"heading","depth":2,"position":{"start":{"line":1590,"column":1},"end":{"line":1590,"column":1}},"children":[{"type":"text","value":"Quick Reference Tables","position":{"start":{"line":1590,"column":1},"end":{"line":1590,"column":1}},"key":"BCCU3auyth"}],"identifier":"quick-reference-tables","label":"Quick Reference Tables","html_id":"quick-reference-tables","implicit":true,"key":"yZEGBg7hjB"},{"type":"heading","depth":3,"position":{"start":{"line":1592,"column":1},"end":{"line":1592,"column":1}},"children":[{"type":"text","value":"Choosing the Right Scale","position":{"start":{"line":1592,"column":1},"end":{"line":1592,"column":1}},"key":"wTeUjOdWmP"}],"identifier":"choosing-the-right-scale","label":"Choosing the Right Scale","html_id":"choosing-the-right-scale","implicit":true,"key":"cAUFiHSTwL"},{"type":"table","position":{"start":{"line":1594,"column":1},"end":{"line":1601,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":1594,"column":1},"end":{"line":1594,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":1594,"column":1},"end":{"line":1594,"column":1}},"children":[{"type":"text","value":"Data Type","position":{"start":{"line":1594,"column":1},"end":{"line":1594,"column":1}},"key":"Hmc5k1vmTN"}],"key":"sEPrztEO0I"},{"type":"tableCell","header":true,"position":{"start":{"line":1594,"column":1},"end":{"line":1594,"column":1}},"children":[{"type":"text","value":"Best Scale","position":{"start":{"line":1594,"column":1},"end":{"line":1594,"column":1}},"key":"PikR0mZivy"}],"key":"DNjA7HoyCj"},{"type":"tableCell","header":true,"position":{"start":{"line":1594,"column":1},"end":{"line":1594,"column":1}},"children":[{"type":"text","value":"Why","position":{"start":{"line":1594,"column":1},"end":{"line":1594,"column":1}},"key":"Sc8grjr5Ae"}],"key":"MMwuxS8tgH"}],"key":"Kud5aHLheP"},{"type":"tableRow","position":{"start":{"line":1596,"column":1},"end":{"line":1596,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1596,"column":1},"end":{"line":1596,"column":1}},"children":[{"type":"text","value":"Power law (y ∝ x^n)","position":{"start":{"line":1596,"column":1},"end":{"line":1596,"column":1}},"key":"agmsTRGnFo"}],"key":"H439j4K3HJ"},{"type":"tableCell","position":{"start":{"line":1596,"column":1},"end":{"line":1596,"column":1}},"children":[{"type":"text","value":"log-log","position":{"start":{"line":1596,"column":1},"end":{"line":1596,"column":1}},"key":"aZqUYFxsAY"}],"key":"NDorHE9V3K"},{"type":"tableCell","position":{"start":{"line":1596,"column":1},"end":{"line":1596,"column":1}},"children":[{"type":"text","value":"Appears as straight line","position":{"start":{"line":1596,"column":1},"end":{"line":1596,"column":1}},"key":"nkVYhJwt0f"}],"key":"DC9e36tC9X"}],"key":"MKDxMZXp97"},{"type":"tableRow","position":{"start":{"line":1597,"column":1},"end":{"line":1597,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1597,"column":1},"end":{"line":1597,"column":1}},"children":[{"type":"text","value":"Exponential (y ∝ e^x)","position":{"start":{"line":1597,"column":1},"end":{"line":1597,"column":1}},"key":"eL0bfDpWem"}],"key":"juuosWMjsi"},{"type":"tableCell","position":{"start":{"line":1597,"column":1},"end":{"line":1597,"column":1}},"children":[{"type":"text","value":"semilog-y","position":{"start":{"line":1597,"column":1},"end":{"line":1597,"column":1}},"key":"Zi9TB8vNqU"}],"key":"g8RtsEA96J"},{"type":"tableCell","position":{"start":{"line":1597,"column":1},"end":{"line":1597,"column":1}},"children":[{"type":"text","value":"Appears as straight line","position":{"start":{"line":1597,"column":1},"end":{"line":1597,"column":1}},"key":"DxcO2zNuyE"}],"key":"M5iy0CvqXu"}],"key":"WsmXFS6M0z"},{"type":"tableRow","position":{"start":{"line":1598,"column":1},"end":{"line":1598,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1598,"column":1},"end":{"line":1598,"column":1}},"children":[{"type":"text","value":"Logarithmic (y ∝ log(x))","position":{"start":{"line":1598,"column":1},"end":{"line":1598,"column":1}},"key":"kQ6nZMqE6J"}],"key":"OhOwTFAFiF"},{"type":"tableCell","position":{"start":{"line":1598,"column":1},"end":{"line":1598,"column":1}},"children":[{"type":"text","value":"semilog-x","position":{"start":{"line":1598,"column":1},"end":{"line":1598,"column":1}},"key":"op6IpsGqt0"}],"key":"sLnX9NiZR2"},{"type":"tableCell","position":{"start":{"line":1598,"column":1},"end":{"line":1598,"column":1}},"children":[{"type":"text","value":"Appears as straight line","position":{"start":{"line":1598,"column":1},"end":{"line":1598,"column":1}},"key":"lwLXtOtoRx"}],"key":"u4YMUGfGih"}],"key":"ckCoZWhzF9"},{"type":"tableRow","position":{"start":{"line":1599,"column":1},"end":{"line":1599,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1599,"column":1},"end":{"line":1599,"column":1}},"children":[{"type":"text","value":"Linear relationship","position":{"start":{"line":1599,"column":1},"end":{"line":1599,"column":1}},"key":"wWokdQgoHL"}],"key":"tHux5Xv4VO"},{"type":"tableCell","position":{"start":{"line":1599,"column":1},"end":{"line":1599,"column":1}},"children":[{"type":"text","value":"linear","position":{"start":{"line":1599,"column":1},"end":{"line":1599,"column":1}},"key":"oMvk9vqS5h"}],"key":"DAuRKOeTy3"},{"type":"tableCell","position":{"start":{"line":1599,"column":1},"end":{"line":1599,"column":1}},"children":[{"type":"text","value":"Direct proportionality visible","position":{"start":{"line":1599,"column":1},"end":{"line":1599,"column":1}},"key":"WQW3tSQEsx"}],"key":"t29jAyLVRX"}],"key":"mzFCCdpmTD"},{"type":"tableRow","position":{"start":{"line":1600,"column":1},"end":{"line":1600,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1600,"column":1},"end":{"line":1600,"column":1}},"children":[{"type":"text","value":"Wide dynamic range","position":{"start":{"line":1600,"column":1},"end":{"line":1600,"column":1}},"key":"fC2juBzgwY"}],"key":"nKHw4JDRv1"},{"type":"tableCell","position":{"start":{"line":1600,"column":1},"end":{"line":1600,"column":1}},"children":[{"type":"text","value":"log","position":{"start":{"line":1600,"column":1},"end":{"line":1600,"column":1}},"key":"pMN5dD2x3p"}],"key":"bdC5xFrWcb"},{"type":"tableCell","position":{"start":{"line":1600,"column":1},"end":{"line":1600,"column":1}},"children":[{"type":"text","value":"Shows all scales equally","position":{"start":{"line":1600,"column":1},"end":{"line":1600,"column":1}},"key":"LuCwzLyhT2"}],"key":"SRU7giTKRU"}],"key":"fui9DgGYMW"},{"type":"tableRow","position":{"start":{"line":1601,"column":1},"end":{"line":1601,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1601,"column":1},"end":{"line":1601,"column":1}},"children":[{"type":"text","value":"Magnitudes","position":{"start":{"line":1601,"column":1},"end":{"line":1601,"column":1}},"key":"D8m25D7iDP"}],"key":"mgPuWZ2nqa"},{"type":"tableCell","position":{"start":{"line":1601,"column":1},"end":{"line":1601,"column":1}},"children":[{"type":"text","value":"linear (inverted)","position":{"start":{"line":1601,"column":1},"end":{"line":1601,"column":1}},"key":"IjAkSZvDDU"}],"key":"jzu6ByKPZN"},{"type":"tableCell","position":{"start":{"line":1601,"column":1},"end":{"line":1601,"column":1}},"children":[{"type":"text","value":"Astronomical convention","position":{"start":{"line":1601,"column":1},"end":{"line":1601,"column":1}},"key":"QF3WvN7E9s"}],"key":"lueQV356JG"}],"key":"EtOLDSkCap"}],"key":"OMSlgA4iZN"},{"type":"heading","depth":3,"position":{"start":{"line":1603,"column":1},"end":{"line":1603,"column":1}},"children":[{"type":"text","value":"Essential Plot Types","position":{"start":{"line":1603,"column":1},"end":{"line":1603,"column":1}},"key":"kglKqujxDO"}],"identifier":"essential-plot-types","label":"Essential Plot Types","html_id":"essential-plot-types","implicit":true,"key":"RoQHtaQwgb"},{"type":"table","position":{"start":{"line":1605,"column":1},"end":{"line":1614,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":1605,"column":1},"end":{"line":1605,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":1605,"column":1},"end":{"line":1605,"column":1}},"children":[{"type":"text","value":"Function","position":{"start":{"line":1605,"column":1},"end":{"line":1605,"column":1}},"key":"kZ24plOkJ8"}],"key":"UYQnROSdD4"},{"type":"tableCell","header":true,"position":{"start":{"line":1605,"column":1},"end":{"line":1605,"column":1}},"children":[{"type":"text","value":"Use Case","position":{"start":{"line":1605,"column":1},"end":{"line":1605,"column":1}},"key":"Y1CdATgOFO"}],"key":"ZjYxUCfkJe"},{"type":"tableCell","header":true,"position":{"start":{"line":1605,"column":1},"end":{"line":1605,"column":1}},"children":[{"type":"text","value":"Example","position":{"start":{"line":1605,"column":1},"end":{"line":1605,"column":1}},"key":"cLGhJ4pKoD"}],"key":"V6g3nK1KNy"}],"key":"mti43nIxx9"},{"type":"tableRow","position":{"start":{"line":1607,"column":1},"end":{"line":1607,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1607,"column":1},"end":{"line":1607,"column":1}},"children":[{"type":"inlineCode","value":"ax.plot()","position":{"start":{"line":1607,"column":1},"end":{"line":1607,"column":1}},"key":"D7eTYIf6iD"}],"key":"hRJw5JDo0T"},{"type":"tableCell","position":{"start":{"line":1607,"column":1},"end":{"line":1607,"column":1}},"children":[{"type":"text","value":"Continuous data, models","position":{"start":{"line":1607,"column":1},"end":{"line":1607,"column":1}},"key":"sDhCjYhzn7"}],"key":"mWIZJ267Fo"},{"type":"tableCell","position":{"start":{"line":1607,"column":1},"end":{"line":1607,"column":1}},"children":[{"type":"inlineCode","value":"ax.plot(x, y, 'b-')","position":{"start":{"line":1607,"column":1},"end":{"line":1607,"column":1}},"key":"HsAkUkNO4o"}],"key":"SDezeV7wbT"}],"key":"LK2UtdLlac"},{"type":"tableRow","position":{"start":{"line":1608,"column":1},"end":{"line":1608,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1608,"column":1},"end":{"line":1608,"column":1}},"children":[{"type":"inlineCode","value":"ax.scatter()","position":{"start":{"line":1608,"column":1},"end":{"line":1608,"column":1}},"key":"ZD92WBU8xf"}],"key":"hPwHPZvECK"},{"type":"tableCell","position":{"start":{"line":1608,"column":1},"end":{"line":1608,"column":1}},"children":[{"type":"text","value":"Discrete measurements","position":{"start":{"line":1608,"column":1},"end":{"line":1608,"column":1}},"key":"yDo53dZodr"}],"key":"b5ulQF821c"},{"type":"tableCell","position":{"start":{"line":1608,"column":1},"end":{"line":1608,"column":1}},"children":[{"type":"inlineCode","value":"ax.scatter(x, y, s=20)","position":{"start":{"line":1608,"column":1},"end":{"line":1608,"column":1}},"key":"SOe8ZCFcbl"}],"key":"DnxJfai4HJ"}],"key":"PHuoYibPDh"},{"type":"tableRow","position":{"start":{"line":1609,"column":1},"end":{"line":1609,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1609,"column":1},"end":{"line":1609,"column":1}},"children":[{"type":"inlineCode","value":"ax.errorbar()","position":{"start":{"line":1609,"column":1},"end":{"line":1609,"column":1}},"key":"Ti7Z5bkaRb"}],"key":"L9K8p1WjAM"},{"type":"tableCell","position":{"start":{"line":1609,"column":1},"end":{"line":1609,"column":1}},"children":[{"type":"text","value":"Data with uncertainties","position":{"start":{"line":1609,"column":1},"end":{"line":1609,"column":1}},"key":"agkTd0I4wi"}],"key":"Vuyo4baWYh"},{"type":"tableCell","position":{"start":{"line":1609,"column":1},"end":{"line":1609,"column":1}},"children":[{"type":"inlineCode","value":"ax.errorbar(x, y, yerr=err)","position":{"start":{"line":1609,"column":1},"end":{"line":1609,"column":1}},"key":"iQPRwGMbJL"}],"key":"bVq01izCtK"}],"key":"THyucmOGus"},{"type":"tableRow","position":{"start":{"line":1610,"column":1},"end":{"line":1610,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1610,"column":1},"end":{"line":1610,"column":1}},"children":[{"type":"inlineCode","value":"ax.loglog()","position":{"start":{"line":1610,"column":1},"end":{"line":1610,"column":1}},"key":"EcTuLFmq5n"}],"key":"U4VYL6z4oC"},{"type":"tableCell","position":{"start":{"line":1610,"column":1},"end":{"line":1610,"column":1}},"children":[{"type":"text","value":"Power laws","position":{"start":{"line":1610,"column":1},"end":{"line":1610,"column":1}},"key":"ZFRbWyvcih"}],"key":"HoAsR4XwHb"},{"type":"tableCell","position":{"start":{"line":1610,"column":1},"end":{"line":1610,"column":1}},"children":[{"type":"inlineCode","value":"ax.loglog(freq, power)","position":{"start":{"line":1610,"column":1},"end":{"line":1610,"column":1}},"key":"xd2NX2JCq1"}],"key":"wc8tPrRLzb"}],"key":"hwy05MMY5f"},{"type":"tableRow","position":{"start":{"line":1611,"column":1},"end":{"line":1611,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1611,"column":1},"end":{"line":1611,"column":1}},"children":[{"type":"inlineCode","value":"ax.semilogy()","position":{"start":{"line":1611,"column":1},"end":{"line":1611,"column":1}},"key":"xBJJcinceb"}],"key":"T7e3BVA3QO"},{"type":"tableCell","position":{"start":{"line":1611,"column":1},"end":{"line":1611,"column":1}},"children":[{"type":"text","value":"Exponential growth","position":{"start":{"line":1611,"column":1},"end":{"line":1611,"column":1}},"key":"muWKsqnpDD"}],"key":"kxIYRl6YSq"},{"type":"tableCell","position":{"start":{"line":1611,"column":1},"end":{"line":1611,"column":1}},"children":[{"type":"inlineCode","value":"ax.semilogy(time, counts)","position":{"start":{"line":1611,"column":1},"end":{"line":1611,"column":1}},"key":"bufbGLjUdE"}],"key":"DVE6lzZJJV"}],"key":"ZaX9MPx3u2"},{"type":"tableRow","position":{"start":{"line":1612,"column":1},"end":{"line":1612,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1612,"column":1},"end":{"line":1612,"column":1}},"children":[{"type":"inlineCode","value":"ax.semilogx()","position":{"start":{"line":1612,"column":1},"end":{"line":1612,"column":1}},"key":"FpGQgduk8W"}],"key":"DMtJrWlEy1"},{"type":"tableCell","position":{"start":{"line":1612,"column":1},"end":{"line":1612,"column":1}},"children":[{"type":"text","value":"Logarithmic relationships","position":{"start":{"line":1612,"column":1},"end":{"line":1612,"column":1}},"key":"eF4MuYBMNH"}],"key":"osj99bS3e9"},{"type":"tableCell","position":{"start":{"line":1612,"column":1},"end":{"line":1612,"column":1}},"children":[{"type":"inlineCode","value":"ax.semilogx(mass, radius)","position":{"start":{"line":1612,"column":1},"end":{"line":1612,"column":1}},"key":"hfR2nlVa7S"}],"key":"xJdkrODfaY"}],"key":"xM2Or3yCYE"},{"type":"tableRow","position":{"start":{"line":1613,"column":1},"end":{"line":1613,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1613,"column":1},"end":{"line":1613,"column":1}},"children":[{"type":"inlineCode","value":"ax.hist()","position":{"start":{"line":1613,"column":1},"end":{"line":1613,"column":1}},"key":"fenawQxYgh"}],"key":"HLLeIdeGya"},{"type":"tableCell","position":{"start":{"line":1613,"column":1},"end":{"line":1613,"column":1}},"children":[{"type":"text","value":"Distributions","position":{"start":{"line":1613,"column":1},"end":{"line":1613,"column":1}},"key":"GiLTHVieFv"}],"key":"WOIgEdtUeU"},{"type":"tableCell","position":{"start":{"line":1613,"column":1},"end":{"line":1613,"column":1}},"children":[{"type":"inlineCode","value":"ax.hist(data, bins=30)","position":{"start":{"line":1613,"column":1},"end":{"line":1613,"column":1}},"key":"QYsugBxRXJ"}],"key":"cSB0xfNS4s"}],"key":"BZZXA97cuJ"},{"type":"tableRow","position":{"start":{"line":1614,"column":1},"end":{"line":1614,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1614,"column":1},"end":{"line":1614,"column":1}},"children":[{"type":"inlineCode","value":"ax.imshow()","position":{"start":{"line":1614,"column":1},"end":{"line":1614,"column":1}},"key":"oiaJUQbYuU"}],"key":"UhIo6YFLNE"},{"type":"tableCell","position":{"start":{"line":1614,"column":1},"end":{"line":1614,"column":1}},"children":[{"type":"text","value":"2D arrays, images","position":{"start":{"line":1614,"column":1},"end":{"line":1614,"column":1}},"key":"vAPcC53nPI"}],"key":"okInFPMfvX"},{"type":"tableCell","position":{"start":{"line":1614,"column":1},"end":{"line":1614,"column":1}},"children":[{"type":"inlineCode","value":"ax.imshow(image, cmap='viridis')","position":{"start":{"line":1614,"column":1},"end":{"line":1614,"column":1}},"key":"RMXbymPZst"}],"key":"DASSRlZBMC"}],"key":"kdvZCgNSP2"}],"key":"FZg16uCQ2P"},{"type":"heading","depth":3,"position":{"start":{"line":1616,"column":1},"end":{"line":1616,"column":1}},"children":[{"type":"text","value":"Common Customizations","position":{"start":{"line":1616,"column":1},"end":{"line":1616,"column":1}},"key":"s9x1feG34x"}],"identifier":"common-customizations","label":"Common Customizations","html_id":"common-customizations","implicit":true,"key":"bn7tiMWXvI"},{"type":"table","position":{"start":{"line":1618,"column":1},"end":{"line":1627,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":1618,"column":1},"end":{"line":1618,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":1618,"column":1},"end":{"line":1618,"column":1}},"children":[{"type":"text","value":"Method","position":{"start":{"line":1618,"column":1},"end":{"line":1618,"column":1}},"key":"jAKGaBCdex"}],"key":"cU2MzsEgEU"},{"type":"tableCell","header":true,"position":{"start":{"line":1618,"column":1},"end":{"line":1618,"column":1}},"children":[{"type":"text","value":"Purpose","position":{"start":{"line":1618,"column":1},"end":{"line":1618,"column":1}},"key":"bqLXz25Slb"}],"key":"eMHnkiMEtu"},{"type":"tableCell","header":true,"position":{"start":{"line":1618,"column":1},"end":{"line":1618,"column":1}},"children":[{"type":"text","value":"Example","position":{"start":{"line":1618,"column":1},"end":{"line":1618,"column":1}},"key":"y2Z2Q11bfv"}],"key":"r53Iatfv3F"}],"key":"w2DjTjCmIY"},{"type":"tableRow","position":{"start":{"line":1620,"column":1},"end":{"line":1620,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1620,"column":1},"end":{"line":1620,"column":1}},"children":[{"type":"inlineCode","value":"ax.set_xlabel()","position":{"start":{"line":1620,"column":1},"end":{"line":1620,"column":1}},"key":"iex4qvuXqc"}],"key":"YKp4FS1o08"},{"type":"tableCell","position":{"start":{"line":1620,"column":1},"end":{"line":1620,"column":1}},"children":[{"type":"text","value":"Label x-axis","position":{"start":{"line":1620,"column":1},"end":{"line":1620,"column":1}},"key":"KAnpNSDbID"}],"key":"oRFaZMgUPI"},{"type":"tableCell","position":{"start":{"line":1620,"column":1},"end":{"line":1620,"column":1}},"children":[{"type":"inlineCode","value":"ax.set_xlabel('Time (days)')","position":{"start":{"line":1620,"column":1},"end":{"line":1620,"column":1}},"key":"YlGwAEpMkv"}],"key":"IsPdUERGwU"}],"key":"ntS1COQ6LZ"},{"type":"tableRow","position":{"start":{"line":1621,"column":1},"end":{"line":1621,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1621,"column":1},"end":{"line":1621,"column":1}},"children":[{"type":"inlineCode","value":"ax.set_ylabel()","position":{"start":{"line":1621,"column":1},"end":{"line":1621,"column":1}},"key":"cVVehVqYOf"}],"key":"YIIkFr0xxr"},{"type":"tableCell","position":{"start":{"line":1621,"column":1},"end":{"line":1621,"column":1}},"children":[{"type":"text","value":"Label y-axis","position":{"start":{"line":1621,"column":1},"end":{"line":1621,"column":1}},"key":"d2OX3K810F"}],"key":"VmVzn0ublT"},{"type":"tableCell","position":{"start":{"line":1621,"column":1},"end":{"line":1621,"column":1}},"children":[{"type":"inlineCode","value":"ax.set_ylabel('Flux (Jy)')","position":{"start":{"line":1621,"column":1},"end":{"line":1621,"column":1}},"key":"V8A6uPCZrp"}],"key":"eTVbaag3Zc"}],"key":"xeSlpxBxGq"},{"type":"tableRow","position":{"start":{"line":1622,"column":1},"end":{"line":1622,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1622,"column":1},"end":{"line":1622,"column":1}},"children":[{"type":"inlineCode","value":"ax.set_title()","position":{"start":{"line":1622,"column":1},"end":{"line":1622,"column":1}},"key":"aPeYFrNcht"}],"key":"WWSSnUuKt7"},{"type":"tableCell","position":{"start":{"line":1622,"column":1},"end":{"line":1622,"column":1}},"children":[{"type":"text","value":"Add title","position":{"start":{"line":1622,"column":1},"end":{"line":1622,"column":1}},"key":"heHTu58zUt"}],"key":"F4T2gqQaV6"},{"type":"tableCell","position":{"start":{"line":1622,"column":1},"end":{"line":1622,"column":1}},"children":[{"type":"inlineCode","value":"ax.set_title('Light Curve')","position":{"start":{"line":1622,"column":1},"end":{"line":1622,"column":1}},"key":"Li0bHZO3B8"}],"key":"XWbtiaLWkH"}],"key":"E5wNYyAHVI"},{"type":"tableRow","position":{"start":{"line":1623,"column":1},"end":{"line":1623,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1623,"column":1},"end":{"line":1623,"column":1}},"children":[{"type":"inlineCode","value":"ax.legend()","position":{"start":{"line":1623,"column":1},"end":{"line":1623,"column":1}},"key":"CWhoqfUd4d"}],"key":"AYScNpe9U3"},{"type":"tableCell","position":{"start":{"line":1623,"column":1},"end":{"line":1623,"column":1}},"children":[{"type":"text","value":"Add legend","position":{"start":{"line":1623,"column":1},"end":{"line":1623,"column":1}},"key":"QTiTtl4kJf"}],"key":"LoiJPkaYIo"},{"type":"tableCell","position":{"start":{"line":1623,"column":1},"end":{"line":1623,"column":1}},"children":[{"type":"inlineCode","value":"ax.legend(loc='upper right')","position":{"start":{"line":1623,"column":1},"end":{"line":1623,"column":1}},"key":"b0AO8f3N5G"}],"key":"ihjXYWO60P"}],"key":"Vk2OVnAeXd"},{"type":"tableRow","position":{"start":{"line":1624,"column":1},"end":{"line":1624,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1624,"column":1},"end":{"line":1624,"column":1}},"children":[{"type":"inlineCode","value":"ax.grid()","position":{"start":{"line":1624,"column":1},"end":{"line":1624,"column":1}},"key":"VSdL8tHShz"}],"key":"Jyp28oCA3R"},{"type":"tableCell","position":{"start":{"line":1624,"column":1},"end":{"line":1624,"column":1}},"children":[{"type":"text","value":"Add grid lines","position":{"start":{"line":1624,"column":1},"end":{"line":1624,"column":1}},"key":"Ek6sG4ssew"}],"key":"OjhkoxrUTB"},{"type":"tableCell","position":{"start":{"line":1624,"column":1},"end":{"line":1624,"column":1}},"children":[{"type":"inlineCode","value":"ax.grid(True, alpha=0.3)","position":{"start":{"line":1624,"column":1},"end":{"line":1624,"column":1}},"key":"spFP1lI2cC"}],"key":"gPIjbVDJms"}],"key":"mgPwxDa1X5"},{"type":"tableRow","position":{"start":{"line":1625,"column":1},"end":{"line":1625,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1625,"column":1},"end":{"line":1625,"column":1}},"children":[{"type":"inlineCode","value":"ax.set_xlim()","position":{"start":{"line":1625,"column":1},"end":{"line":1625,"column":1}},"key":"JTajNRvy6G"}],"key":"UmfuWMSYsf"},{"type":"tableCell","position":{"start":{"line":1625,"column":1},"end":{"line":1625,"column":1}},"children":[{"type":"text","value":"Set x-axis limits","position":{"start":{"line":1625,"column":1},"end":{"line":1625,"column":1}},"key":"GDBrS3c7B1"}],"key":"bpUpkp2Pyb"},{"type":"tableCell","position":{"start":{"line":1625,"column":1},"end":{"line":1625,"column":1}},"children":[{"type":"inlineCode","value":"ax.set_xlim(0, 10)","position":{"start":{"line":1625,"column":1},"end":{"line":1625,"column":1}},"key":"PkdDbpECgY"}],"key":"wAbaHik4TL"}],"key":"SxhTdb9cLA"},{"type":"tableRow","position":{"start":{"line":1626,"column":1},"end":{"line":1626,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1626,"column":1},"end":{"line":1626,"column":1}},"children":[{"type":"inlineCode","value":"ax.invert_yaxis()","position":{"start":{"line":1626,"column":1},"end":{"line":1626,"column":1}},"key":"FKp9hc8pPT"}],"key":"DtkBW8OFku"},{"type":"tableCell","position":{"start":{"line":1626,"column":1},"end":{"line":1626,"column":1}},"children":[{"type":"text","value":"Flip axis","position":{"start":{"line":1626,"column":1},"end":{"line":1626,"column":1}},"key":"PhvT1MUrBN"}],"key":"IVUzs9GSrT"},{"type":"tableCell","position":{"start":{"line":1626,"column":1},"end":{"line":1626,"column":1}},"children":[{"type":"inlineCode","value":"ax.invert_yaxis()","position":{"start":{"line":1626,"column":1},"end":{"line":1626,"column":1}},"key":"lZyW3lO7dv"}],"key":"YjQXfqepg4"}],"key":"DAPP8zyuUS"},{"type":"tableRow","position":{"start":{"line":1627,"column":1},"end":{"line":1627,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1627,"column":1},"end":{"line":1627,"column":1}},"children":[{"type":"inlineCode","value":"ax.tick_params()","position":{"start":{"line":1627,"column":1},"end":{"line":1627,"column":1}},"key":"tEzuVcAQgZ"}],"key":"aPUE4J7rgY"},{"type":"tableCell","position":{"start":{"line":1627,"column":1},"end":{"line":1627,"column":1}},"children":[{"type":"text","value":"Adjust ticks","position":{"start":{"line":1627,"column":1},"end":{"line":1627,"column":1}},"key":"cRJFRapt6f"}],"key":"Ld75FHuVRv"},{"type":"tableCell","position":{"start":{"line":1627,"column":1},"end":{"line":1627,"column":1}},"children":[{"type":"inlineCode","value":"ax.tick_params(labelsize=10)","position":{"start":{"line":1627,"column":1},"end":{"line":1627,"column":1}},"key":"P454dbCD5K"}],"key":"R4pn7vEQB2"}],"key":"dA5ncqG5H7"}],"key":"AxjyYAfZ5J"},{"type":"heading","depth":3,"position":{"start":{"line":1629,"column":1},"end":{"line":1629,"column":1}},"children":[{"type":"text","value":"Figure Export Settings","position":{"start":{"line":1629,"column":1},"end":{"line":1629,"column":1}},"key":"Z6quRs2ExA"}],"identifier":"figure-export-settings","label":"Figure Export Settings","html_id":"figure-export-settings","implicit":true,"key":"gpV9zfaAzO"},{"type":"table","position":{"start":{"line":1631,"column":1},"end":{"line":1636,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":1631,"column":1},"end":{"line":1631,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":1631,"column":1},"end":{"line":1631,"column":1}},"children":[{"type":"text","value":"Format","position":{"start":{"line":1631,"column":1},"end":{"line":1631,"column":1}},"key":"MyV7tGIOdd"}],"key":"SfJrBrbUMa"},{"type":"tableCell","header":true,"position":{"start":{"line":1631,"column":1},"end":{"line":1631,"column":1}},"children":[{"type":"text","value":"Use Case","position":{"start":{"line":1631,"column":1},"end":{"line":1631,"column":1}},"key":"FOOoWPd4rk"}],"key":"iTMYyPqOtX"},{"type":"tableCell","header":true,"position":{"start":{"line":1631,"column":1},"end":{"line":1631,"column":1}},"children":[{"type":"text","value":"Typical Settings","position":{"start":{"line":1631,"column":1},"end":{"line":1631,"column":1}},"key":"EuUIO7zJR7"}],"key":"i7OckCJSjJ"}],"key":"QrMyYtNxgu"},{"type":"tableRow","position":{"start":{"line":1633,"column":1},"end":{"line":1633,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1633,"column":1},"end":{"line":1633,"column":1}},"children":[{"type":"text","value":"PDF","position":{"start":{"line":1633,"column":1},"end":{"line":1633,"column":1}},"key":"DEPJXsG7hB"}],"key":"J5iFxeOrg3"},{"type":"tableCell","position":{"start":{"line":1633,"column":1},"end":{"line":1633,"column":1}},"children":[{"type":"text","value":"Publication (vector)","position":{"start":{"line":1633,"column":1},"end":{"line":1633,"column":1}},"key":"eD0yunlnXf"}],"key":"CQzPjlcLYl"},{"type":"tableCell","position":{"start":{"line":1633,"column":1},"end":{"line":1633,"column":1}},"children":[{"type":"inlineCode","value":"dpi=300, bbox_inches='tight'","position":{"start":{"line":1633,"column":1},"end":{"line":1633,"column":1}},"key":"mifYnLdXtP"}],"key":"dYN2ADi2hE"}],"key":"Rp68gOOoun"},{"type":"tableRow","position":{"start":{"line":1634,"column":1},"end":{"line":1634,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1634,"column":1},"end":{"line":1634,"column":1}},"children":[{"type":"text","value":"PNG","position":{"start":{"line":1634,"column":1},"end":{"line":1634,"column":1}},"key":"dcI0GUofi1"}],"key":"gHyfOiYd3B"},{"type":"tableCell","position":{"start":{"line":1634,"column":1},"end":{"line":1634,"column":1}},"children":[{"type":"text","value":"Web, backup (raster)","position":{"start":{"line":1634,"column":1},"end":{"line":1634,"column":1}},"key":"WafI03Dc7W"}],"key":"LVfio9eFDN"},{"type":"tableCell","position":{"start":{"line":1634,"column":1},"end":{"line":1634,"column":1}},"children":[{"type":"inlineCode","value":"dpi=150-300, transparent=False","position":{"start":{"line":1634,"column":1},"end":{"line":1634,"column":1}},"key":"WgTzcm5kop"}],"key":"yiVlj6Necx"}],"key":"wuYadNMltr"},{"type":"tableRow","position":{"start":{"line":1635,"column":1},"end":{"line":1635,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1635,"column":1},"end":{"line":1635,"column":1}},"children":[{"type":"text","value":"SVG","position":{"start":{"line":1635,"column":1},"end":{"line":1635,"column":1}},"key":"D9NvCyQk7e"}],"key":"U2RQsHWo8W"},{"type":"tableCell","position":{"start":{"line":1635,"column":1},"end":{"line":1635,"column":1}},"children":[{"type":"text","value":"Vector editing","position":{"start":{"line":1635,"column":1},"end":{"line":1635,"column":1}},"key":"F3wYoY7ZjT"}],"key":"Z9GzisQrHj"},{"type":"tableCell","position":{"start":{"line":1635,"column":1},"end":{"line":1635,"column":1}},"children":[{"type":"inlineCode","value":"bbox_inches='tight'","position":{"start":{"line":1635,"column":1},"end":{"line":1635,"column":1}},"key":"CtJjwEtZFl"}],"key":"VHEUOk1T4d"}],"key":"BVqQROmYJL"},{"type":"tableRow","position":{"start":{"line":1636,"column":1},"end":{"line":1636,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":1636,"column":1},"end":{"line":1636,"column":1}},"children":[{"type":"text","value":"EPS","position":{"start":{"line":1636,"column":1},"end":{"line":1636,"column":1}},"key":"F9yg8pmT6c"}],"key":"bqTxv6YTwR"},{"type":"tableCell","position":{"start":{"line":1636,"column":1},"end":{"line":1636,"column":1}},"children":[{"type":"text","value":"Legacy journals","position":{"start":{"line":1636,"column":1},"end":{"line":1636,"column":1}},"key":"XCKaX9UuG7"}],"key":"vAGY6fMPNd"},{"type":"tableCell","position":{"start":{"line":1636,"column":1},"end":{"line":1636,"column":1}},"children":[{"type":"inlineCode","value":"dpi=300, bbox_inches='tight'","position":{"start":{"line":1636,"column":1},"end":{"line":1636,"column":1}},"key":"JsIG9yuS4C"}],"key":"id8ZVfDMzA"}],"key":"LhJBvfREKI"}],"key":"p2QkvlP3Rq"},{"type":"heading","depth":2,"position":{"start":{"line":1638,"column":1},"end":{"line":1638,"column":1}},"children":[{"type":"text","value":"References","position":{"start":{"line":1638,"column":1},"end":{"line":1638,"column":1}},"key":"m3X30T1AnK"}],"identifier":"references","label":"References","html_id":"references","implicit":true,"key":"MffAw46XAc"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":1640,"column":1},"end":{"line":1669,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1640,"column":1},"end":{"line":1641,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1640,"column":1},"end":{"line":1640,"column":1}},"children":[{"type":"text","value":"Borucki, W. J., et al. (2010). ","position":{"start":{"line":1640,"column":1},"end":{"line":1640,"column":1}},"key":"ErEuIKyXjT"},{"type":"strong","position":{"start":{"line":1640,"column":1},"end":{"line":1640,"column":1}},"children":[{"type":"text","value":"Kepler planet-detection mission: introduction and first results","position":{"start":{"line":1640,"column":1},"end":{"line":1640,"column":1}},"key":"uWDNDvYYwa"}],"key":"y596KD2n43"},{"type":"text","value":". ","position":{"start":{"line":1640,"column":1},"end":{"line":1640,"column":1}},"key":"kuu8jECNPU"},{"type":"emphasis","position":{"start":{"line":1640,"column":1},"end":{"line":1640,"column":1}},"children":[{"type":"text","value":"Science","position":{"start":{"line":1640,"column":1},"end":{"line":1640,"column":1}},"key":"uaRS3peUqx"}],"key":"uFeLpF43G8"},{"type":"text","value":", 327(5968), 977-980.","position":{"start":{"line":1640,"column":1},"end":{"line":1640,"column":1}},"key":"agZu76ssLZ"}],"key":"oBC8VFkprA"}],"key":"rt4TIh2ree"},{"type":"listItem","spread":true,"position":{"start":{"line":1642,"column":1},"end":{"line":1643,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1642,"column":1},"end":{"line":1642,"column":1}},"children":[{"type":"text","value":"Crameri, F., Shephard, G. E., & Heron, P. J. (2020). ","position":{"start":{"line":1642,"column":1},"end":{"line":1642,"column":1}},"key":"LGVN1LR6Vd"},{"type":"strong","position":{"start":{"line":1642,"column":1},"end":{"line":1642,"column":1}},"children":[{"type":"text","value":"The misuse of colour in science communication","position":{"start":{"line":1642,"column":1},"end":{"line":1642,"column":1}},"key":"rQR8XZzgbF"}],"key":"BYIuHAssSF"},{"type":"text","value":". ","position":{"start":{"line":1642,"column":1},"end":{"line":1642,"column":1}},"key":"W3ZLNwxgy9"},{"type":"emphasis","position":{"start":{"line":1642,"column":1},"end":{"line":1642,"column":1}},"children":[{"type":"text","value":"Nature Communications","position":{"start":{"line":1642,"column":1},"end":{"line":1642,"column":1}},"key":"YfQuihcQxc"}],"key":"m51UaoGdfl"},{"type":"text","value":", 11(1), 1-10.","position":{"start":{"line":1642,"column":1},"end":{"line":1642,"column":1}},"key":"GPxIkn424M"}],"key":"xvQWLfmZ68"}],"key":"V21W0xmFjP"},{"type":"listItem","spread":true,"position":{"start":{"line":1644,"column":1},"end":{"line":1645,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1644,"column":1},"end":{"line":1644,"column":1}},"children":[{"type":"text","value":"Hubble, E. (1929). ","position":{"start":{"line":1644,"column":1},"end":{"line":1644,"column":1}},"key":"Jv3A0gYNEE"},{"type":"strong","position":{"start":{"line":1644,"column":1},"end":{"line":1644,"column":1}},"children":[{"type":"text","value":"A relation between distance and radial velocity among extra-galactic nebulae","position":{"start":{"line":1644,"column":1},"end":{"line":1644,"column":1}},"key":"wzvXM3kex8"}],"key":"U85FZcjqtj"},{"type":"text","value":". ","position":{"start":{"line":1644,"column":1},"end":{"line":1644,"column":1}},"key":"F9M5wnVt51"},{"type":"emphasis","position":{"start":{"line":1644,"column":1},"end":{"line":1644,"column":1}},"children":[{"type":"text","value":"Proceedings of the National Academy of Sciences","position":{"start":{"line":1644,"column":1},"end":{"line":1644,"column":1}},"key":"vVM6oCI4kp"}],"key":"SmFuSSvB3l"},{"type":"text","value":", 15(3), 168-173.","position":{"start":{"line":1644,"column":1},"end":{"line":1644,"column":1}},"key":"CtwrEFw8jH"}],"key":"VGDTCxMy4r"}],"key":"WGSb8Cdhtm"},{"type":"listItem","spread":true,"position":{"start":{"line":1646,"column":1},"end":{"line":1647,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1646,"column":1},"end":{"line":1646,"column":1}},"children":[{"type":"text","value":"Hunter, J. D. (2007). ","position":{"start":{"line":1646,"column":1},"end":{"line":1646,"column":1}},"key":"z8pQNJFh0n"},{"type":"strong","position":{"start":{"line":1646,"column":1},"end":{"line":1646,"column":1}},"children":[{"type":"text","value":"Matplotlib: A 2D graphics environment","position":{"start":{"line":1646,"column":1},"end":{"line":1646,"column":1}},"key":"E0MCNvYxra"}],"key":"YUnofLM2Tu"},{"type":"text","value":". ","position":{"start":{"line":1646,"column":1},"end":{"line":1646,"column":1}},"key":"Tebjxff3uO"},{"type":"emphasis","position":{"start":{"line":1646,"column":1},"end":{"line":1646,"column":1}},"children":[{"type":"text","value":"Computing in Science & Engineering","position":{"start":{"line":1646,"column":1},"end":{"line":1646,"column":1}},"key":"XhXndNW0e6"}],"key":"vmZA2ttvB2"},{"type":"text","value":", 9(3), 90-95.","position":{"start":{"line":1646,"column":1},"end":{"line":1646,"column":1}},"key":"IUqnA7qgiQ"}],"key":"a4vq3sWziN"}],"key":"xJbWSrURPc"},{"type":"listItem","spread":true,"position":{"start":{"line":1648,"column":1},"end":{"line":1649,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1648,"column":1},"end":{"line":1648,"column":1}},"children":[{"type":"text","value":"Perlmutter, S., et al. (1999). ","position":{"start":{"line":1648,"column":1},"end":{"line":1648,"column":1}},"key":"TCOjytt24m"},{"type":"strong","position":{"start":{"line":1648,"column":1},"end":{"line":1648,"column":1}},"children":[{"type":"text","value":"Measurements of Ω and Λ from 42 high-redshift supernovae","position":{"start":{"line":1648,"column":1},"end":{"line":1648,"column":1}},"key":"EurVDCAD8e"}],"key":"cTyRDegJ6l"},{"type":"text","value":". ","position":{"start":{"line":1648,"column":1},"end":{"line":1648,"column":1}},"key":"azT9utPqgg"},{"type":"emphasis","position":{"start":{"line":1648,"column":1},"end":{"line":1648,"column":1}},"children":[{"type":"text","value":"The Astrophysical Journal","position":{"start":{"line":1648,"column":1},"end":{"line":1648,"column":1}},"key":"DHexaSvNIE"}],"key":"RLBGQsn1NH"},{"type":"text","value":", 517(2), 565-586.","position":{"start":{"line":1648,"column":1},"end":{"line":1648,"column":1}},"key":"db6eYyNqrp"}],"key":"y1PM5xoiLW"}],"key":"A8VTL36Ucn"},{"type":"listItem","spread":true,"position":{"start":{"line":1650,"column":1},"end":{"line":1651,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1650,"column":1},"end":{"line":1650,"column":1}},"children":[{"type":"text","value":"Riess, A. G., et al. (1998). ","position":{"start":{"line":1650,"column":1},"end":{"line":1650,"column":1}},"key":"q4GBxrzUux"},{"type":"strong","position":{"start":{"line":1650,"column":1},"end":{"line":1650,"column":1}},"children":[{"type":"text","value":"Observational evidence from supernovae for an accelerating universe and a cosmological constant","position":{"start":{"line":1650,"column":1},"end":{"line":1650,"column":1}},"key":"aNViasvKTJ"}],"key":"LhX6eIwzdm"},{"type":"text","value":". ","position":{"start":{"line":1650,"column":1},"end":{"line":1650,"column":1}},"key":"VxJeAW4AAu"},{"type":"emphasis","position":{"start":{"line":1650,"column":1},"end":{"line":1650,"column":1}},"children":[{"type":"text","value":"The Astronomical Journal","position":{"start":{"line":1650,"column":1},"end":{"line":1650,"column":1}},"key":"WziHf7zXIW"}],"key":"azEzP5En31"},{"type":"text","value":", 116(3), 1009-1038.","position":{"start":{"line":1650,"column":1},"end":{"line":1650,"column":1}},"key":"yOa4uXeRBC"}],"key":"yu4LklPUYb"}],"key":"dpwbU4xR58"},{"type":"listItem","spread":true,"position":{"start":{"line":1652,"column":1},"end":{"line":1653,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1652,"column":1},"end":{"line":1652,"column":1}},"children":[{"type":"text","value":"Rougier, N. P. (2018). ","position":{"start":{"line":1652,"column":1},"end":{"line":1652,"column":1}},"key":"So2GExCTs9"},{"type":"strong","position":{"start":{"line":1652,"column":1},"end":{"line":1652,"column":1}},"children":[{"type":"text","value":"Scientific Visualization: Python + Matplotlib","position":{"start":{"line":1652,"column":1},"end":{"line":1652,"column":1}},"key":"gexG79aOHS"}],"key":"tIEwaxknCo"},{"type":"text","value":". Self-published. Available at: ","position":{"start":{"line":1652,"column":1},"end":{"line":1652,"column":1}},"key":"Ee4UBqLkXl"},{"type":"link","url":"https://github.com/rougier/scientific-visualization-book","position":{"start":{"line":1652,"column":1},"end":{"line":1652,"column":1}},"children":[{"type":"text","value":"https://​github​.com​/rougier​/scientific​-visualization​-book","position":{"start":{"line":1652,"column":1},"end":{"line":1652,"column":1}},"key":"eYlyuIasUi"}],"urlSource":"https://github.com/rougier/scientific-visualization-book","error":true,"key":"KtJIqhP2Ux"}],"key":"lrSmEZa3eT"}],"key":"aVH18MFmTh"},{"type":"listItem","spread":true,"position":{"start":{"line":1654,"column":1},"end":{"line":1655,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1654,"column":1},"end":{"line":1654,"column":1}},"children":[{"type":"text","value":"Rougier, N. P., et al. (2014). ","position":{"start":{"line":1654,"column":1},"end":{"line":1654,"column":1}},"key":"zAFo4hP101"},{"type":"strong","position":{"start":{"line":1654,"column":1},"end":{"line":1654,"column":1}},"children":[{"type":"text","value":"Ten simple rules for better figures","position":{"start":{"line":1654,"column":1},"end":{"line":1654,"column":1}},"key":"NdW69z68Qe"}],"key":"vWVYuhh7P2"},{"type":"text","value":". ","position":{"start":{"line":1654,"column":1},"end":{"line":1654,"column":1}},"key":"A1m6t2g9Pm"},{"type":"emphasis","position":{"start":{"line":1654,"column":1},"end":{"line":1654,"column":1}},"children":[{"type":"text","value":"PLoS Computational Biology","position":{"start":{"line":1654,"column":1},"end":{"line":1654,"column":1}},"key":"x43zN3Nnyj"}],"key":"xpm4O92Zz7"},{"type":"text","value":", 10(9), e1003833.","position":{"start":{"line":1654,"column":1},"end":{"line":1654,"column":1}},"key":"oa9nIBnGT1"}],"key":"SY2GqHgLK1"}],"key":"Bm9bD7GXu5"},{"type":"listItem","spread":true,"position":{"start":{"line":1656,"column":1},"end":{"line":1657,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1656,"column":1},"end":{"line":1656,"column":1}},"children":[{"type":"text","value":"Salpeter, E. E. (1955). ","position":{"start":{"line":1656,"column":1},"end":{"line":1656,"column":1}},"key":"m0kjcgCuoF"},{"type":"strong","position":{"start":{"line":1656,"column":1},"end":{"line":1656,"column":1}},"children":[{"type":"text","value":"The luminosity function and stellar evolution","position":{"start":{"line":1656,"column":1},"end":{"line":1656,"column":1}},"key":"I64hLCbzGs"}],"key":"USkUn1oOW4"},{"type":"text","value":". ","position":{"start":{"line":1656,"column":1},"end":{"line":1656,"column":1}},"key":"HT8xEZl0uG"},{"type":"emphasis","position":{"start":{"line":1656,"column":1},"end":{"line":1656,"column":1}},"children":[{"type":"text","value":"The Astrophysical Journal","position":{"start":{"line":1656,"column":1},"end":{"line":1656,"column":1}},"key":"E0yYrauGJA"}],"key":"zYOxI38v9m"},{"type":"text","value":", 121, 161-167.","position":{"start":{"line":1656,"column":1},"end":{"line":1656,"column":1}},"key":"iGQISWfWXO"}],"key":"Lmq4NdCwKu"}],"key":"Vv4EGk00ZC"},{"type":"listItem","spread":true,"position":{"start":{"line":1658,"column":1},"end":{"line":1659,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1658,"column":1},"end":{"line":1658,"column":1}},"children":[{"type":"text","value":"Schechter, P. (1976). ","position":{"start":{"line":1658,"column":1},"end":{"line":1658,"column":1}},"key":"usga7yW8OH"},{"type":"strong","position":{"start":{"line":1658,"column":1},"end":{"line":1658,"column":1}},"children":[{"type":"text","value":"An analytic expression for the luminosity function for galaxies","position":{"start":{"line":1658,"column":1},"end":{"line":1658,"column":1}},"key":"IGtqNYlHwI"}],"key":"AhxXDuDCkS"},{"type":"text","value":". ","position":{"start":{"line":1658,"column":1},"end":{"line":1658,"column":1}},"key":"oIRYSfl2H1"},{"type":"emphasis","position":{"start":{"line":1658,"column":1},"end":{"line":1658,"column":1}},"children":[{"type":"text","value":"The Astrophysical Journal","position":{"start":{"line":1658,"column":1},"end":{"line":1658,"column":1}},"key":"GnnXIIcBI4"}],"key":"PC76ODkRFV"},{"type":"text","value":", 203, 297-306.","position":{"start":{"line":1658,"column":1},"end":{"line":1658,"column":1}},"key":"TJ3rrhXqYm"}],"key":"HSVO8tUUdx"}],"key":"gYSIZFkBAr"},{"type":"listItem","spread":true,"position":{"start":{"line":1660,"column":1},"end":{"line":1661,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1660,"column":1},"end":{"line":1660,"column":1}},"children":[{"type":"text","value":"Tufte, E. R. (2001). ","position":{"start":{"line":1660,"column":1},"end":{"line":1660,"column":1}},"key":"H2fOlfJgYq"},{"type":"strong","position":{"start":{"line":1660,"column":1},"end":{"line":1660,"column":1}},"children":[{"type":"text","value":"The Visual Display of Quantitative Information","position":{"start":{"line":1660,"column":1},"end":{"line":1660,"column":1}},"key":"j9hkpFbWkf"}],"key":"D9CoS8hMut"},{"type":"text","value":" (2nd ed.). Graphics Press.","position":{"start":{"line":1660,"column":1},"end":{"line":1660,"column":1}},"key":"bhNwUIFqyE"}],"key":"Uiwvyaoebx"}],"key":"Ssq4UvuRas"},{"type":"listItem","spread":true,"position":{"start":{"line":1662,"column":1},"end":{"line":1663,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1662,"column":1},"end":{"line":1662,"column":1}},"children":[{"type":"text","value":"VanderPlas, J. (2016). ","position":{"start":{"line":1662,"column":1},"end":{"line":1662,"column":1}},"key":"FXftWCkepD"},{"type":"strong","position":{"start":{"line":1662,"column":1},"end":{"line":1662,"column":1}},"children":[{"type":"text","value":"Python Data Science Handbook","position":{"start":{"line":1662,"column":1},"end":{"line":1662,"column":1}},"key":"ijfhrKTrTS"}],"key":"EltPJC2PAV"},{"type":"text","value":". O’Reilly Media.","position":{"start":{"line":1662,"column":1},"end":{"line":1662,"column":1}},"key":"Lqv5tNz2VI"}],"key":"KjI0VXK2jT"}],"key":"Z0kqHxBC9i"},{"type":"listItem","spread":true,"position":{"start":{"line":1664,"column":1},"end":{"line":1665,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1664,"column":1},"end":{"line":1664,"column":1}},"children":[{"type":"text","value":"Wilke, C. O. (2019). ","position":{"start":{"line":1664,"column":1},"end":{"line":1664,"column":1}},"key":"PpyLOBYFWY"},{"type":"strong","position":{"start":{"line":1664,"column":1},"end":{"line":1664,"column":1}},"children":[{"type":"text","value":"Fundamentals of Data Visualization","position":{"start":{"line":1664,"column":1},"end":{"line":1664,"column":1}},"key":"bOIHX4Ljsw"}],"key":"diCvWw8DFD"},{"type":"text","value":". O’Reilly Media.","position":{"start":{"line":1664,"column":1},"end":{"line":1664,"column":1}},"key":"s41mFZ0KIf"}],"key":"bsf28jGwQ6"}],"key":"Q3v0Z4xnSR"},{"type":"listItem","spread":true,"position":{"start":{"line":1666,"column":1},"end":{"line":1667,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1666,"column":1},"end":{"line":1666,"column":1}},"children":[{"type":"text","value":"Wong, B. (2011). ","position":{"start":{"line":1666,"column":1},"end":{"line":1666,"column":1}},"key":"JPXA0AkUmf"},{"type":"strong","position":{"start":{"line":1666,"column":1},"end":{"line":1666,"column":1}},"children":[{"type":"text","value":"Points of view: Color blindness","position":{"start":{"line":1666,"column":1},"end":{"line":1666,"column":1}},"key":"HYKol2c5Oj"}],"key":"AQKdhkaU7m"},{"type":"text","value":". ","position":{"start":{"line":1666,"column":1},"end":{"line":1666,"column":1}},"key":"zDk4aidtHb"},{"type":"emphasis","position":{"start":{"line":1666,"column":1},"end":{"line":1666,"column":1}},"children":[{"type":"text","value":"Nature Methods","position":{"start":{"line":1666,"column":1},"end":{"line":1666,"column":1}},"key":"Nvatb09Uxk"}],"key":"rkKFK55GOS"},{"type":"text","value":", 8(6), 441.","position":{"start":{"line":1666,"column":1},"end":{"line":1666,"column":1}},"key":"lRkLOQvoJs"}],"key":"baOygAsQPB"}],"key":"HFEvGTlppW"},{"type":"listItem","spread":true,"position":{"start":{"line":1668,"column":1},"end":{"line":1669,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1668,"column":1},"end":{"line":1668,"column":1}},"children":[{"type":"text","value":"The Matplotlib Development Team. (2023). ","position":{"start":{"line":1668,"column":1},"end":{"line":1668,"column":1}},"key":"wuqabN34qP"},{"type":"strong","position":{"start":{"line":1668,"column":1},"end":{"line":1668,"column":1}},"children":[{"type":"text","value":"Matplotlib Documentation","position":{"start":{"line":1668,"column":1},"end":{"line":1668,"column":1}},"key":"IvSLnXEW3h"}],"key":"Dd93rsf1hH"},{"type":"text","value":". ","position":{"start":{"line":1668,"column":1},"end":{"line":1668,"column":1}},"key":"VhBs4YAcTs"},{"type":"link","url":"https://matplotlib.org/stable/index.html","position":{"start":{"line":1668,"column":1},"end":{"line":1668,"column":1}},"children":[{"type":"text","value":"https://​matplotlib​.org​/stable​/index​.html","position":{"start":{"line":1668,"column":1},"end":{"line":1668,"column":1}},"key":"mRsWB9peCI"}],"urlSource":"https://matplotlib.org/stable/index.html","key":"rCORm85ipS"}],"key":"Y9BaGy8d0n"}],"key":"wrmn1dvH26"}],"key":"GQKwnvKAjy"},{"type":"heading","depth":2,"position":{"start":{"line":1670,"column":1},"end":{"line":1670,"column":1}},"children":[{"type":"text","value":"Next Chapter Preview","position":{"start":{"line":1670,"column":1},"end":{"line":1670,"column":1}},"key":"iFbOE1oUK7"}],"identifier":"next-chapter-preview","label":"Next Chapter Preview","html_id":"next-chapter-preview","implicit":true,"key":"O4oZ5F8bGQ"},{"type":"paragraph","position":{"start":{"line":1672,"column":1},"end":{"line":1672,"column":1}},"children":[{"type":"text","value":"In Chapter 9: Robust Computing - Writing Reliable Scientific Code, you’ll learn how to transform your scripts from fragile prototypes into robust, reliable tools that can handle the messiness of real astronomical data. You’ll master error handling with try-except blocks, learning to gracefully manage missing files, corrupted data, and numerical edge cases that would otherwise crash your analysis. You’ll discover defensive programming techniques that validate inputs, check assumptions, and fail informatively when something goes wrong. Most importantly, you’ll learn to write code that helps you debug problems quickly — using logging instead of print statements, creating useful error messages, and structuring your code to isolate failures. The visualization skills you’ve developed with Matplotlib will become powerful debugging tools, helping you create diagnostic plots that reveal where your code is failing and why. These skills are essential for research computing, where your code needs to process thousands of files from telescopes, handle incomplete observations, and work with data that’s often messier than textbook examples. You’ll learn that robust code isn’t about preventing all errors — it’s about failing gracefully, recovering when possible, and always giving you enough information to understand what went wrong!","position":{"start":{"line":1672,"column":1},"end":{"line":1672,"column":1}},"key":"FurTusLIBJ"}],"key":"mB2KiptauU"}],"key":"n8wo8WU2Y9"}],"key":"nRmNctHhsV"},"references":{"cite":{"order":[],"data":{}}}}