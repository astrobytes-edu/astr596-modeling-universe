<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>ASTR 596 Project 2: N-Body Dynamics + Statistical Sampling + Stellar Systems - ASTR 596: Modeling the Universe</title><meta property="og:title" content="ASTR 596 Project 2: N-Body Dynamics + Statistical Sampling + Stellar Systems - ASTR 596: Modeling the Universe"/><meta name="generator" content="mystmd"/><meta name="description" content="Graduate-level computational astrophysics course emphasizing glass-box modeling and modern computational frameworks"/><meta property="og:description" content="Graduate-level computational astrophysics course emphasizing glass-box modeling and modern computational frameworks"/><meta name="keywords" content="computational astrophysics, python, numerical methods, machine learning, monte carlo, neural networks, radiative transfer, bayesian inference, JAX"/><link rel="stylesheet" href="/build/_assets/app-5WKS5EPQ.css"/><link rel="stylesheet" href="/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/favicon.ico"/><link rel="stylesheet" href="/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">✨ASTR 596✨</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="ASTR 596: Modeling the Universe" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/">ASTR 596: Modeling the Universe</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Course Info" class="block break-words rounded py-2 grow cursor-pointer">Course Info</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Getting Started" class="block break-words rounded py-2 grow cursor-pointer">Getting Started</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rup8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rup8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Python" class="block break-words rounded py-2 grow cursor-pointer">Python</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R16p8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R16p8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Computational Methods" class="block break-words rounded py-2 grow cursor-pointer">Computational Methods</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1ep8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1ep8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Astrophysics" class="block break-words rounded py-2 grow cursor-pointer">Astrophysics</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1mp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1mp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="open" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Short Projects" class="block break-words rounded py-2 grow font-semibold text-blue-800 dark:text-blue-200 cursor-pointer">Short Projects</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1up8p:" aria-expanded="true" data-state="open"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="open" id="radix-:R1up8p:" class="pl-3 pr-[2px] collapsible-content"><a title="Short Projects Overview" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/index-11">Short Projects Overview</a><a title="ASTR 596: Project Submission Guide" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/project-submission-guide">ASTR 596: Project Submission Guide</a><a title="ASTR 596 Project 1: Python Fundamentals + Numerical Analysis + Stellar Physics" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/project1-description">ASTR 596 Project 1: Python Fundamentals + Numerical Analysis + Stellar Physics</a><a title="ASTR 596 Project 2: N-Body Dynamics + Statistical Sampling + Stellar Systems" aria-current="page" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg bg-blue-300/30 active" href="/project2-description">ASTR 596 Project 2: N-Body Dynamics + Statistical Sampling + Stellar Systems</a><a title="ASTR 596 Project 3: Monte Carlo Radiative Transfer + MCMC + Bayesian Statistics" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/project3-description">ASTR 596 Project 3: Monte Carlo Radiative Transfer + MCMC + Bayesian Statistics</a></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Final Project" class="block break-words rounded py-2 grow cursor-pointer">Final Project</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R26p8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R26p8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Reference" class="block break-words rounded py-2 grow cursor-pointer">Reference</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R2ep8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R2ep8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><article class="article content article-grid grid-gap"><main class="article-grid subgrid-gap col-screen"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-none pr-2 smallcaps border-r mr-2">Modeling the Universe</div><div class="flex-none mr-2"><a href="https://www.anna-rosen.com" class="font-semibold no-underline smallcaps" title="ASTR 596 - Fall 2025">ASTR 596 - Fall 2025</a></div><div class="flex-grow"></div><a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer" class="opacity-50 hover:opacity-100 text-inherit hover:text-inherit" aria-label="Content License: Creative Commons Attribution 4.0 International (CC-BY-4.0)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mx-1"><title>Content License: Creative Commons Attribution 4.0 International (CC-BY-4.0)</title><path d="M12 2.2c2.7 0 5 1 7 2.9.9.9 1.6 2 2.1 3.1.5 1.2.7 2.4.7 3.8 0 1.3-.2 2.6-.7 3.8-.5 1.2-1.2 2.2-2.1 3.1-1 .9-2 1.7-3.2 2.2-1.2.5-2.5.7-3.7.7s-2.6-.3-3.8-.8c-1.2-.5-2.2-1.2-3.2-2.1s-1.6-2-2.1-3.2-.8-2.4-.8-3.7c0-1.3.2-2.5.7-3.7S4.2 6 5.1 5.1C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C5.6 7.1 5 8 4.6 9c-.4 1-.6 2-.6 3s.2 2.1.6 3c.4 1 1 1.8 1.8 2.6S8 19 9 19.4c1 .4 2 .6 3 .6s2.1-.2 3-.6c1-.4 1.9-1 2.7-1.8 1.5-1.5 2.3-3.3 2.3-5.6 0-1.1-.2-2.1-.6-3.1-.4-1-1-1.8-1.7-2.6C16.1 4.8 14.2 4 12 4zm-.1 6.4l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.5.3-1 .4-1.5.4-.9 0-1.6-.3-2.1-.8-.5-.6-.8-1.3-.8-2.3 0-.9.3-1.7.8-2.2.6-.6 1.3-.8 2.1-.8 1.2 0 2.1.4 2.6 1.4zm5.6 0l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.4.2-.9.3-1.4.3-.9 0-1.6-.3-2.1-.8s-.8-1.3-.8-2.2c0-.9.3-1.7.8-2.2.5-.5 1.2-.8 2-.8 1.2 0 2.1.4 2.6 1.4z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1"><title>Credit must be given to the creator</title><path d="M12 2.2c2.7 0 5 .9 6.9 2.8 1.9 1.9 2.8 4.2 2.8 6.9s-.9 5-2.8 6.8c-2 1.9-4.3 2.9-7 2.9-2.6 0-4.9-1-6.9-2.9-1.8-1.7-2.8-4-2.8-6.7s1-5 2.9-6.9C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C4.8 8 4 9.9 4 12c0 2.2.8 4 2.4 5.6C8 19.2 9.8 20 12 20c2.2 0 4.1-.8 5.7-2.4 1.5-1.5 2.3-3.3 2.3-5.6 0-2.2-.8-4.1-2.3-5.7C16.1 4.8 14.2 4 12 4zm2.6 5.6v4h-1.1v4.7h-3v-4.7H9.4v-4c0-.2.1-.3.2-.4.1-.2.2-.2.4-.2h4c.2 0 .3.1.4.2.2.1.2.2.2.4zm-4-2.5c0-.9.5-1.4 1.4-1.4s1.4.5 1.4 1.4c0 .9-.5 1.4-1.4 1.4s-1.4-.5-1.4-1.4z"></path></svg></a><a href="https://opensource.org/licenses/MIT" target="_blank" rel="noopener noreferrer" title="Code License: MIT License (MIT)" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="mx-1 inline-block opacity-60 hover:opacity-100 hover:text-[#599F46]"><path d="M13.2 15.6c1.4-.5 2.1-1.6 2.1-3.3S13.8 8.9 12 8.9c-1.9 0-3.3 1.6-3.3 3.3 0 1.8.8 3 2.2 3.4l-2.3 5.9c-3.1-.8-6.3-4.6-6.3-9.3 0-5.5 4.3-10 9.7-10s9.8 4.5 9.8 10c0 4.7-3.1 8.5-6.3 9.3l-2.3-5.9z"></path></svg></a><a href="https://github.com/astrobytes-edu/astr596-modeling-universe" title="GitHub Repository: astrobytes-edu/astr596-modeling-universe" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><a href="https://github.com/astrobytes-edu/astr596-modeling-universe/blob/main/07-short-projects/2_project2_description.md" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div><button class="inline-flex size-[24px] hover:text-[#E18435] items-center justify-center" aria-label="Launch in external computing interface" title="Launch in external computing interface" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Re8top:" data-state="closed"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.85357 3.85355L7.65355 3.05353C8.2981 2.40901 9.42858 1.96172 10.552 1.80125C11.1056 1.72217 11.6291 1.71725 12.0564 1.78124C12.4987 1.84748 12.7698 1.97696 12.8965 2.10357C13.0231 2.23018 13.1526 2.50125 13.2188 2.94357C13.2828 3.37086 13.2779 3.89439 13.1988 4.44801C13.0383 5.57139 12.591 6.70188 11.9464 7.34645L7.49999 11.7929L6.35354 10.6465C6.15827 10.4512 5.84169 10.4512 5.64643 10.6465C5.45117 10.8417 5.45117 11.1583 5.64643 11.3536L7.14644 12.8536C7.34171 13.0488 7.65829 13.0488 7.85355 12.8536L8.40073 12.3064L9.57124 14.2572C9.65046 14.3893 9.78608 14.4774 9.9389 14.4963C10.0917 14.5151 10.2447 14.4624 10.3535 14.3536L12.3535 12.3536C12.4648 12.2423 12.5172 12.0851 12.495 11.9293L12.0303 8.67679L12.6536 8.05355C13.509 7.19808 14.0117 5.82855 14.1887 4.58943C14.2784 3.9618 14.2891 3.33847 14.2078 2.79546C14.1287 2.26748 13.9519 1.74482 13.6035 1.39645C13.2552 1.04809 12.7325 0.871332 12.2045 0.792264C11.6615 0.710945 11.0382 0.721644 10.4105 0.8113C9.17143 0.988306 7.80189 1.491 6.94644 2.34642L6.32322 2.96968L3.07071 2.50504C2.91492 2.48278 2.75773 2.53517 2.64645 2.64646L0.646451 4.64645C0.537579 4.75533 0.484938 4.90829 0.50375 5.0611C0.522563 5.21391 0.61073 5.34954 0.742757 5.42876L2.69364 6.59928L2.14646 7.14645C2.0527 7.24022 2.00002 7.3674 2.00002 7.50001C2.00002 7.63261 2.0527 7.75979 2.14646 7.85356L3.64647 9.35356C3.84173 9.54883 4.15831 9.54883 4.35357 9.35356C4.54884 9.1583 4.54884 8.84172 4.35357 8.64646L3.20712 7.50001L3.85357 6.85356L6.85357 3.85355ZM10.0993 13.1936L9.12959 11.5775L11.1464 9.56067L11.4697 11.8232L10.0993 13.1936ZM3.42251 5.87041L5.43935 3.85356L3.17678 3.53034L1.80638 4.90074L3.42251 5.87041ZM2.35356 10.3535C2.54882 10.1583 2.54882 9.8417 2.35356 9.64644C2.1583 9.45118 1.84171 9.45118 1.64645 9.64644L0.646451 10.6464C0.451188 10.8417 0.451188 11.1583 0.646451 11.3535C0.841713 11.5488 1.1583 11.5488 1.35356 11.3535L2.35356 10.3535ZM3.85358 11.8536C4.04884 11.6583 4.04885 11.3417 3.85359 11.1465C3.65833 10.9512 3.34175 10.9512 3.14648 11.1465L1.14645 13.1464C0.95119 13.3417 0.951187 13.6583 1.14645 13.8535C1.34171 14.0488 1.65829 14.0488 1.85355 13.8536L3.85358 11.8536ZM5.35356 13.3535C5.54882 13.1583 5.54882 12.8417 5.35356 12.6464C5.1583 12.4512 4.84171 12.4512 4.64645 12.6464L3.64645 13.6464C3.45119 13.8417 3.45119 14.1583 3.64645 14.3535C3.84171 14.5488 4.1583 14.5488 4.35356 14.3535L5.35356 13.3535ZM9.49997 6.74881C10.1897 6.74881 10.7488 6.1897 10.7488 5.5C10.7488 4.8103 10.1897 4.25118 9.49997 4.25118C8.81026 4.25118 8.25115 4.8103 8.25115 5.5C8.25115 6.1897 8.81026 6.74881 9.49997 6.74881Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button></div><h1 class="mb-0">ASTR 596 Project 2: N-Body Dynamics + Statistical Sampling + Stellar Systems</h1><header class="mt-4 not-prose"><div class="grid grid-cols-1 sm:grid-cols-2 gap-y-1"><div><span class="font-semibold text-sm"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R2t8top:" data-state="closed">Anna Rosen</button><a class="ml-1" href="mailto:alrosen@sdsu.edu" title="Anna Rosen &lt;alrosen@sdsu.edu&gt;" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 -translate-y-[0.1em] hover:text-blue-400"><path d="M21.8 18c0 1.1-.9 2-1.9 2H4.2c-1.1 0-1.9-.9-1.9-2V9.9c0-.5.3-.7.8-.4l7.8 4.7c.7.4 1.7.4 2.4 0L21 9.5c.4-.2.8-.1.8.4V18z"></path><path d="M21.8 6c0-1.1-.9-2-1.9-2H4.2c-1.1 0-2 .9-2 2v.4c0 .5.3 1.1.8 1.3l8.5 5.1c.2.1.7.1.9 0l8.6-5c.4-.3.8-.9.8-1.3-.1-.1-.1-.5 0-.5z"></path></svg></a><a class="ml-1" href="https://orcid.org/0000-0003-4423-0660" title="ORCID: 0000-0003-4423-0660" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 -translate-y-[0.1em] hover:text-[#A9C751]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span></div><div class="text-sm"><div>San Diego State University<!-- --> </div></div></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><p><strong>Duration</strong>: 3 weeks
<strong>Weight</strong>: 15% of course grade
<strong>Theme</strong>: “Realistic Stellar Clusters with Gravitational Dynamics”</p><hr class="py-2 my-5 translate-y-2"/><h3 id="project-overview" class="relative group"><span class="heading-text">Project Overview</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#project-overview" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>This project builds sophisticated N-body gravitational dynamics simulations with realistic stellar populations. You will implement multiple ODE integration schemes, master statistical sampling from astrophysical distributions, and create evolving stellar clusters that serve as input for radiation calculations in Project 3. The emphasis is on vectorization, performance optimization, and adaptive numerical methods.</p><h3 id="learning-objectives" class="relative group"><span class="heading-text">Learning Objectives</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#learning-objectives" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>By completing this project, you will:</p><ul><li><strong>Master ODE integration</strong>: Implement and compare multiple numerical integration schemes</li><li><strong>Understand gravitational dynamics</strong>: N-body physics, energy conservation, and cluster evolution</li><li><strong>Learn statistical sampling</strong>: Sample from Initial Mass Function and spatial distributions</li><li><strong>Develop vectorization skills</strong>: Efficient NumPy operations for computational performance</li><li><strong>Implement adaptive methods</strong>: Energy-controlled timestep adjustment</li><li><strong>Generate realistic astrophysical data</strong>: Stellar clusters for radiation modeling</li></ul><h3 id="prerequisites-from-project-1" class="relative group"><span class="heading-text">Prerequisites from Project 1</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#prerequisites-from-project-1" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><ul><li>Numerical integration techniques (trapezoid, Simpson’s, Gaussian quadrature)</li><li>Root-finding methods (Newton-Raphson for energy balance)</li><li>Object-oriented programming (Star class design)</li><li>Blackbody physics and stellar luminosity calculations</li></ul><hr class="py-2 my-5 translate-y-2"/><h2 id="week-1-ode-solvers-and-energy-conservation" class="relative group"><span class="heading-text">Week 1: ODE Solvers and Energy Conservation</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#week-1-ode-solvers-and-energy-conservation" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="conceptual-introduction-25-min" class="relative group"><span class="heading-text">Conceptual Introduction (25 min)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#conceptual-introduction-25-min" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><ul><li>Newton’s laws and gravitational force in astrophysical contexts</li><li>Converting 2nd order ODEs to 1st order systems</li><li>Integration methods: explicit vs implicit, stability vs accuracy</li><li>Symplectic integrators for Hamiltonian systems</li><li>Energy and angular momentum conservation in gravitational systems</li></ul><h3 id="lab-session-objectives" class="relative group"><span class="heading-text">Lab Session Objectives</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#lab-session-objectives" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Build comprehensive ODE solver library and validate on two-body dynamics.</p><h4 id="task-1-ode-solver-framework-45-min" class="relative group"><span class="heading-text">Task 1: ODE Solver Framework (45 min)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#task-1-ode-solver-framework-45-min" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p><strong>Goal</strong>: Create abstract base class and implement multiple integration methods</p><p><strong>Framework Design</strong>:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from abc import ABC, abstractmethod
import numpy as np

class ODESolver(ABC):
    &quot;&quot;&quot;
    Abstract base class for ODE integration methods.
    
    Solves system: dy/dt = f(t, y) where y can be vector-valued
    &quot;&quot;&quot;
    
    def __init__(self, derivatives_func, initial_conditions, initial_time=0.0):
        &quot;&quot;&quot;
        Parameters:
        -----------
        derivatives_func : callable
            Function f(t, y) returning dy/dt
        initial_conditions : array_like
            Initial values y(t0)
        initial_time : float
            Initial time t0
        &quot;&quot;&quot;
        self.f = derivatives_func
        self.y = np.array(initial_conditions, dtype=float)
        self.t = initial_time
        self.history = {&#x27;t&#x27;: [initial_time], &#x27;y&#x27;: [self.y.copy()]}
    
    @abstractmethod
    def step(self, dt):
        &quot;&quot;&quot;Take single integration step of size dt.&quot;&quot;&quot;
        pass
    
    def evolve(self, t_final, dt):
        &quot;&quot;&quot;Evolve system from current time to t_final.&quot;&quot;&quot;
        while self.t &lt; t_final:
            step_size = min(dt, t_final - self.t)
            self.step(step_size)
            self.history[&#x27;t&#x27;].append(self.t)
            self.history[&#x27;y&#x27;].append(self.y.copy())
        return np.array(self.history[&#x27;t&#x27;]), np.array(self.history[&#x27;y&#x27;])

class EulerSolver(ODESolver):
    &quot;&quot;&quot;First-order Euler method: y_{n+1} = y_n + dt * f(t_n, y_n)&quot;&quot;&quot;
    
    def step(self, dt):
        &quot;&quot;&quot;Implement Euler step.&quot;&quot;&quot;
        dydt = self.f(self.t, self.y)
        self.y += dt * dydt
        self.t += dt

class RungeKutta4Solver(ODESolver):
    &quot;&quot;&quot;Fourth-order Runge-Kutta method.&quot;&quot;&quot;
    
    def step(self, dt):
        &quot;&quot;&quot;Implement RK4 step with four evaluations.&quot;&quot;&quot;
        k1 = self.f(self.t, self.y)
        k2 = self.f(self.t + dt/2, self.y + dt*k1/2)
        k3 = self.f(self.t + dt/2, self.y + dt*k2/2)
        k4 = self.f(self.t + dt, self.y + dt*k3)
        
        self.y += dt * (k1 + 2*k2 + 2*k3 + k4) / 6
        self.t += dt

class LeapfrogSolver(ODESolver):
    &quot;&quot;&quot;
    Leapfrog integrator for Hamiltonian systems.
    Particularly good for gravitational dynamics.
    &quot;&quot;&quot;
    
    def __init__(self, force_func, positions, velocities, masses, initial_time=0.0):
        &quot;&quot;&quot;
        Specialized for N-body problems.
        
        Parameters:
        -----------
        force_func : callable
            Function returning accelerations given (positions, masses)
        positions : array
            Initial positions [N, 3]
        velocities : array  
            Initial velocities [N, 3]
        masses : array
            Particle masses [N]
        &quot;&quot;&quot;
        self.force_func = force_func
        self.positions = np.array(positions)
        self.velocities = np.array(velocities)
        self.masses = np.array(masses)
        self.t = initial_time
        self.history = {
            &#x27;t&#x27;: [initial_time],
            &#x27;positions&#x27;: [self.positions.copy()],
            &#x27;velocities&#x27;: [self.velocities.copy()]
        }
    
    def step(self, dt):
        &quot;&quot;&quot;Leapfrog integration step.&quot;&quot;&quot;
        # Kick: v_{1/2} = v_0 + (dt/2) * a_0
        accelerations = self.force_func(self.positions, self.masses)
        self.velocities += 0.5 * dt * accelerations
        
        # Drift: x_1 = x_0 + dt * v_{1/2}
        self.positions += dt * self.velocities
        
        # Kick: v_1 = v_{1/2} + (dt/2) * a_1
        accelerations = self.force_func(self.positions, self.masses)
        self.velocities += 0.5 * dt * accelerations
        
        self.t += dt
        self.history[&#x27;t&#x27;].append(self.t)
        self.history[&#x27;positions&#x27;].append(self.positions.copy())
        self.history[&#x27;velocities&#x27;].append(self.velocities.copy())</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><h4 id="task-2-two-body-gravitational-dynamics-60-min" class="relative group"><span class="heading-text">Task 2: Two-Body Gravitational Dynamics (60 min)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#task-2-two-body-gravitational-dynamics-60-min" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p><strong>Goal</strong>: Validate integrators on Kepler problem with known analytical solution</p><p><strong>Implementation Requirements</strong>:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def gravitational_derivatives(t, state):
    &quot;&quot;&quot;
    Derivatives for two-body problem.
    
    state = [x1, y1, z1, vx1, vy1, vz1, x2, y2, z2, vx2, vy2, vz2]
    &quot;&quot;&quot;
    # Extract positions and velocities
    pos1 = state[0:3]
    vel1 = state[3:6]
    pos2 = state[6:9]
    vel2 = state[9:12]
    
    # Calculate separation and force
    r_vec = pos2 - pos1
    r_mag = np.linalg.norm(r_vec)
    
    # Gravitational acceleration
    G = 6.674e-11  # m³/kg/s²
    m1, m2 = 1.0, 1.0  # masses
    
    acc_magnitude = G * (m1 + m2) / r_mag**3
    acc1 = acc_magnitude * r_vec
    acc2 = -acc_magnitude * r_vec
    
    # Return derivatives: [vel1, acc1, vel2, acc2]
    return np.concatenate([vel1, acc1, vel2, acc2])

def kepler_orbit_validation():
    &quot;&quot;&quot;
    Test integrators on Earth-Sun system.
    Compare with analytical solution for energy and angular momentum.
    &quot;&quot;&quot;
    # Earth-Sun system (simplified units)
    AU = 1.496e11  # m
    year = 365.25 * 24 * 3600  # s
    
    # Initial conditions: Earth at aphelion
    initial_state = [
        1.017*AU, 0, 0,      # Earth position
        0, 29.29e3, 0,       # Earth velocity
        0, 0, 0,             # Sun position (at origin)
        0, 0, 0              # Sun velocity
    ]
    
    # Test each integrator
    methods = {
        &#x27;Euler&#x27;: EulerSolver,
        &#x27;RK4&#x27;: RungeKutta4Solver
    }
    
    results = {}
    for name, SolverClass in methods.items():
        solver = SolverClass(gravitational_derivatives, initial_state)
        t_vals, y_vals = solver.evolve(t_final=year, dt=year/1000)
        results[name] = {&#x27;t&#x27;: t_vals, &#x27;y&#x27;: y_vals}
    
    return results

def calculate_orbital_energy(positions, velocities, masses):
    &quot;&quot;&quot;Calculate total energy: kinetic + potential.&quot;&quot;&quot;
    # Kinetic energy: (1/2) * m * v²
    ke = 0.5 * np.sum(masses * np.sum(velocities**2, axis=1))
    
    # Potential energy: -G * m1 * m2 / r
    G = 6.674e-11
    pe = 0
    for i in range(len(masses)):
        for j in range(i+1, len(masses)):
            r_ij = np.linalg.norm(positions[i] - positions[j])
            pe -= G * masses[i] * masses[j] / r_ij
    
    return ke + pe

def orbital_validation_analysis(results):
    &quot;&quot;&quot;
    Analyze energy conservation and orbital accuracy.
    Plot energy drift and orbital trajectories.
    &quot;&quot;&quot;
    # Calculate energy conservation for each method
    # Plot trajectories and energy vs time
    # Compare with analytical orbital period</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><h4 id="task-3-error-analysis-and-method-comparison-30-min" class="relative group"><span class="heading-text">Task 3: Error Analysis and Method Comparison (30 min)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#task-3-error-analysis-and-method-comparison-30-min" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p><strong>Goal</strong>: Understand trade-offs between accuracy, stability, and computational cost</p><p><strong>Analysis Requirements</strong>:</p><ol start="1"><li><strong>Convergence Study</strong>: Plot error vs timestep for each method</li><li><strong>Energy Conservation</strong>: Track relative energy drift over multiple orbits</li><li><strong>Computational Cost</strong>: Time each method for various timestep sizes</li><li><strong>Long-term Stability</strong>: Run for 10+ orbital periods</li></ol><p><strong>Week 1 Deliverable</strong>: ODE solver library with comprehensive validation on Kepler orbits</p><hr class="py-2 my-5 translate-y-2"/><h2 id="week-2-statistical-sampling-and-multi-body-systems" class="relative group"><span class="heading-text">Week 2: Statistical Sampling and Multi-Body Systems</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#week-2-statistical-sampling-and-multi-body-systems" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="conceptual-introduction-25-min-1" class="relative group"><span class="heading-text">Conceptual Introduction (25 min)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#conceptual-introduction-25-min-1" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><ul><li>Stellar Initial Mass Function: Salpeter, Kroupa, Chabrier prescriptions</li><li>Spatial distributions in star clusters: Plummer sphere, King profiles</li><li>Statistical sampling techniques: inverse transform, rejection sampling</li><li>Virial equilibrium and cluster dynamics</li></ul><h3 id="lab-session-objectives-1" class="relative group"><span class="heading-text">Lab Session Objectives</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#lab-session-objectives-1" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Implement realistic stellar cluster initialization and scale to many-body systems.</p><h4 id="task-1-initial-mass-function-implementation-50-min" class="relative group"><span class="heading-text">Task 1: Initial Mass Function Implementation (50 min)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#task-1-initial-mass-function-implementation-50-min" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p><strong>Goal</strong>: Sample realistic stellar mass distributions</p><p><strong>IMF Theory and Implementation</strong>:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">class StellarIMF:
    &quot;&quot;&quot;
    Stellar Initial Mass Function implementation.
    
    Supports multiple functional forms used in astrophysics.
    &quot;&quot;&quot;
    
    def __init__(self, imf_type=&#x27;kroupa&#x27;, mass_range=(0.08, 120)):
        &quot;&quot;&quot;
        Parameters:
        -----------
        imf_type : str
            &#x27;salpeter&#x27;, &#x27;kroupa&#x27;, or &#x27;chabrier&#x27;
        mass_range : tuple
            (minimum_mass, maximum_mass) in solar masses
        &quot;&quot;&quot;
        self.imf_type = imf_type
        self.m_min, self.m_max = mass_range
        self.normalization = self._calculate_normalization()
    
    def pdf(self, mass):
        &quot;&quot;&quot;
        Probability density function dN/dM.
        
        Salpeter (1955): dN/dM ∝ M^(-2.35)
        Kroupa (2001): dN/dM ∝ M^(-1.3) for M &lt; 0.5 M☉
                               M^(-2.3) for M &gt; 0.5 M☉
        &quot;&quot;&quot;
        mass = np.asarray(mass)
        
        if self.imf_type == &#x27;salpeter&#x27;:
            return mass**(-2.35)
        
        elif self.imf_type == &#x27;kroupa&#x27;:
            # Broken power law
            result = np.zeros_like(mass)
            low_mass = mass &lt; 0.5
            high_mass = mass &gt;= 0.5
            
            result[low_mass] = mass[low_mass]**(-1.3)
            # Ensure continuity at M = 0.5
            normalization = 0.5**(-1.3 + 2.3)
            result[high_mass] = normalization * mass[high_mass]**(-2.3)
            
            return result
        
        elif self.imf_type == &#x27;chabrier&#x27;:
            # Log-normal for low masses + power law for high masses
            # Implementation left as advanced exercise
            pass
    
    def cdf(self, mass):
        &quot;&quot;&quot;Cumulative distribution function.&quot;&quot;&quot;
        # Analytical when possible, numerical integration otherwise
        if self.imf_type == &#x27;salpeter&#x27;:
            # CDF ∝ M^(-1.35)
            return (mass**(-1.35) - self.m_min**(-1.35)) / \
                   (self.m_max**(-1.35) - self.m_min**(-1.35))
    
    def sample_rejection(self, n_stars):
        &quot;&quot;&quot;Sample using rejection method.&quot;&quot;&quot;
        masses = []
        max_pdf = self.pdf(self.m_min)  # Maximum of PDF
        
        while len(masses) &lt; n_stars:
            # Propose random mass in range
            m_proposal = self.m_min + (self.m_max - self.m_min) * np.random.random()
            
            # Accept with probability proportional to PDF
            if np.random.random() &lt; self.pdf(m_proposal) / max_pdf:
                masses.append(m_proposal)
        
        return np.array(masses)
    
    def sample_inverse_transform(self, n_stars):
        &quot;&quot;&quot;Sample using inverse CDF (when available).&quot;&quot;&quot;
        if self.imf_type == &#x27;salpeter&#x27;:
            u = np.random.random(n_stars)
            # Invert CDF analytically
            return (self.m_min**(-1.35) + u * (self.m_max**(-1.35) - self.m_min**(-1.35)))**(-1/1.35)
        else:
            # Fall back to rejection sampling
            return self.sample_rejection(n_stars)
    
    def validate_distribution(self, masses, n_bins=50):
        &quot;&quot;&quot;Compare sampled masses with theoretical IMF.&quot;&quot;&quot;
        # Create histogram and compare with PDF
        # Plot and calculate goodness-of-fit statistics
        pass

def mass_to_stellar_properties(masses):
    &quot;&quot;&quot;
    Convert stellar masses to observable properties.
    Uses Project 1 stellar physics relationships.
    &quot;&quot;&quot;
    # Mass-luminosity relation
    luminosities = np.where(masses &gt; 1.0, 
                           masses**3.5,  # High mass: L ∝ M^3.5
                           masses**4.0)  # Low mass: L ∝ M^4.0
    
    # Mass-temperature relation (main sequence)
    temperatures = 5778 * (masses)**0.5  # Rough approximation
    
    # Mass-radius relation
    radii = np.where(masses &gt; 1.0,
                    masses**0.8,   # High mass
                    masses**0.9)   # Low mass
    
    return {
        &#x27;luminosities&#x27;: luminosities,
        &#x27;temperatures&#x27;: temperatures,
        &#x27;radii&#x27;: radii
    }</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><h4 id="task-2-plummer-sphere-spatial-distribution-45-min" class="relative group"><span class="heading-text">Task 2: Plummer Sphere Spatial Distribution (45 min)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#task-2-plummer-sphere-spatial-distribution-45-min" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p><strong>Goal</strong>: Sample realistic 3D stellar cluster geometry</p><p><strong>Plummer Model Implementation</strong>:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">class PlummerSphere:
    &quot;&quot;&quot;
    Plummer sphere model for stellar cluster spatial distribution.
    
    Density profile: ρ(r) = (3M/4πa³) * (1 + r²/a²)^(-5/2)
    where a is the scale radius.
    &quot;&quot;&quot;
    
    def __init__(self, total_mass=1000, scale_radius=1.0):
        &quot;&quot;&quot;
        Parameters:
        -----------
        total_mass : float
            Total cluster mass [M☉]
        scale_radius : float
            Plummer scale radius [pc]
        &quot;&quot;&quot;
        self.M = total_mass
        self.a = scale_radius
    
    def density(self, r):
        &quot;&quot;&quot;Density at radius r.&quot;&quot;&quot;
        return (3*self.M/(4*np.pi*self.a**3)) * (1 + (r/self.a)**2)**(-5/2)
    
    def mass_enclosed(self, r):
        &quot;&quot;&quot;Mass within radius r.&quot;&quot;&quot;
        return self.M * (r/self.a)**3 / (1 + (r/self.a)**2)**(3/2)
    
    def sample_radial_positions(self, n_stars):
        &quot;&quot;&quot;
        Sample radial distances using inverse CDF method.
        
        CDF: M(r)/M_total = (r/a)³ / (1 + (r/a)²)^(3/2)
        Inverse: r = a / sqrt(u^(-2/3) - 1)
        &quot;&quot;&quot;
        u = np.random.random(n_stars)
        # Prevent u=0 which gives infinite radius
        u = np.clip(u, 1e-10, 1-1e-10)
        
        radii = self.a / np.sqrt(u**(-2/3) - 1)
        return radii
    
    def sample_positions(self, n_stars):
        &quot;&quot;&quot;Sample 3D positions from Plummer distribution.&quot;&quot;&quot;
        radii = self.sample_radial_positions(n_stars)
        
        # Sample isotropic directions
        cos_theta = 2*np.random.random(n_stars) - 1  # cos(θ) uniform in [-1,1]
        phi = 2*np.pi*np.random.random(n_stars)      # φ uniform in [0,2π]
        
        sin_theta = np.sqrt(1 - cos_theta**2)
        
        # Convert to Cartesian coordinates
        x = radii * sin_theta * np.cos(phi)
        y = radii * sin_theta * np.sin(phi)
        z = radii * cos_theta
        
        return np.column_stack([x, y, z])
    
    def calculate_virial_velocities(self, positions, masses):
        &quot;&quot;&quot;
        Calculate velocities for virial equilibrium.
        
        Uses virial theorem: 2T + U = 0 for bound system
        where T = kinetic energy, U = potential energy
        &quot;&quot;&quot;
        n_stars = len(masses)
        velocities = np.zeros_like(positions)
        
        # Calculate potential energy
        U = 0
        for i in range(n_stars):
            for j in range(i+1, n_stars):
                r_ij = np.linalg.norm(positions[i] - positions[j])
                U -= G * masses[i] * masses[j] / r_ij
        
        # Virial theorem: total kinetic energy = -U/2
        T_total = -U / 2
        
        # Distribute kinetic energy among particles
        # Simple approach: assume isotropic velocity dispersion
        for i in range(n_stars):
            # Individual kinetic energy proportional to mass
            T_i = T_total * masses[i] / np.sum(masses)
            v_mag = np.sqrt(2 * T_i / masses[i])
            
            # Random direction
            cos_theta = 2*np.random.random() - 1
            phi = 2*np.pi*np.random.random()
            sin_theta = np.sqrt(1 - cos_theta**2)
            
            velocities[i] = v_mag * np.array([
                sin_theta * np.cos(phi),
                sin_theta * np.sin(phi),
                cos_theta
            ])
        
        return velocities</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><h4 id="task-3-vectorized-n-body-force-calculation-40-min" class="relative group"><span class="heading-text">Task 3: Vectorized N-Body Force Calculation (40 min)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#task-3-vectorized-n-body-force-calculation-40-min" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p><strong>Goal</strong>: Implement efficient O(N²) force computation</p><p><strong>Vectorized Implementation</strong>:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def gravitational_forces_vectorized(positions, masses, softening=0.01):
    &quot;&quot;&quot;
    Calculate gravitational forces between all particle pairs.
    
    Parameters:
    -----------
    positions : array [N, 3]
        Particle positions
    masses : array [N]
        Particle masses
    softening : float
        Softening parameter to avoid singularities
        
    Returns:
    --------
    forces : array [N, 3]
        Gravitational forces on each particle
    &quot;&quot;&quot;
    N = len(masses)
    G = 4.3e-3  # pc³/M☉/Myr² (convenient units)
    
    # Calculate all pairwise separations using broadcasting
    # positions[i,j] - positions[k,j] for all i,k pairs
    r_vectors = positions[:, np.newaxis, :] - positions[np.newaxis, :, :]  # [N, N, 3]
    
    # Distance magnitudes with softening
    r_magnitudes = np.sqrt(np.sum(r_vectors**2, axis=2) + softening**2)  # [N, N]
    
    # Avoid self-interaction
    np.fill_diagonal(r_magnitudes, np.inf)
    
    # Force magnitudes: F = G*m1*m2/r²
    mass_products = masses[:, np.newaxis] * masses[np.newaxis, :]  # [N, N]
    force_magnitudes = G * mass_products / r_magnitudes**2  # [N, N]
    
    # Force directions: unit vectors
    r_unit = r_vectors / r_magnitudes[:, :, np.newaxis]  # [N, N, 3]
    
    # Total forces: sum over all other particles
    forces = np.sum(force_magnitudes[:, :, np.newaxis] * r_unit, axis=1)  # [N, 3]
    
    return forces

def performance_comparison():
    &quot;&quot;&quot;Compare vectorized vs nested loop implementations.&quot;&quot;&quot;
    import time
    
    # Test different cluster sizes
    N_values = [10, 50, 100, 200, 500]
    
    for N in N_values:
        # Generate test data
        positions = np.random.randn(N, 3)
        masses = np.random.uniform(0.1, 10, N)
        
        # Time vectorized version
        start = time.time()
        forces_vec = gravitational_forces_vectorized(positions, masses)
        time_vec = time.time() - start
        
        # Time nested loop version (for comparison)
        start = time.time()
        forces_loop = gravitational_forces_nested_loops(positions, masses)
        time_loop = time.time() - start
        
        print(f&quot;N={N}: Vectorized={time_vec:.4f}s, Loops={time_loop:.4f}s, &quot;
              f&quot;Speedup={time_loop/time_vec:.1f}x&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p><strong>Week 2 Deliverable</strong>: Realistic stellar cluster initialization with IMF masses and Plummer positions, plus efficient force calculations</p><hr class="py-2 my-5 translate-y-2"/><h2 id="week-3-adaptive-timestepping-and-cluster-evolution" class="relative group"><span class="heading-text">Week 3: Adaptive Timestepping and Cluster Evolution</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#week-3-adaptive-timestepping-and-cluster-evolution" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="conceptual-introduction-25-min-2" class="relative group"><span class="heading-text">Conceptual Introduction (25 min)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#conceptual-introduction-25-min-2" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><ul><li>Energy conservation as accuracy criterion</li><li>Adaptive timestep algorithms</li><li>Multi-mass cluster dynamics: mass segregation, two-body relaxation</li><li>Stellar escape and cluster dissolution</li><li>Computational complexity and optimization strategies</li></ul><h3 id="lab-session-objectives-2" class="relative group"><span class="heading-text">Lab Session Objectives</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#lab-session-objectives-2" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Implement energy-controlled adaptive integration and study realistic cluster evolution.</p><h4 id="task-1-adaptive-timestep-control-50-min" class="relative group"><span class="heading-text">Task 1: Adaptive Timestep Control (50 min)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#task-1-adaptive-timestep-control-50-min" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p><strong>Goal</strong>: Implement robust adaptive timestep algorithm based on energy conservation</p><p><strong>Adaptive Integration Framework</strong>:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">class AdaptiveNBodySimulator:
    &quot;&quot;&quot;
    N-body simulator with adaptive timestep control.
    
    Uses energy conservation to monitor accuracy and adjust timestep.
    &quot;&quot;&quot;
    
    def __init__(self, positions, velocities, masses, initial_dt=0.01, 
                 energy_tolerance=1e-6):
        &quot;&quot;&quot;
        Parameters:
        -----------
        positions : array [N, 3]
            Initial positions [pc]
        velocities : array [N, 3] 
            Initial velocities [km/s]
        masses : array [N]
            Particle masses [M☉]
        initial_dt : float
            Initial timestep [Myr]
        energy_tolerance : float
            Relative energy error tolerance
        &quot;&quot;&quot;
        self.positions = np.array(positions)
        self.velocities = np.array(velocities) 
        self.masses = np.array(masses)
        self.dt = initial_dt
        self.tolerance = energy_tolerance
        
        # Calculate initial energy
        self.initial_energy = self.total_energy()
        
        # Statistics tracking
        self.n_accepted = 0
        self.n_rejected = 0
        self.energy_errors = []
        self.timesteps = []
        
        # History storage
        self.time = 0.0
        self.history = {
            &#x27;time&#x27;: [0.0],
            &#x27;positions&#x27;: [self.positions.copy()],
            &#x27;velocities&#x27;: [self.velocities.copy()],
            &#x27;energy&#x27;: [self.initial_energy],
            &#x27;timestep&#x27;: [self.dt]
        }
    
    def total_energy(self):
        &quot;&quot;&quot;Calculate total energy: kinetic + potential.&quot;&quot;&quot;
        # Kinetic energy
        ke = 0.5 * np.sum(self.masses * np.sum(self.velocities**2, axis=1))
        
        # Potential energy
        pe = 0
        for i in range(len(self.masses)):
            for j in range(i+1, len(self.masses)):
                r_ij = np.linalg.norm(self.positions[i] - self.positions[j])
                pe -= G * self.masses[i] * self.masses[j] / r_ij
        
        return ke + pe
    
    def energy_error(self):
        &quot;&quot;&quot;Calculate relative energy error from initial value.&quot;&quot;&quot;
        current_energy = self.total_energy()
        return abs((current_energy - self.initial_energy) / self.initial_energy)
    
    def leapfrog_step(self, dt):
        &quot;&quot;&quot;Take single leapfrog integration step.&quot;&quot;&quot;
        # Store initial state for potential rollback
        old_positions = self.positions.copy()
        old_velocities = self.velocities.copy()
        
        # Leapfrog integration
        forces = gravitational_forces_vectorized(self.positions, self.masses)
        accelerations = forces / self.masses[:, np.newaxis]
        
        # Kick-drift-kick
        self.velocities += 0.5 * dt * accelerations
        self.positions += dt * self.velocities
        
        forces = gravitational_forces_vectorized(self.positions, self.masses)
        accelerations = forces / self.masses[:, np.newaxis]
        self.velocities += 0.5 * dt * accelerations
        
        return old_positions, old_velocities
    
    def adaptive_step(self):
        &quot;&quot;&quot;
        Take adaptive timestep with error control.
        
        Algorithm:
        1. Attempt step with current timestep
        2. Check energy conservation
        3. If error too large: reduce timestep and retry
        4. If error acceptable: possibly increase timestep for next step
        &quot;&quot;&quot;
        max_attempts = 5
        
        for attempt in range(max_attempts):
            # Store state before step
            old_positions, old_velocities = self.leapfrog_step(self.dt)
            
            # Check energy conservation
            error = self.energy_error()
            
            if error &lt;= self.tolerance:
                # Step accepted
                self.time += self.dt
                self.n_accepted += 1
                
                # Store results
                self.history[&#x27;time&#x27;].append(self.time)
                self.history[&#x27;positions&#x27;].append(self.positions.copy())
                self.history[&#x27;velocities&#x27;].append(self.velocities.copy())
                self.history[&#x27;energy&#x27;].append(self.total_energy())
                self.history[&#x27;timestep&#x27;].append(self.dt)
                
                self.energy_errors.append(error)
                self.timesteps.append(self.dt)
                
                # Possibly increase timestep for next step
                if error &lt; self.tolerance / 10:
                    self.dt = min(self.dt * 1.1, 0.1)  # Don&#x27;t let it grow too large
                
                return True
            
            else:
                # Step rejected - restore state and reduce timestep
                self.positions = old_positions
                self.velocities = old_velocities
                self.dt *= 0.5
                self.n_rejected += 1
                
                if attempt == max_attempts - 1:
                    print(f&quot;Warning: Max attempts reached at t={self.time:.3f}&quot;)
                    return False
        
        return False
    
    def evolve(self, t_final, max_steps=10000):
        &quot;&quot;&quot;Evolve system to final time using adaptive timesteps.&quot;&quot;&quot;
        step_count = 0
        
        while self.time &lt; t_final and step_count &lt; max_steps:
            success = self.adaptive_step()
            if not success:
                print(&quot;Simulation failed - energy errors too large&quot;)
                break
            
            step_count += 1
            
            # Progress reporting
            if step_count % 100 == 0:
                acceptance_rate = self.n_accepted / (self.n_accepted + self.n_rejected)
                print(f&quot;t={self.time:.2f}, dt={self.dt:.4f}, &quot;
                      f&quot;E_error={self.energy_errors[-1]:.2e}, &quot;
                      f&quot;acceptance={acceptance_rate:.2f}&quot;)
        
        return self.get_results()
    
    def get_results(self):
        &quot;&quot;&quot;Return simulation results as arrays.&quot;&quot;&quot;
        return {
            &#x27;time&#x27;: np.array(self.history[&#x27;time&#x27;]),
            &#x27;positions&#x27;: np.array(self.history[&#x27;positions&#x27;]),
            &#x27;velocities&#x27;: np.array(self.history[&#x27;velocities&#x27;]),
            &#x27;energy&#x27;: np.array(self.history[&#x27;energy&#x27;]),
            &#x27;timesteps&#x27;: np.array(self.history[&#x27;timestep&#x27;])
        }</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><h4 id="task-2-cluster-physics-and-evolution-55-min" class="relative group"><span class="heading-text">Task 2: Cluster Physics and Evolution (55 min)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#task-2-cluster-physics-and-evolution-55-min" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p><strong>Goal</strong>: Study realistic stellar cluster evolution phenomena</p><p><strong>Mass Segregation Analysis</strong>:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def analyze_mass_segregation(positions, masses, times):
    &quot;&quot;&quot;
    Track mass segregation: massive stars sink to cluster center.
    
    Quantify using mass-weighted radial distribution.
    &quot;&quot;&quot;
    segregation_ratios = []
    
    for i, pos in enumerate(positions):
        # Calculate distance from cluster center
        center = np.average(pos, weights=masses, axis=0)
        distances = np.linalg.norm(pos - center, axis=1)
        
        # Sort by mass
        mass_order = np.argsort(masses)[::-1]  # Heaviest first
        
        # Compare radial distribution of most vs least massive stars
        n_heavy = len(masses) // 10  # Top 10%
        n_light = len(masses) // 10  # Bottom 10%
        
        r_heavy = np.mean(distances[mass_order[:n_heavy]])
        r_light = np.mean(distances[mass_order[-n_light:]])
        
        segregation_ratios.append(r_light / r_heavy)
    
    return segregation_ratios

def calculate_virial_ratio(positions, velocities, masses):
    &quot;&quot;&quot;
    Calculate virial ratio: 2T/|U|
    
    For bound system in equilibrium, should equal 1.
    &quot;&quot;&quot;
    # Kinetic energy
    T = 0.5 * np.sum(masses * np.sum(velocities**2, axis=1))
    
    # Potential energy
    U = 0
    for i in range(len(masses)):
        for j in range(i+1, len(masses)):
            r_ij = np.linalg.norm(positions[i] - positions[j])
            U -= G * masses[i] * masses[j] / r_ij
    
    return 2 * T / abs(U)

def identify_escaping_stars(positions, velocities, masses, escape_criterion=2.0):
    &quot;&quot;&quot;
    Identify stars with velocities exceeding escape velocity.
    
    v_escape = sqrt(2 * |U| / m) at each star&#x27;s location
    &quot;&quot;&quot;
    escaping_stars = []
    
    for i in range(len(masses)):
        # Calculate potential at star i due to all other stars
        phi_i = 0
        for j in range(len(masses)):
            if i != j:
                r_ij = np.linalg.norm(positions[i] - positions[j])
                phi_i -= G * masses[j] / r_ij
        
        # Escape velocity at this location
        v_escape = np.sqrt(-2 * phi_i)
        v_star = np.linalg.norm(velocities[i])
        
        if v_star &gt; escape_criterion * v_escape:
            escaping_stars.append(i)
    
    return escaping_stars</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p><strong>Cluster Snapshot Generation for Project 3</strong>:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def generate_cluster_snapshots(cluster_mass=1000, n_stars=200, 
                              evolution_times=[0, 5, 20, 50]):
    &quot;&quot;&quot;
    Generate stellar cluster at multiple evolutionary phases.
    These snapshots will be used in Project 3 for radiation calculations.
    
    Parameters:
    -----------
    cluster_mass : float
        Total cluster mass [M☉]
    n_stars : int
        Number of stars in cluster
    evolution_times : list
        Times to save snapshots [Myr]
        
    Returns:
    --------
    snapshots : list of dict
        Each dict contains stellar properties at one time
    &quot;&quot;&quot;
    # Initialize cluster
    imf = StellarIMF(imf_type=&#x27;kroupa&#x27;)
    masses = imf.sample_inverse_transform(n_stars)
    masses = masses * (cluster_mass / np.sum(masses))  # Normalize total mass
    
    plummer = PlummerSphere(total_mass=cluster_mass, scale_radius=1.0)
    positions = plummer.sample_positions(n_stars)
    velocities = plummer.calculate_virial_velocities(positions, masses)
    
    # Calculate stellar properties for radiation (from Project 1)
    stellar_props = mass_to_stellar_properties(masses)
    
    # Set up adaptive simulator
    simulator = AdaptiveNBodySimulator(
        positions, velocities, masses,
        initial_dt=0.01, energy_tolerance=1e-6
    )
    
    snapshots = []
    
    for t_target in evolution_times:
        if t_target == 0:
            # Initial conditions
            snapshot = create_snapshot(
                time=0, 
                positions=simulator.positions,
                velocities=simulator.velocities,
                masses=masses,
                stellar_props=stellar_props
            )
        else:
            # Evolve to target time
            results = simulator.evolve(t_target)
            
            # Extract final state
            final_positions = results[&#x27;positions&#x27;][-1]
            final_velocities = results[&#x27;velocities&#x27;][-1]
            
            snapshot = create_snapshot(
                time=t_target,
                positions=final_positions,
                velocities=final_velocities,
                masses=masses,
                stellar_props=stellar_props
            )
        
        snapshots.append(snapshot)
        print(f&quot;Snapshot created at t = {t_target} Myr&quot;)
    
    return snapshots

def create_snapshot(time, positions, velocities, masses, stellar_props):
    &quot;&quot;&quot;Create comprehensive cluster snapshot.&quot;&quot;&quot;
    # Calculate cluster center and properties
    center = np.average(positions, weights=masses, axis=0)
    centered_positions = positions - center
    
    # Structural parameters
    distances = np.linalg.norm(centered_positions, axis=1)
    half_mass_radius = np.median(distances)
    
    # Core radius (radius containing 10% of mass)
    mass_order = np.argsort(distances)
    core_mass_index = int(0.1 * len(masses))
    core_radius = distances[mass_order[core_mass_index]]
    
    snapshot = {
        &#x27;time&#x27;: time,
        &#x27;n_stars&#x27;: len(masses),
        &#x27;total_mass&#x27;: np.sum(masses),
        
        # Stellar properties
        &#x27;positions&#x27;: centered_positions,  # Centered on cluster
        &#x27;velocities&#x27;: velocities,
        &#x27;masses&#x27;: masses,
        &#x27;luminosities&#x27;: stellar_props[&#x27;luminosities&#x27;],
        &#x27;temperatures&#x27;: stellar_props[&#x27;temperatures&#x27;],
        &#x27;radii&#x27;: stellar_props[&#x27;radii&#x27;],
        
        # Cluster structure
        &#x27;center&#x27;: center,
        &#x27;half_mass_radius&#x27;: half_mass_radius,
        &#x27;core_radius&#x27;: core_radius,
        &#x27;virial_ratio&#x27;: calculate_virial_ratio(positions, velocities, masses),
        
        # Evolution diagnostics
        &#x27;mass_segregation_ratio&#x27;: analyze_mass_segregation([positions], masses, [time])[0],
        &#x27;escaping_stars&#x27;: identify_escaping_stars(positions, velocities, masses)
    }
    
    return snapshot

def save_snapshots_for_project3(snapshots, filename=&#x27;cluster_evolution.pkl&#x27;):
    &quot;&quot;&quot;Save snapshots in format suitable for Project 3.&quot;&quot;&quot;
    import pickle
    
    with open(filename, &#x27;wb&#x27;) as f:
        pickle.dump(snapshots, f)
    
    print(f&quot;Saved {len(snapshots)} cluster snapshots to {filename}&quot;)
    print(&quot;These will be used as radiation sources in Project 3&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><h4 id="task-3-performance-analysis-and-optimization-30-min" class="relative group"><span class="heading-text">Task 3: Performance Analysis and Optimization (30 min)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#task-3-performance-analysis-and-optimization-30-min" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p><strong>Goal</strong>: Analyze computational efficiency and identify optimization opportunities</p><p><strong>Performance Studies</strong>:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def scaling_analysis():
    &quot;&quot;&quot;Study how computational cost scales with cluster size.&quot;&quot;&quot;
    import time
    
    N_values = [50, 100, 200, 400]
    times_force = []
    times_integration = []
    
    for N in N_values:
        # Generate test cluster
        masses = np.random.uniform(0.1, 10, N)
        positions = np.random.randn(N, 3)
        velocities = np.random.randn(N, 3)
        
        # Time force calculation
        start = time.time()
        for _ in range(10):  # Multiple iterations for averaging
            forces = gravitational_forces_vectorized(positions, masses)
        times_force.append((time.time() - start) / 10)
        
        # Time full integration step
        simulator = AdaptiveNBodySimulator(positions, velocities, masses)
        start = time.time()
        for _ in range(10):
            simulator.adaptive_step()
        times_integration.append((time.time() - start) / 10)
    
    # Analyze scaling: should be O(N²) for force calculation
    print(&quot;Scaling Analysis:&quot;)
    for i, N in enumerate(N_values):
        print(f&quot;N={N}: Force={times_force[i]:.4f}s, Integration={times_integration[i]:.4f}s&quot;)

def memory_optimization_analysis():
    &quot;&quot;&quot;Analyze memory usage and suggest optimizations.&quot;&quot;&quot;
    # Profile memory usage during simulation
    # Identify opportunities for optimization
    pass</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p><strong>Week 3 Deliverable</strong>: Complete adaptive N-body simulator with realistic cluster evolution and snapshots for Project 3</p><hr class="py-2 my-5 translate-y-2"/><h2 id="assessment-and-grading" class="relative group"><span class="heading-text">Assessment and Grading</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#assessment-and-grading" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h3 id="grading-breakdown" class="relative group"><span class="heading-text">Grading Breakdown</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#grading-breakdown" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><ul><li><strong>Week 1</strong>: ODE solvers and validation (30%)</li><li><strong>Week 2</strong>: Statistical sampling and vectorization (35%)</li><li><strong>Week 3</strong>: Adaptive methods and cluster evolution (35%)</li></ul><h3 id="evaluation-criteria" class="relative group"><span class="heading-text">Evaluation Criteria</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#evaluation-criteria" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><h4 id="technical-implementation-60" class="relative group"><span class="heading-text">Technical Implementation (60%)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#technical-implementation-60" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><ul><li><strong>Algorithm Correctness</strong>: Do integrators conserve energy appropriately?</li><li><strong>Sampling Accuracy</strong>: Do distributions match theoretical expectations?</li><li><strong>Vectorization Efficiency</strong>: Significant speedup over naive implementations</li><li><strong>Adaptive Control</strong>: Proper timestep adjustment based on energy errors</li></ul><h4 id="scientific-understanding-25" class="relative group"><span class="heading-text">Scientific Understanding (25%)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#scientific-understanding-25" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><ul><li><strong>Physics Validation</strong>: Energy conservation, virial equilibrium, orbital mechanics</li><li><strong>Statistical Analysis</strong>: IMF and spatial distribution validation</li><li><strong>Cluster Evolution</strong>: Understanding of mass segregation and stellar escape</li></ul><h4 id="code-quality-and-performance-15" class="relative group"><span class="heading-text">Code Quality and Performance (15%)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#code-quality-and-performance-15" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><ul><li><strong>Documentation</strong>: Clear docstrings and code organization</li><li><strong>Testing</strong>: Validation against analytical solutions</li><li><strong>Optimization</strong>: Efficient use of NumPy vectorization</li><li><strong>Reproducibility</strong>: Proper random seed handling</li></ul><h3 id="connection-to-project-3" class="relative group"><span class="heading-text">Connection to Project 3</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#connection-to-project-3" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The stellar cluster snapshots generated in this project become the radiation sources for Project 3:</p><ul><li><strong>Stellar positions</strong>: Spatial distribution for radiation field calculations</li><li><strong>Stellar masses and luminosities</strong>: Heating source strengths</li><li><strong>Cluster evolution</strong>: How radiation field changes with time</li><li><strong>Realistic populations</strong>: IMF-sampled masses give proper luminosity functions</li></ul><h3 id="deliverables" class="relative group"><span class="heading-text">Deliverables</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#deliverables" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><h4 id="final-submission" class="relative group"><span class="heading-text">Final Submission</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#final-submission" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><ol start="1"><li><p><strong>N-Body Simulation Library</strong>:</p><ul><li><code>ode_solvers.py</code>: Integration method implementations</li><li><code>stellar_sampling.py</code>: IMF and Plummer sphere classes</li><li><code>nbody_simulator.py</code>: Complete adaptive N-body framework</li><li><code>cluster_analysis.py</code>: Evolution analysis tools</li></ul></li><li><p><strong>Validation Notebooks</strong>:</p><ul><li><code>orbital_mechanics_validation.ipynb</code>: Two-body problem tests</li><li><code>sampling_validation.ipynb</code>: IMF and spatial distribution verification</li><li><code>cluster_evolution_analysis.ipynb</code>: Mass segregation and dynamics</li></ul></li><li><p><strong>Project 3 Interface</strong>:</p><ul><li><code>cluster_snapshots.pkl</code>: Saved stellar cluster evolution data</li><li><code>snapshot_format.md</code>: Documentation of data structure</li></ul></li></ol><p>This project establishes the realistic stellar systems needed for sophisticated radiation calculations while teaching essential computational physics skills: numerical integration, statistical sampling, vectorization, and adaptive methods.</p><div></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/project1-description"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">Short Projects</div>ASTR 596 Project 1: Python Fundamentals + Numerical Analysis + Stellar Physics</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/project3-description"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">Short Projects</div>ASTR 596 Project 3: Monte Carlo Radiative Transfer + MCMC + Bayesian Statistics</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></main></article><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/build/_shared/chunk-JSE36H2O.js"/><link rel="modulepreload" href="/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/build/_shared/chunk-C7FW3E47.js"/><link rel="modulepreload" href="/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/build/_shared/chunk-ND43KHSX.js"/><link rel="modulepreload" href="/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/build/root-IB5726YR.js"/><link rel="modulepreload" href="/build/_shared/chunk-NBON2RSI.js"/><link rel="modulepreload" href="/build/routes/$-LXLHKVOR.js"/><script>window.__remixContext = {"url":"/project2-description","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.0","title":"ASTR 596: Modeling the Universe","options":{"logo_text":"✨ASTR 596✨"},"nav":[],"actions":[],"projects":[{"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"MIT","url":"https://opensource.org/licenses/MIT","name":"MIT License","free":true,"osi":true}},"subject":"Modeling the Universe","title":"ASTR 596: Modeling the Universe","description":"Graduate-level computational astrophysics course emphasizing glass-box modeling and modern computational frameworks","authors":[{"nameParsed":{"literal":"Anna Rosen","given":"Anna","family":"Rosen"},"name":"Anna Rosen","orcid":"0000-0003-4423-0660","email":"alrosen@sdsu.edu","affiliations":["San Diego State University"],"id":"contributors-myst-generated-uid-0","corresponding":true}],"venue":{"title":"ASTR 596 - Fall 2025","url":"https://www.anna-rosen.com"},"github":"https://github.com/astrobytes-edu/astr596-modeling-universe","keywords":["computational astrophysics","python","numerical methods","machine learning","monte carlo","neural networks","radiative transfer","bayesian inference","JAX"],"affiliations":[{"id":"San Diego State University","name":"San Diego State University"}],"id":"76c4875f-ba4c-4a35-bc58-52304ee2705e","thebe":{"kernelName":"python3"},"exports":[],"bibliography":[],"index":"index","pages":[{"title":"Course Info","level":1},{"slug":"syllabus","title":"Syllabus - ASTR 596: Modeling the Universe","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"schedule","title":"Course Schedule \u0026 Important Dates","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"ai-guidelines-final","title":"ASTR 596 AI Policy \u0026 Learning Framework","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"learning-guide-final","title":"Troubleshooting \u0026 Learning Guide","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"course-overview-final","title":"Understanding Your Learning Journey in ASTR 596","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"why-different-final","title":"Why ASTR 596 is Designed This Way","description":"","date":"","thumbnail":"/build/growth-mindset-f09d688b3b9e3cf1880effa6bda2802e.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Getting Started","level":1},{"slug":"software-setup-guide-orig","title":"Software Setup Guide","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"git-intro-guide-orig","title":"Introduction to Git and GitHub","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"cli-intro-guide-orig","title":"Introduction to the Command Line Interface (CLI)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Python","level":1},{"title":"Python Fundamentals","level":2},{"slug":"python-enrivonment-revised","title":"Chapter 1: Computational Environments \u0026 Scientific Workflows","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"python-calculator-orig","title":"Chapter 2: Python as a Calculator \u0026 Basic Data Types","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"python-control-flow-orig","title":"Chapter 3: Control Flow \u0026 Logic","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"python-data-structures-orig","title":"Chapter 4: Data Structures","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"python-functions-modules-orig","title":"Chapter 5: Functions \u0026 Modules - Building Reusable Scientific Code","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"python-oop-orig","title":"Chapter 6: Object-Oriented Programming - Organizing Scientific Code","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Scientific Computing Core","level":2},{"slug":"python-numpy-scientific-orig","title":"Chapter 7: NumPy - The Foundation of Scientific Computing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"python-matplotlib-scientific-orig","title":"Chapter 8: Matplotlib - Creating Publication-Quality Scientific Visualizations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"python-robust-computing-orig","title":"Chapter 9: Robust Computing Fundamentals - Error Handling and Best Practices","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Computational Methods","level":1},{"slug":"index-1","title":"Computational Methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Machine Learning","level":2},{"slug":"index-2","title":"Machine Learning","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Modern Frameworks","level":2},{"slug":"index-3","title":"Modern Frameworks","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Numerical Methods","level":2},{"slug":"index-4","title":"Numerical Methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Python Fundamentals V1","level":2},{"title":"Python Fundamentals","level":3},{"slug":"index-5","title":"Python Fundamentals","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"slug":"chapter1-python-calculator","title":"Chapter 1: Python as a Scientific Calculator","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"slug":"chapter2-control-flow","title":"Chapter 2: Control Flow \u0026 Logic - Teaching Computers to Think","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"slug":"chapter3-functions","title":"Chapter 3: Functions - The Art of Abstraction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Astrophysics","level":1},{"slug":"index-6","title":"Astrophysics Applications","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Advanced Topics","level":2},{"slug":"index-7","title":"Advanced Topics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Gravitational Dynamics","level":2},{"slug":"index-8","title":"Gravitational Dynamics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Radiative Transfer","level":2},{"slug":"index-9","title":"Radiative Transfer","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Stellar Physics","level":2},{"slug":"index-10","title":"Stellar Physics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Short Projects","level":1},{"slug":"index-11","title":"Short Projects Overview","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"project-submission-guide","title":"ASTR 596: Project Submission Guide","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"project1-description","title":"ASTR 596 Project 1: Python Fundamentals + Numerical Analysis + Stellar Physics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"project2-description","title":"ASTR 596 Project 2: N-Body Dynamics + Statistical Sampling + Stellar Systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"project3-description","title":"ASTR 596 Project 3: Monte Carlo Radiative Transfer + MCMC + Bayesian Statistics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Final Project","level":1},{"slug":"index-12","title":"Final Project: Neural Networks \u0026 JAX","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"astr596-project-outline","title":"ASTR596: Modeling the Universe - Complete Scaffolded Project Progression","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"final-project-guide","title":"ASTR 596: Final Project Guide","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Reference","level":1},{"slug":"index-13","title":"Reference Materials","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"cli-advanced-guide","title":"Advanced CLI Guide (Optional)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"External Resources","level":2},{"slug":"index-14","title":"External Resources","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Quick References","level":2},{"slug":"index-15","title":"Quick References","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Troubleshooting","level":2},{"slug":"index-16","title":"Troubleshooting","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static"},"routes/$":{"config":{"version":2,"myst":"1.6.0","title":"ASTR 596: Modeling the Universe","options":{"logo_text":"✨ASTR 596✨"},"nav":[],"actions":[],"projects":[{"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"MIT","url":"https://opensource.org/licenses/MIT","name":"MIT License","free":true,"osi":true}},"subject":"Modeling the Universe","title":"ASTR 596: Modeling the Universe","description":"Graduate-level computational astrophysics course emphasizing glass-box modeling and modern computational frameworks","authors":[{"nameParsed":{"literal":"Anna Rosen","given":"Anna","family":"Rosen"},"name":"Anna Rosen","orcid":"0000-0003-4423-0660","email":"alrosen@sdsu.edu","affiliations":["San Diego State University"],"id":"contributors-myst-generated-uid-0","corresponding":true}],"venue":{"title":"ASTR 596 - Fall 2025","url":"https://www.anna-rosen.com"},"github":"https://github.com/astrobytes-edu/astr596-modeling-universe","keywords":["computational astrophysics","python","numerical methods","machine learning","monte carlo","neural networks","radiative transfer","bayesian inference","JAX"],"affiliations":[{"id":"San Diego State University","name":"San Diego State University"}],"id":"76c4875f-ba4c-4a35-bc58-52304ee2705e","thebe":{"kernelName":"python3"},"exports":[],"bibliography":[],"index":"index","pages":[{"title":"Course Info","level":1},{"slug":"syllabus","title":"Syllabus - ASTR 596: Modeling the Universe","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"schedule","title":"Course Schedule \u0026 Important Dates","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"ai-guidelines-final","title":"ASTR 596 AI Policy \u0026 Learning Framework","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"learning-guide-final","title":"Troubleshooting \u0026 Learning Guide","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"course-overview-final","title":"Understanding Your Learning Journey in ASTR 596","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"why-different-final","title":"Why ASTR 596 is Designed This Way","description":"","date":"","thumbnail":"/build/growth-mindset-f09d688b3b9e3cf1880effa6bda2802e.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Getting Started","level":1},{"slug":"software-setup-guide-orig","title":"Software Setup Guide","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"git-intro-guide-orig","title":"Introduction to Git and GitHub","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"cli-intro-guide-orig","title":"Introduction to the Command Line Interface (CLI)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Python","level":1},{"title":"Python Fundamentals","level":2},{"slug":"python-enrivonment-revised","title":"Chapter 1: Computational Environments \u0026 Scientific Workflows","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"python-calculator-orig","title":"Chapter 2: Python as a Calculator \u0026 Basic Data Types","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"python-control-flow-orig","title":"Chapter 3: Control Flow \u0026 Logic","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"python-data-structures-orig","title":"Chapter 4: Data Structures","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"python-functions-modules-orig","title":"Chapter 5: Functions \u0026 Modules - Building Reusable Scientific Code","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"python-oop-orig","title":"Chapter 6: Object-Oriented Programming - Organizing Scientific Code","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Scientific Computing Core","level":2},{"slug":"python-numpy-scientific-orig","title":"Chapter 7: NumPy - The Foundation of Scientific Computing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"python-matplotlib-scientific-orig","title":"Chapter 8: Matplotlib - Creating Publication-Quality Scientific Visualizations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"python-robust-computing-orig","title":"Chapter 9: Robust Computing Fundamentals - Error Handling and Best Practices","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Computational Methods","level":1},{"slug":"index-1","title":"Computational Methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Machine Learning","level":2},{"slug":"index-2","title":"Machine Learning","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Modern Frameworks","level":2},{"slug":"index-3","title":"Modern Frameworks","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Numerical Methods","level":2},{"slug":"index-4","title":"Numerical Methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Python Fundamentals V1","level":2},{"title":"Python Fundamentals","level":3},{"slug":"index-5","title":"Python Fundamentals","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"slug":"chapter1-python-calculator","title":"Chapter 1: Python as a Scientific Calculator","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"slug":"chapter2-control-flow","title":"Chapter 2: Control Flow \u0026 Logic - Teaching Computers to Think","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"slug":"chapter3-functions","title":"Chapter 3: Functions - The Art of Abstraction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Astrophysics","level":1},{"slug":"index-6","title":"Astrophysics Applications","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Advanced Topics","level":2},{"slug":"index-7","title":"Advanced Topics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Gravitational Dynamics","level":2},{"slug":"index-8","title":"Gravitational Dynamics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Radiative Transfer","level":2},{"slug":"index-9","title":"Radiative Transfer","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Stellar Physics","level":2},{"slug":"index-10","title":"Stellar Physics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Short Projects","level":1},{"slug":"index-11","title":"Short Projects Overview","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"project-submission-guide","title":"ASTR 596: Project Submission Guide","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"project1-description","title":"ASTR 596 Project 1: Python Fundamentals + Numerical Analysis + Stellar Physics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"project2-description","title":"ASTR 596 Project 2: N-Body Dynamics + Statistical Sampling + Stellar Systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"project3-description","title":"ASTR 596 Project 3: Monte Carlo Radiative Transfer + MCMC + Bayesian Statistics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Final Project","level":1},{"slug":"index-12","title":"Final Project: Neural Networks \u0026 JAX","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"astr596-project-outline","title":"ASTR596: Modeling the Universe - Complete Scaffolded Project Progression","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"final-project-guide","title":"ASTR 596: Final Project Guide","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Reference","level":1},{"slug":"index-13","title":"Reference Materials","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"cli-advanced-guide","title":"Advanced CLI Guide (Optional)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"External Resources","level":2},{"slug":"index-14","title":"External Resources","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Quick References","level":2},{"slug":"index-15","title":"Quick References","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Troubleshooting","level":2},{"slug":"index-16","title":"Troubleshooting","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3}]}]},"page":{"version":2,"kind":"Article","sha256":"4fd2daae84007f0520b26be51dcb897acbd791960b7da96d2dced904d0c61623","slug":"project2-description","location":"/07-short-projects/2_project2_description.md","dependencies":[],"frontmatter":{"title":"ASTR 596 Project 2: N-Body Dynamics + Statistical Sampling + Stellar Systems","content_includes_title":false,"authors":[{"nameParsed":{"literal":"Anna Rosen","given":"Anna","family":"Rosen"},"name":"Anna Rosen","orcid":"0000-0003-4423-0660","email":"alrosen@sdsu.edu","affiliations":["San Diego State University"],"id":"contributors-myst-generated-uid-0","corresponding":true}],"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"MIT","url":"https://opensource.org/licenses/MIT","name":"MIT License","free":true,"osi":true}},"github":"https://github.com/astrobytes-edu/astr596-modeling-universe","subject":"Modeling the Universe","venue":{"title":"ASTR 596 - Fall 2025","url":"https://www.anna-rosen.com"},"keywords":["computational astrophysics","python","numerical methods","machine learning","monte carlo","neural networks","radiative transfer","bayesian inference","JAX"],"affiliations":[{"id":"San Diego State University","name":"San Diego State University"}],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/astrobytes-edu/astr596-modeling-universe/blob/main/07-short-projects/2_project2_description.md","exports":[{"format":"md","filename":"2_project2_description.md","url":"/build/2_project2_descripti-e7f10b7c465dc6836035178e9ea167f5.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Duration","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Hj1MZVPjSg"}],"key":"xvO8kLd6bI"},{"type":"text","value":": 3 weeks\n","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"yFe6PzXMhc"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Weight","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"q3Ks9TvIUl"}],"key":"jl7pGrFT58"},{"type":"text","value":": 15% of course grade\n","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ghAU1u5FXH"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Theme","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"pybAhYai0R"}],"key":"Pmz7iC6Ex3"},{"type":"text","value":": “Realistic Stellar Clusters with Gravitational Dynamics”","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"QtA4vVvwGf"}],"key":"jAUKC7xBcS"},{"type":"thematicBreak","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"QZtKlbnu3H"},{"type":"heading","depth":3,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Project Overview","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"puah5UaSWt"}],"identifier":"project-overview","label":"Project Overview","html_id":"project-overview","implicit":true,"key":"OxFEravWaO"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"This project builds sophisticated N-body gravitational dynamics simulations with realistic stellar populations. You will implement multiple ODE integration schemes, master statistical sampling from astrophysical distributions, and create evolving stellar clusters that serve as input for radiation calculations in Project 3. The emphasis is on vectorization, performance optimization, and adaptive numerical methods.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"D2UIBUny8M"}],"key":"tXAdSpXEtQ"},{"type":"heading","depth":3,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Learning Objectives","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"w4qlNHZXoe"}],"identifier":"learning-objectives","label":"Learning Objectives","html_id":"learning-objectives","implicit":true,"key":"f5K14phBEY"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"By completing this project, you will:","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"CXQaoVuCgA"}],"key":"TBSoC8twdI"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":15,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Master ODE integration","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"JBWPLShWEi"}],"key":"i9YMSSgqtu"},{"type":"text","value":": Implement and compare multiple numerical integration schemes","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"VUylDKvQc8"}],"key":"Q6MmuzxZ2E"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Understand gravitational dynamics","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"IJTPvOLENz"}],"key":"Vgjt12vSUx"},{"type":"text","value":": N-body physics, energy conservation, and cluster evolution","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"b51UoC0XqM"}],"key":"TyhfxGeDdz"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Learn statistical sampling","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"mlC84n5qLM"}],"key":"j09tmwEvWY"},{"type":"text","value":": Sample from Initial Mass Function and spatial distributions","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"RBaLzYoGOv"}],"key":"mm5Z5OqVgh"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Develop vectorization skills","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"AM1ImmQMw4"}],"key":"WM2GOKuI3X"},{"type":"text","value":": Efficient NumPy operations for computational performance","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"QexzxDx0gc"}],"key":"LDq08VQHfw"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Implement adaptive methods","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"XGc8ZAnMIj"}],"key":"CFnuwmxImn"},{"type":"text","value":": Energy-controlled timestep adjustment","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"qwVf1tDsIn"}],"key":"KbrqO3JxUg"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Generate realistic astrophysical data","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"GFGs7frKzK"}],"key":"AB4cchQy8z"},{"type":"text","value":": Stellar clusters for radiation modeling","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"ZKuylZmf7N"}],"key":"W1PojaLMbI"}],"key":"Ji8vVqLN0s"},{"type":"heading","depth":3,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Prerequisites from Project 1","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"Z7k1pkJyXe"}],"identifier":"prerequisites-from-project-1","label":"Prerequisites from Project 1","html_id":"prerequisites-from-project-1","implicit":true,"key":"DZQGA1xWSZ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":23,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Numerical integration techniques (trapezoid, Simpson’s, Gaussian quadrature)","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"ph6EcmPFsh"}],"key":"izALujaXUl"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Root-finding methods (Newton-Raphson for energy balance)","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"rjNwgxI2Nq"}],"key":"CsTBNWeKCj"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Object-oriented programming (Star class design)","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"xdfSv9HLFx"}],"key":"PojXtIHhlf"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Blackbody physics and stellar luminosity calculations","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"xJq7GqOIQJ"}],"key":"BDMss7CIhy"}],"key":"TGIXuDva2K"},{"type":"thematicBreak","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"crlHF5xGBJ"},{"type":"heading","depth":2,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Week 1: ODE Solvers and Energy Conservation","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"DwnzoePjWX"}],"identifier":"week-1-ode-solvers-and-energy-conservation","label":"Week 1: ODE Solvers and Energy Conservation","html_id":"week-1-ode-solvers-and-energy-conservation","implicit":true,"key":"V6Uovgn2lN"},{"type":"heading","depth":3,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"Conceptual Introduction (25 min)","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"W0RZv1IFSb"}],"identifier":"conceptual-introduction-25-min","label":"Conceptual Introduction (25 min)","html_id":"conceptual-introduction-25-min","implicit":true,"key":"WwqpizfrK5"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":33,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"Newton’s laws and gravitational force in astrophysical contexts","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"nKaZPjUoMU"}],"key":"cf1bl1vXpP"},{"type":"listItem","spread":true,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Converting 2nd order ODEs to 1st order systems","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"oiARjC07Ua"}],"key":"ulHR0GE0ER"},{"type":"listItem","spread":true,"position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"Integration methods: explicit vs implicit, stability vs accuracy","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"k0c3TS9HFL"}],"key":"oD6D0HBRUB"},{"type":"listItem","spread":true,"position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Symplectic integrators for Hamiltonian systems","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"TQ57mysAQ7"}],"key":"PiBl3DfXv5"},{"type":"listItem","spread":true,"position":{"start":{"line":37,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Energy and angular momentum conservation in gravitational systems","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"Qt7Qibku3G"}],"key":"i0yI3CgWfC"}],"key":"KBVKBj0DND"},{"type":"heading","depth":3,"position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"Lab Session Objectives","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"QSLtGoz4B8"}],"identifier":"lab-session-objectives","label":"Lab Session Objectives","html_id":"lab-session-objectives","implicit":true,"key":"zjTVneaVqw"},{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Build comprehensive ODE solver library and validate on two-body dynamics.","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"zCKGVk3TWM"}],"key":"qRLvs6RpTK"},{"type":"heading","depth":4,"position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"Task 1: ODE Solver Framework (45 min)","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"hSa24PvrhC"}],"identifier":"task-1-ode-solver-framework-45-min","label":"Task 1: ODE Solver Framework (45 min)","html_id":"task-1-ode-solver-framework-45-min","implicit":true,"key":"VcXCK6hgBf"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"strong","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"Goal","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"M2PUT0mzZ4"}],"key":"S2w9waiUz1"},{"type":"text","value":": Create abstract base class and implement multiple integration methods","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"ruJ55j3Ye2"}],"key":"YeCDx5U47a"},{"type":"paragraph","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"strong","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"Framework Design","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"qOGrB20bJb"}],"key":"c32YhB8v08"},{"type":"text","value":":","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"SlrHJ4JwP5"}],"key":"lhgrNFEVtU"},{"type":"code","lang":"python","value":"from abc import ABC, abstractmethod\nimport numpy as np\n\nclass ODESolver(ABC):\n    \"\"\"\n    Abstract base class for ODE integration methods.\n    \n    Solves system: dy/dt = f(t, y) where y can be vector-valued\n    \"\"\"\n    \n    def __init__(self, derivatives_func, initial_conditions, initial_time=0.0):\n        \"\"\"\n        Parameters:\n        -----------\n        derivatives_func : callable\n            Function f(t, y) returning dy/dt\n        initial_conditions : array_like\n            Initial values y(t0)\n        initial_time : float\n            Initial time t0\n        \"\"\"\n        self.f = derivatives_func\n        self.y = np.array(initial_conditions, dtype=float)\n        self.t = initial_time\n        self.history = {'t': [initial_time], 'y': [self.y.copy()]}\n    \n    @abstractmethod\n    def step(self, dt):\n        \"\"\"Take single integration step of size dt.\"\"\"\n        pass\n    \n    def evolve(self, t_final, dt):\n        \"\"\"Evolve system from current time to t_final.\"\"\"\n        while self.t \u003c t_final:\n            step_size = min(dt, t_final - self.t)\n            self.step(step_size)\n            self.history['t'].append(self.t)\n            self.history['y'].append(self.y.copy())\n        return np.array(self.history['t']), np.array(self.history['y'])\n\nclass EulerSolver(ODESolver):\n    \"\"\"First-order Euler method: y_{n+1} = y_n + dt * f(t_n, y_n)\"\"\"\n    \n    def step(self, dt):\n        \"\"\"Implement Euler step.\"\"\"\n        dydt = self.f(self.t, self.y)\n        self.y += dt * dydt\n        self.t += dt\n\nclass RungeKutta4Solver(ODESolver):\n    \"\"\"Fourth-order Runge-Kutta method.\"\"\"\n    \n    def step(self, dt):\n        \"\"\"Implement RK4 step with four evaluations.\"\"\"\n        k1 = self.f(self.t, self.y)\n        k2 = self.f(self.t + dt/2, self.y + dt*k1/2)\n        k3 = self.f(self.t + dt/2, self.y + dt*k2/2)\n        k4 = self.f(self.t + dt, self.y + dt*k3)\n        \n        self.y += dt * (k1 + 2*k2 + 2*k3 + k4) / 6\n        self.t += dt\n\nclass LeapfrogSolver(ODESolver):\n    \"\"\"\n    Leapfrog integrator for Hamiltonian systems.\n    Particularly good for gravitational dynamics.\n    \"\"\"\n    \n    def __init__(self, force_func, positions, velocities, masses, initial_time=0.0):\n        \"\"\"\n        Specialized for N-body problems.\n        \n        Parameters:\n        -----------\n        force_func : callable\n            Function returning accelerations given (positions, masses)\n        positions : array\n            Initial positions [N, 3]\n        velocities : array  \n            Initial velocities [N, 3]\n        masses : array\n            Particle masses [N]\n        \"\"\"\n        self.force_func = force_func\n        self.positions = np.array(positions)\n        self.velocities = np.array(velocities)\n        self.masses = np.array(masses)\n        self.t = initial_time\n        self.history = {\n            't': [initial_time],\n            'positions': [self.positions.copy()],\n            'velocities': [self.velocities.copy()]\n        }\n    \n    def step(self, dt):\n        \"\"\"Leapfrog integration step.\"\"\"\n        # Kick: v_{1/2} = v_0 + (dt/2) * a_0\n        accelerations = self.force_func(self.positions, self.masses)\n        self.velocities += 0.5 * dt * accelerations\n        \n        # Drift: x_1 = x_0 + dt * v_{1/2}\n        self.positions += dt * self.velocities\n        \n        # Kick: v_1 = v_{1/2} + (dt/2) * a_1\n        accelerations = self.force_func(self.positions, self.masses)\n        self.velocities += 0.5 * dt * accelerations\n        \n        self.t += dt\n        self.history['t'].append(self.t)\n        self.history['positions'].append(self.positions.copy())\n        self.history['velocities'].append(self.velocities.copy())","position":{"start":{"line":46,"column":1},"end":{"line":158,"column":1}},"key":"puz8vG9ynL"},{"type":"heading","depth":4,"position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"children":[{"type":"text","value":"Task 2: Two-Body Gravitational Dynamics (60 min)","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"CRnQfTtW85"}],"identifier":"task-2-two-body-gravitational-dynamics-60-min","label":"Task 2: Two-Body Gravitational Dynamics (60 min)","html_id":"task-2-two-body-gravitational-dynamics-60-min","implicit":true,"key":"UY1kd5Qndp"},{"type":"paragraph","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"children":[{"type":"strong","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"children":[{"type":"text","value":"Goal","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"DJvRRh8ArN"}],"key":"VicD9XGPO9"},{"type":"text","value":": Validate integrators on Kepler problem with known analytical solution","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"jMXlh7emLM"}],"key":"jjQ9SGufPQ"},{"type":"paragraph","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"children":[{"type":"strong","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"children":[{"type":"text","value":"Implementation Requirements","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"zFAkZFmJOd"}],"key":"SAm2unYrBK"},{"type":"text","value":":","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"YAb9BEybfA"}],"key":"I1Ds7XvfLW"},{"type":"code","lang":"python","value":"def gravitational_derivatives(t, state):\n    \"\"\"\n    Derivatives for two-body problem.\n    \n    state = [x1, y1, z1, vx1, vy1, vz1, x2, y2, z2, vx2, vy2, vz2]\n    \"\"\"\n    # Extract positions and velocities\n    pos1 = state[0:3]\n    vel1 = state[3:6]\n    pos2 = state[6:9]\n    vel2 = state[9:12]\n    \n    # Calculate separation and force\n    r_vec = pos2 - pos1\n    r_mag = np.linalg.norm(r_vec)\n    \n    # Gravitational acceleration\n    G = 6.674e-11  # m³/kg/s²\n    m1, m2 = 1.0, 1.0  # masses\n    \n    acc_magnitude = G * (m1 + m2) / r_mag**3\n    acc1 = acc_magnitude * r_vec\n    acc2 = -acc_magnitude * r_vec\n    \n    # Return derivatives: [vel1, acc1, vel2, acc2]\n    return np.concatenate([vel1, acc1, vel2, acc2])\n\ndef kepler_orbit_validation():\n    \"\"\"\n    Test integrators on Earth-Sun system.\n    Compare with analytical solution for energy and angular momentum.\n    \"\"\"\n    # Earth-Sun system (simplified units)\n    AU = 1.496e11  # m\n    year = 365.25 * 24 * 3600  # s\n    \n    # Initial conditions: Earth at aphelion\n    initial_state = [\n        1.017*AU, 0, 0,      # Earth position\n        0, 29.29e3, 0,       # Earth velocity\n        0, 0, 0,             # Sun position (at origin)\n        0, 0, 0              # Sun velocity\n    ]\n    \n    # Test each integrator\n    methods = {\n        'Euler': EulerSolver,\n        'RK4': RungeKutta4Solver\n    }\n    \n    results = {}\n    for name, SolverClass in methods.items():\n        solver = SolverClass(gravitational_derivatives, initial_state)\n        t_vals, y_vals = solver.evolve(t_final=year, dt=year/1000)\n        results[name] = {'t': t_vals, 'y': y_vals}\n    \n    return results\n\ndef calculate_orbital_energy(positions, velocities, masses):\n    \"\"\"Calculate total energy: kinetic + potential.\"\"\"\n    # Kinetic energy: (1/2) * m * v²\n    ke = 0.5 * np.sum(masses * np.sum(velocities**2, axis=1))\n    \n    # Potential energy: -G * m1 * m2 / r\n    G = 6.674e-11\n    pe = 0\n    for i in range(len(masses)):\n        for j in range(i+1, len(masses)):\n            r_ij = np.linalg.norm(positions[i] - positions[j])\n            pe -= G * masses[i] * masses[j] / r_ij\n    \n    return ke + pe\n\ndef orbital_validation_analysis(results):\n    \"\"\"\n    Analyze energy conservation and orbital accuracy.\n    Plot energy drift and orbital trajectories.\n    \"\"\"\n    # Calculate energy conservation for each method\n    # Plot trajectories and energy vs time\n    # Compare with analytical orbital period","position":{"start":{"line":164,"column":1},"end":{"line":246,"column":1}},"key":"cUaMG94PH6"},{"type":"heading","depth":4,"position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"children":[{"type":"text","value":"Task 3: Error Analysis and Method Comparison (30 min)","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"key":"gUnCyyFLX2"}],"identifier":"task-3-error-analysis-and-method-comparison-30-min","label":"Task 3: Error Analysis and Method Comparison (30 min)","html_id":"task-3-error-analysis-and-method-comparison-30-min","implicit":true,"key":"gZpPl5LSGn"},{"type":"paragraph","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"children":[{"type":"strong","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"children":[{"type":"text","value":"Goal","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"xH44PsYFfw"}],"key":"BlwBevsgMT"},{"type":"text","value":": Understand trade-offs between accuracy, stability, and computational cost","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"xM0BiyamSO"}],"key":"bQU2V41Pf4"},{"type":"paragraph","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"strong","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"text","value":"Analysis Requirements","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"AztSoGITmw"}],"key":"HMLOnrrIXl"},{"type":"text","value":":","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"lPW0X72TXA"}],"key":"PLRS1HjbuJ"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":252,"column":1},"end":{"line":256,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"children":[{"type":"strong","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"children":[{"type":"text","value":"Convergence Study","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"lCOxd2mAE6"}],"key":"BeMk7J0dxs"},{"type":"text","value":": Plot error vs timestep for each method","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"HakNPnP8iJ"}],"key":"qi85HT5jqa"},{"type":"listItem","spread":true,"position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"children":[{"type":"strong","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"children":[{"type":"text","value":"Energy Conservation","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"ADCXHYPtDq"}],"key":"Kx1FTOakUG"},{"type":"text","value":": Track relative energy drift over multiple orbits","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"GRpOoEm3Zo"}],"key":"qnlG3iv3mL"},{"type":"listItem","spread":true,"position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"children":[{"type":"strong","position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"children":[{"type":"text","value":"Computational Cost","position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"key":"EPRoPDMDXE"}],"key":"eXwjIYdxjI"},{"type":"text","value":": Time each method for various timestep sizes","position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"key":"clDiWFzKia"}],"key":"DTngz4HA5R"},{"type":"listItem","spread":true,"position":{"start":{"line":255,"column":1},"end":{"line":256,"column":1}},"children":[{"type":"strong","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"children":[{"type":"text","value":"Long-term Stability","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"BPqUa7yzbz"}],"key":"nVjrttbbSc"},{"type":"text","value":": Run for 10+ orbital periods","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"c6u2YPudm3"}],"key":"EPHckSeLEi"}],"key":"xhfCb3bNzP"},{"type":"paragraph","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"strong","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"text","value":"Week 1 Deliverable","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"Ejdg7YDYy1"}],"key":"r66wD2BwzT"},{"type":"text","value":": ODE solver library with comprehensive validation on Kepler orbits","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"iuC2CY9d2d"}],"key":"Q8KaGR2szM"},{"type":"thematicBreak","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"bn4jEFFjSx"},{"type":"heading","depth":2,"position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"children":[{"type":"text","value":"Week 2: Statistical Sampling and Multi-Body Systems","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"TyDt6f6F7A"}],"identifier":"week-2-statistical-sampling-and-multi-body-systems","label":"Week 2: Statistical Sampling and Multi-Body Systems","html_id":"week-2-statistical-sampling-and-multi-body-systems","implicit":true,"key":"DPkviGC58v"},{"type":"heading","depth":3,"position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"children":[{"type":"text","value":"Conceptual Introduction (25 min)","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"key":"RNnRzrFyLp"}],"identifier":"conceptual-introduction-25-min","label":"Conceptual Introduction (25 min)","html_id":"conceptual-introduction-25-min-1","implicit":true,"key":"HZzPQXZ8U2"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":264,"column":1},"end":{"line":268,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"children":[{"type":"text","value":"Stellar Initial Mass Function: Salpeter, Kroupa, Chabrier prescriptions","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"key":"riPkyjzKno"}],"key":"ATXy4PxwqC"},{"type":"listItem","spread":true,"position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"children":[{"type":"text","value":"Spatial distributions in star clusters: Plummer sphere, King profiles","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"key":"JLrlhlCACD"}],"key":"Ptwyfi996f"},{"type":"listItem","spread":true,"position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"children":[{"type":"text","value":"Statistical sampling techniques: inverse transform, rejection sampling","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"s57fH6WFwg"}],"key":"Y1XxW6B4ed"},{"type":"listItem","spread":true,"position":{"start":{"line":267,"column":1},"end":{"line":268,"column":1}},"children":[{"type":"text","value":"Virial equilibrium and cluster dynamics","position":{"start":{"line":267,"column":1},"end":{"line":267,"column":1}},"key":"o61gNGPqBJ"}],"key":"AceQT9Z0cV"}],"key":"We2H6PhpvL"},{"type":"heading","depth":3,"position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"children":[{"type":"text","value":"Lab Session Objectives","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"PkISWltk8n"}],"identifier":"lab-session-objectives","label":"Lab Session Objectives","html_id":"lab-session-objectives-1","implicit":true,"key":"FH8K4g2B0J"},{"type":"paragraph","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"children":[{"type":"text","value":"Implement realistic stellar cluster initialization and scale to many-body systems.","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"gHqw0CFDp8"}],"key":"FYN9yxsQIc"},{"type":"heading","depth":4,"position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"children":[{"type":"text","value":"Task 1: Initial Mass Function Implementation (50 min)","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"UVrkqfdKai"}],"identifier":"task-1-initial-mass-function-implementation-50-min","label":"Task 1: Initial Mass Function Implementation (50 min)","html_id":"task-1-initial-mass-function-implementation-50-min","implicit":true,"key":"XJ528yYiwN"},{"type":"paragraph","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"strong","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"text","value":"Goal","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"VFnM7XpO37"}],"key":"oI8kQXHqJU"},{"type":"text","value":": Sample realistic stellar mass distributions","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"QRe7yBgVyo"}],"key":"mXfMoBL83z"},{"type":"paragraph","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"strong","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"text","value":"IMF Theory and Implementation","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"VYUmMfJAHG"}],"key":"uQHLZ6yC51"},{"type":"text","value":":","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"QxcFPCl7mT"}],"key":"Fvf3A6MKeJ"},{"type":"code","lang":"python","value":"class StellarIMF:\n    \"\"\"\n    Stellar Initial Mass Function implementation.\n    \n    Supports multiple functional forms used in astrophysics.\n    \"\"\"\n    \n    def __init__(self, imf_type='kroupa', mass_range=(0.08, 120)):\n        \"\"\"\n        Parameters:\n        -----------\n        imf_type : str\n            'salpeter', 'kroupa', or 'chabrier'\n        mass_range : tuple\n            (minimum_mass, maximum_mass) in solar masses\n        \"\"\"\n        self.imf_type = imf_type\n        self.m_min, self.m_max = mass_range\n        self.normalization = self._calculate_normalization()\n    \n    def pdf(self, mass):\n        \"\"\"\n        Probability density function dN/dM.\n        \n        Salpeter (1955): dN/dM ∝ M^(-2.35)\n        Kroupa (2001): dN/dM ∝ M^(-1.3) for M \u003c 0.5 M☉\n                               M^(-2.3) for M \u003e 0.5 M☉\n        \"\"\"\n        mass = np.asarray(mass)\n        \n        if self.imf_type == 'salpeter':\n            return mass**(-2.35)\n        \n        elif self.imf_type == 'kroupa':\n            # Broken power law\n            result = np.zeros_like(mass)\n            low_mass = mass \u003c 0.5\n            high_mass = mass \u003e= 0.5\n            \n            result[low_mass] = mass[low_mass]**(-1.3)\n            # Ensure continuity at M = 0.5\n            normalization = 0.5**(-1.3 + 2.3)\n            result[high_mass] = normalization * mass[high_mass]**(-2.3)\n            \n            return result\n        \n        elif self.imf_type == 'chabrier':\n            # Log-normal for low masses + power law for high masses\n            # Implementation left as advanced exercise\n            pass\n    \n    def cdf(self, mass):\n        \"\"\"Cumulative distribution function.\"\"\"\n        # Analytical when possible, numerical integration otherwise\n        if self.imf_type == 'salpeter':\n            # CDF ∝ M^(-1.35)\n            return (mass**(-1.35) - self.m_min**(-1.35)) / \\\n                   (self.m_max**(-1.35) - self.m_min**(-1.35))\n    \n    def sample_rejection(self, n_stars):\n        \"\"\"Sample using rejection method.\"\"\"\n        masses = []\n        max_pdf = self.pdf(self.m_min)  # Maximum of PDF\n        \n        while len(masses) \u003c n_stars:\n            # Propose random mass in range\n            m_proposal = self.m_min + (self.m_max - self.m_min) * np.random.random()\n            \n            # Accept with probability proportional to PDF\n            if np.random.random() \u003c self.pdf(m_proposal) / max_pdf:\n                masses.append(m_proposal)\n        \n        return np.array(masses)\n    \n    def sample_inverse_transform(self, n_stars):\n        \"\"\"Sample using inverse CDF (when available).\"\"\"\n        if self.imf_type == 'salpeter':\n            u = np.random.random(n_stars)\n            # Invert CDF analytically\n            return (self.m_min**(-1.35) + u * (self.m_max**(-1.35) - self.m_min**(-1.35)))**(-1/1.35)\n        else:\n            # Fall back to rejection sampling\n            return self.sample_rejection(n_stars)\n    \n    def validate_distribution(self, masses, n_bins=50):\n        \"\"\"Compare sampled masses with theoretical IMF.\"\"\"\n        # Create histogram and compare with PDF\n        # Plot and calculate goodness-of-fit statistics\n        pass\n\ndef mass_to_stellar_properties(masses):\n    \"\"\"\n    Convert stellar masses to observable properties.\n    Uses Project 1 stellar physics relationships.\n    \"\"\"\n    # Mass-luminosity relation\n    luminosities = np.where(masses \u003e 1.0, \n                           masses**3.5,  # High mass: L ∝ M^3.5\n                           masses**4.0)  # Low mass: L ∝ M^4.0\n    \n    # Mass-temperature relation (main sequence)\n    temperatures = 5778 * (masses)**0.5  # Rough approximation\n    \n    # Mass-radius relation\n    radii = np.where(masses \u003e 1.0,\n                    masses**0.8,   # High mass\n                    masses**0.9)   # Low mass\n    \n    return {\n        'luminosities': luminosities,\n        'temperatures': temperatures,\n        'radii': radii\n    }","position":{"start":{"line":276,"column":1},"end":{"line":390,"column":1}},"key":"D0fLekwP0s"},{"type":"heading","depth":4,"position":{"start":{"line":392,"column":1},"end":{"line":392,"column":1}},"children":[{"type":"text","value":"Task 2: Plummer Sphere Spatial Distribution (45 min)","position":{"start":{"line":392,"column":1},"end":{"line":392,"column":1}},"key":"I3XBOT4d2p"}],"identifier":"task-2-plummer-sphere-spatial-distribution-45-min","label":"Task 2: Plummer Sphere Spatial Distribution (45 min)","html_id":"task-2-plummer-sphere-spatial-distribution-45-min","implicit":true,"key":"qqGLkKEbux"},{"type":"paragraph","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"children":[{"type":"strong","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"children":[{"type":"text","value":"Goal","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"key":"IFtDNyIVY7"}],"key":"Vefj1YdzHs"},{"type":"text","value":": Sample realistic 3D stellar cluster geometry","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"key":"ZZrjcQdm9d"}],"key":"sG0Ga3v2wo"},{"type":"paragraph","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"children":[{"type":"strong","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"children":[{"type":"text","value":"Plummer Model Implementation","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"NNz1wHrytn"}],"key":"ESJj2Nhncp"},{"type":"text","value":":","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"LnNAvlubXw"}],"key":"QHdjkA7Ms4"},{"type":"code","lang":"python","value":"class PlummerSphere:\n    \"\"\"\n    Plummer sphere model for stellar cluster spatial distribution.\n    \n    Density profile: ρ(r) = (3M/4πa³) * (1 + r²/a²)^(-5/2)\n    where a is the scale radius.\n    \"\"\"\n    \n    def __init__(self, total_mass=1000, scale_radius=1.0):\n        \"\"\"\n        Parameters:\n        -----------\n        total_mass : float\n            Total cluster mass [M☉]\n        scale_radius : float\n            Plummer scale radius [pc]\n        \"\"\"\n        self.M = total_mass\n        self.a = scale_radius\n    \n    def density(self, r):\n        \"\"\"Density at radius r.\"\"\"\n        return (3*self.M/(4*np.pi*self.a**3)) * (1 + (r/self.a)**2)**(-5/2)\n    \n    def mass_enclosed(self, r):\n        \"\"\"Mass within radius r.\"\"\"\n        return self.M * (r/self.a)**3 / (1 + (r/self.a)**2)**(3/2)\n    \n    def sample_radial_positions(self, n_stars):\n        \"\"\"\n        Sample radial distances using inverse CDF method.\n        \n        CDF: M(r)/M_total = (r/a)³ / (1 + (r/a)²)^(3/2)\n        Inverse: r = a / sqrt(u^(-2/3) - 1)\n        \"\"\"\n        u = np.random.random(n_stars)\n        # Prevent u=0 which gives infinite radius\n        u = np.clip(u, 1e-10, 1-1e-10)\n        \n        radii = self.a / np.sqrt(u**(-2/3) - 1)\n        return radii\n    \n    def sample_positions(self, n_stars):\n        \"\"\"Sample 3D positions from Plummer distribution.\"\"\"\n        radii = self.sample_radial_positions(n_stars)\n        \n        # Sample isotropic directions\n        cos_theta = 2*np.random.random(n_stars) - 1  # cos(θ) uniform in [-1,1]\n        phi = 2*np.pi*np.random.random(n_stars)      # φ uniform in [0,2π]\n        \n        sin_theta = np.sqrt(1 - cos_theta**2)\n        \n        # Convert to Cartesian coordinates\n        x = radii * sin_theta * np.cos(phi)\n        y = radii * sin_theta * np.sin(phi)\n        z = radii * cos_theta\n        \n        return np.column_stack([x, y, z])\n    \n    def calculate_virial_velocities(self, positions, masses):\n        \"\"\"\n        Calculate velocities for virial equilibrium.\n        \n        Uses virial theorem: 2T + U = 0 for bound system\n        where T = kinetic energy, U = potential energy\n        \"\"\"\n        n_stars = len(masses)\n        velocities = np.zeros_like(positions)\n        \n        # Calculate potential energy\n        U = 0\n        for i in range(n_stars):\n            for j in range(i+1, n_stars):\n                r_ij = np.linalg.norm(positions[i] - positions[j])\n                U -= G * masses[i] * masses[j] / r_ij\n        \n        # Virial theorem: total kinetic energy = -U/2\n        T_total = -U / 2\n        \n        # Distribute kinetic energy among particles\n        # Simple approach: assume isotropic velocity dispersion\n        for i in range(n_stars):\n            # Individual kinetic energy proportional to mass\n            T_i = T_total * masses[i] / np.sum(masses)\n            v_mag = np.sqrt(2 * T_i / masses[i])\n            \n            # Random direction\n            cos_theta = 2*np.random.random() - 1\n            phi = 2*np.pi*np.random.random()\n            sin_theta = np.sqrt(1 - cos_theta**2)\n            \n            velocities[i] = v_mag * np.array([\n                sin_theta * np.cos(phi),\n                sin_theta * np.sin(phi),\n                cos_theta\n            ])\n        \n        return velocities","position":{"start":{"line":396,"column":1},"end":{"line":495,"column":1}},"key":"FeHqWPgH4a"},{"type":"heading","depth":4,"position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"children":[{"type":"text","value":"Task 3: Vectorized N-Body Force Calculation (40 min)","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"key":"rQk2CJ0X4l"}],"identifier":"task-3-vectorized-n-body-force-calculation-40-min","label":"Task 3: Vectorized N-Body Force Calculation (40 min)","html_id":"task-3-vectorized-n-body-force-calculation-40-min","implicit":true,"key":"q6IcrEyAiN"},{"type":"paragraph","position":{"start":{"line":498,"column":1},"end":{"line":498,"column":1}},"children":[{"type":"strong","position":{"start":{"line":498,"column":1},"end":{"line":498,"column":1}},"children":[{"type":"text","value":"Goal","position":{"start":{"line":498,"column":1},"end":{"line":498,"column":1}},"key":"ydxvQj2B3D"}],"key":"kV5GCkjSy8"},{"type":"text","value":": Implement efficient O(N²) force computation","position":{"start":{"line":498,"column":1},"end":{"line":498,"column":1}},"key":"strGJR8nmy"}],"key":"w3yuHVV62i"},{"type":"paragraph","position":{"start":{"line":500,"column":1},"end":{"line":500,"column":1}},"children":[{"type":"strong","position":{"start":{"line":500,"column":1},"end":{"line":500,"column":1}},"children":[{"type":"text","value":"Vectorized Implementation","position":{"start":{"line":500,"column":1},"end":{"line":500,"column":1}},"key":"ZMJKcCrA6H"}],"key":"cnxqQXl2TY"},{"type":"text","value":":","position":{"start":{"line":500,"column":1},"end":{"line":500,"column":1}},"key":"aLEbeAQhBq"}],"key":"bztFZLV0oX"},{"type":"code","lang":"python","value":"def gravitational_forces_vectorized(positions, masses, softening=0.01):\n    \"\"\"\n    Calculate gravitational forces between all particle pairs.\n    \n    Parameters:\n    -----------\n    positions : array [N, 3]\n        Particle positions\n    masses : array [N]\n        Particle masses\n    softening : float\n        Softening parameter to avoid singularities\n        \n    Returns:\n    --------\n    forces : array [N, 3]\n        Gravitational forces on each particle\n    \"\"\"\n    N = len(masses)\n    G = 4.3e-3  # pc³/M☉/Myr² (convenient units)\n    \n    # Calculate all pairwise separations using broadcasting\n    # positions[i,j] - positions[k,j] for all i,k pairs\n    r_vectors = positions[:, np.newaxis, :] - positions[np.newaxis, :, :]  # [N, N, 3]\n    \n    # Distance magnitudes with softening\n    r_magnitudes = np.sqrt(np.sum(r_vectors**2, axis=2) + softening**2)  # [N, N]\n    \n    # Avoid self-interaction\n    np.fill_diagonal(r_magnitudes, np.inf)\n    \n    # Force magnitudes: F = G*m1*m2/r²\n    mass_products = masses[:, np.newaxis] * masses[np.newaxis, :]  # [N, N]\n    force_magnitudes = G * mass_products / r_magnitudes**2  # [N, N]\n    \n    # Force directions: unit vectors\n    r_unit = r_vectors / r_magnitudes[:, :, np.newaxis]  # [N, N, 3]\n    \n    # Total forces: sum over all other particles\n    forces = np.sum(force_magnitudes[:, :, np.newaxis] * r_unit, axis=1)  # [N, 3]\n    \n    return forces\n\ndef performance_comparison():\n    \"\"\"Compare vectorized vs nested loop implementations.\"\"\"\n    import time\n    \n    # Test different cluster sizes\n    N_values = [10, 50, 100, 200, 500]\n    \n    for N in N_values:\n        # Generate test data\n        positions = np.random.randn(N, 3)\n        masses = np.random.uniform(0.1, 10, N)\n        \n        # Time vectorized version\n        start = time.time()\n        forces_vec = gravitational_forces_vectorized(positions, masses)\n        time_vec = time.time() - start\n        \n        # Time nested loop version (for comparison)\n        start = time.time()\n        forces_loop = gravitational_forces_nested_loops(positions, masses)\n        time_loop = time.time() - start\n        \n        print(f\"N={N}: Vectorized={time_vec:.4f}s, Loops={time_loop:.4f}s, \"\n              f\"Speedup={time_loop/time_vec:.1f}x\")","position":{"start":{"line":501,"column":1},"end":{"line":569,"column":1}},"key":"kmtnNp24pm"},{"type":"paragraph","position":{"start":{"line":571,"column":1},"end":{"line":571,"column":1}},"children":[{"type":"strong","position":{"start":{"line":571,"column":1},"end":{"line":571,"column":1}},"children":[{"type":"text","value":"Week 2 Deliverable","position":{"start":{"line":571,"column":1},"end":{"line":571,"column":1}},"key":"po58lfU5YE"}],"key":"OXdmskTMEq"},{"type":"text","value":": Realistic stellar cluster initialization with IMF masses and Plummer positions, plus efficient force calculations","position":{"start":{"line":571,"column":1},"end":{"line":571,"column":1}},"key":"XtyaBFV1sG"}],"key":"dhpcpwDE6a"},{"type":"thematicBreak","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"key":"BxKqLDxBvn"},{"type":"heading","depth":2,"position":{"start":{"line":575,"column":1},"end":{"line":575,"column":1}},"children":[{"type":"text","value":"Week 3: Adaptive Timestepping and Cluster Evolution","position":{"start":{"line":575,"column":1},"end":{"line":575,"column":1}},"key":"KdiDRDcI3x"}],"identifier":"week-3-adaptive-timestepping-and-cluster-evolution","label":"Week 3: Adaptive Timestepping and Cluster Evolution","html_id":"week-3-adaptive-timestepping-and-cluster-evolution","implicit":true,"key":"FjMelBM3L5"},{"type":"heading","depth":3,"position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"children":[{"type":"text","value":"Conceptual Introduction (25 min)","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"key":"zf8bEBUofp"}],"identifier":"conceptual-introduction-25-min","label":"Conceptual Introduction (25 min)","html_id":"conceptual-introduction-25-min-2","implicit":true,"key":"r6oVNwv5SP"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":578,"column":1},"end":{"line":583,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":578,"column":1},"end":{"line":578,"column":1}},"children":[{"type":"text","value":"Energy conservation as accuracy criterion","position":{"start":{"line":578,"column":1},"end":{"line":578,"column":1}},"key":"LguRzcgIPi"}],"key":"VZSJxrNpQT"},{"type":"listItem","spread":true,"position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"children":[{"type":"text","value":"Adaptive timestep algorithms","position":{"start":{"line":579,"column":1},"end":{"line":579,"column":1}},"key":"ekiDdLjD6h"}],"key":"r4OoNVNw7e"},{"type":"listItem","spread":true,"position":{"start":{"line":580,"column":1},"end":{"line":580,"column":1}},"children":[{"type":"text","value":"Multi-mass cluster dynamics: mass segregation, two-body relaxation","position":{"start":{"line":580,"column":1},"end":{"line":580,"column":1}},"key":"KxP4OjlaGX"}],"key":"rXZV7OA2iV"},{"type":"listItem","spread":true,"position":{"start":{"line":581,"column":1},"end":{"line":581,"column":1}},"children":[{"type":"text","value":"Stellar escape and cluster dissolution","position":{"start":{"line":581,"column":1},"end":{"line":581,"column":1}},"key":"iAAVpRKNcH"}],"key":"apc3UOptpx"},{"type":"listItem","spread":true,"position":{"start":{"line":582,"column":1},"end":{"line":583,"column":1}},"children":[{"type":"text","value":"Computational complexity and optimization strategies","position":{"start":{"line":582,"column":1},"end":{"line":582,"column":1}},"key":"O0gcqdkYxv"}],"key":"pZ2ZWSV152"}],"key":"BAjZPOW11h"},{"type":"heading","depth":3,"position":{"start":{"line":584,"column":1},"end":{"line":584,"column":1}},"children":[{"type":"text","value":"Lab Session Objectives","position":{"start":{"line":584,"column":1},"end":{"line":584,"column":1}},"key":"PCmtRRynTZ"}],"identifier":"lab-session-objectives","label":"Lab Session Objectives","html_id":"lab-session-objectives-2","implicit":true,"key":"kflD2pHO1e"},{"type":"paragraph","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"children":[{"type":"text","value":"Implement energy-controlled adaptive integration and study realistic cluster evolution.","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"key":"Ma21HtR6Du"}],"key":"nkstfWzdvS"},{"type":"heading","depth":4,"position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"children":[{"type":"text","value":"Task 1: Adaptive Timestep Control (50 min)","position":{"start":{"line":587,"column":1},"end":{"line":587,"column":1}},"key":"Q4j08DNLVZ"}],"identifier":"task-1-adaptive-timestep-control-50-min","label":"Task 1: Adaptive Timestep Control (50 min)","html_id":"task-1-adaptive-timestep-control-50-min","implicit":true,"key":"f2lT1Soazi"},{"type":"paragraph","position":{"start":{"line":588,"column":1},"end":{"line":588,"column":1}},"children":[{"type":"strong","position":{"start":{"line":588,"column":1},"end":{"line":588,"column":1}},"children":[{"type":"text","value":"Goal","position":{"start":{"line":588,"column":1},"end":{"line":588,"column":1}},"key":"YORgiquuvC"}],"key":"RTdYzS4ZO1"},{"type":"text","value":": Implement robust adaptive timestep algorithm based on energy conservation","position":{"start":{"line":588,"column":1},"end":{"line":588,"column":1}},"key":"b1Squysepm"}],"key":"Rsfxzts1lz"},{"type":"paragraph","position":{"start":{"line":590,"column":1},"end":{"line":590,"column":1}},"children":[{"type":"strong","position":{"start":{"line":590,"column":1},"end":{"line":590,"column":1}},"children":[{"type":"text","value":"Adaptive Integration Framework","position":{"start":{"line":590,"column":1},"end":{"line":590,"column":1}},"key":"dY5HJPbioP"}],"key":"slL8zZeYJx"},{"type":"text","value":":","position":{"start":{"line":590,"column":1},"end":{"line":590,"column":1}},"key":"mAWOcRIwpX"}],"key":"XLtmv4CTdk"},{"type":"code","lang":"python","value":"class AdaptiveNBodySimulator:\n    \"\"\"\n    N-body simulator with adaptive timestep control.\n    \n    Uses energy conservation to monitor accuracy and adjust timestep.\n    \"\"\"\n    \n    def __init__(self, positions, velocities, masses, initial_dt=0.01, \n                 energy_tolerance=1e-6):\n        \"\"\"\n        Parameters:\n        -----------\n        positions : array [N, 3]\n            Initial positions [pc]\n        velocities : array [N, 3] \n            Initial velocities [km/s]\n        masses : array [N]\n            Particle masses [M☉]\n        initial_dt : float\n            Initial timestep [Myr]\n        energy_tolerance : float\n            Relative energy error tolerance\n        \"\"\"\n        self.positions = np.array(positions)\n        self.velocities = np.array(velocities) \n        self.masses = np.array(masses)\n        self.dt = initial_dt\n        self.tolerance = energy_tolerance\n        \n        # Calculate initial energy\n        self.initial_energy = self.total_energy()\n        \n        # Statistics tracking\n        self.n_accepted = 0\n        self.n_rejected = 0\n        self.energy_errors = []\n        self.timesteps = []\n        \n        # History storage\n        self.time = 0.0\n        self.history = {\n            'time': [0.0],\n            'positions': [self.positions.copy()],\n            'velocities': [self.velocities.copy()],\n            'energy': [self.initial_energy],\n            'timestep': [self.dt]\n        }\n    \n    def total_energy(self):\n        \"\"\"Calculate total energy: kinetic + potential.\"\"\"\n        # Kinetic energy\n        ke = 0.5 * np.sum(self.masses * np.sum(self.velocities**2, axis=1))\n        \n        # Potential energy\n        pe = 0\n        for i in range(len(self.masses)):\n            for j in range(i+1, len(self.masses)):\n                r_ij = np.linalg.norm(self.positions[i] - self.positions[j])\n                pe -= G * self.masses[i] * self.masses[j] / r_ij\n        \n        return ke + pe\n    \n    def energy_error(self):\n        \"\"\"Calculate relative energy error from initial value.\"\"\"\n        current_energy = self.total_energy()\n        return abs((current_energy - self.initial_energy) / self.initial_energy)\n    \n    def leapfrog_step(self, dt):\n        \"\"\"Take single leapfrog integration step.\"\"\"\n        # Store initial state for potential rollback\n        old_positions = self.positions.copy()\n        old_velocities = self.velocities.copy()\n        \n        # Leapfrog integration\n        forces = gravitational_forces_vectorized(self.positions, self.masses)\n        accelerations = forces / self.masses[:, np.newaxis]\n        \n        # Kick-drift-kick\n        self.velocities += 0.5 * dt * accelerations\n        self.positions += dt * self.velocities\n        \n        forces = gravitational_forces_vectorized(self.positions, self.masses)\n        accelerations = forces / self.masses[:, np.newaxis]\n        self.velocities += 0.5 * dt * accelerations\n        \n        return old_positions, old_velocities\n    \n    def adaptive_step(self):\n        \"\"\"\n        Take adaptive timestep with error control.\n        \n        Algorithm:\n        1. Attempt step with current timestep\n        2. Check energy conservation\n        3. If error too large: reduce timestep and retry\n        4. If error acceptable: possibly increase timestep for next step\n        \"\"\"\n        max_attempts = 5\n        \n        for attempt in range(max_attempts):\n            # Store state before step\n            old_positions, old_velocities = self.leapfrog_step(self.dt)\n            \n            # Check energy conservation\n            error = self.energy_error()\n            \n            if error \u003c= self.tolerance:\n                # Step accepted\n                self.time += self.dt\n                self.n_accepted += 1\n                \n                # Store results\n                self.history['time'].append(self.time)\n                self.history['positions'].append(self.positions.copy())\n                self.history['velocities'].append(self.velocities.copy())\n                self.history['energy'].append(self.total_energy())\n                self.history['timestep'].append(self.dt)\n                \n                self.energy_errors.append(error)\n                self.timesteps.append(self.dt)\n                \n                # Possibly increase timestep for next step\n                if error \u003c self.tolerance / 10:\n                    self.dt = min(self.dt * 1.1, 0.1)  # Don't let it grow too large\n                \n                return True\n            \n            else:\n                # Step rejected - restore state and reduce timestep\n                self.positions = old_positions\n                self.velocities = old_velocities\n                self.dt *= 0.5\n                self.n_rejected += 1\n                \n                if attempt == max_attempts - 1:\n                    print(f\"Warning: Max attempts reached at t={self.time:.3f}\")\n                    return False\n        \n        return False\n    \n    def evolve(self, t_final, max_steps=10000):\n        \"\"\"Evolve system to final time using adaptive timesteps.\"\"\"\n        step_count = 0\n        \n        while self.time \u003c t_final and step_count \u003c max_steps:\n            success = self.adaptive_step()\n            if not success:\n                print(\"Simulation failed - energy errors too large\")\n                break\n            \n            step_count += 1\n            \n            # Progress reporting\n            if step_count % 100 == 0:\n                acceptance_rate = self.n_accepted / (self.n_accepted + self.n_rejected)\n                print(f\"t={self.time:.2f}, dt={self.dt:.4f}, \"\n                      f\"E_error={self.energy_errors[-1]:.2e}, \"\n                      f\"acceptance={acceptance_rate:.2f}\")\n        \n        return self.get_results()\n    \n    def get_results(self):\n        \"\"\"Return simulation results as arrays.\"\"\"\n        return {\n            'time': np.array(self.history['time']),\n            'positions': np.array(self.history['positions']),\n            'velocities': np.array(self.history['velocities']),\n            'energy': np.array(self.history['energy']),\n            'timesteps': np.array(self.history['timestep'])\n        }","position":{"start":{"line":591,"column":1},"end":{"line":762,"column":1}},"key":"L3DQBGtDZT"},{"type":"heading","depth":4,"position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"children":[{"type":"text","value":"Task 2: Cluster Physics and Evolution (55 min)","position":{"start":{"line":764,"column":1},"end":{"line":764,"column":1}},"key":"UhjWM35j6W"}],"identifier":"task-2-cluster-physics-and-evolution-55-min","label":"Task 2: Cluster Physics and Evolution (55 min)","html_id":"task-2-cluster-physics-and-evolution-55-min","implicit":true,"key":"PHSGGNes6c"},{"type":"paragraph","position":{"start":{"line":765,"column":1},"end":{"line":765,"column":1}},"children":[{"type":"strong","position":{"start":{"line":765,"column":1},"end":{"line":765,"column":1}},"children":[{"type":"text","value":"Goal","position":{"start":{"line":765,"column":1},"end":{"line":765,"column":1}},"key":"BXkEproe6F"}],"key":"jlbTtgAM0f"},{"type":"text","value":": Study realistic stellar cluster evolution phenomena","position":{"start":{"line":765,"column":1},"end":{"line":765,"column":1}},"key":"pRwctxbBoG"}],"key":"TL5HyTJl7D"},{"type":"paragraph","position":{"start":{"line":767,"column":1},"end":{"line":767,"column":1}},"children":[{"type":"strong","position":{"start":{"line":767,"column":1},"end":{"line":767,"column":1}},"children":[{"type":"text","value":"Mass Segregation Analysis","position":{"start":{"line":767,"column":1},"end":{"line":767,"column":1}},"key":"qloXqhPptA"}],"key":"zSLdiSSNjN"},{"type":"text","value":":","position":{"start":{"line":767,"column":1},"end":{"line":767,"column":1}},"key":"bt0HT15yx2"}],"key":"krDIb8OkoF"},{"type":"code","lang":"python","value":"def analyze_mass_segregation(positions, masses, times):\n    \"\"\"\n    Track mass segregation: massive stars sink to cluster center.\n    \n    Quantify using mass-weighted radial distribution.\n    \"\"\"\n    segregation_ratios = []\n    \n    for i, pos in enumerate(positions):\n        # Calculate distance from cluster center\n        center = np.average(pos, weights=masses, axis=0)\n        distances = np.linalg.norm(pos - center, axis=1)\n        \n        # Sort by mass\n        mass_order = np.argsort(masses)[::-1]  # Heaviest first\n        \n        # Compare radial distribution of most vs least massive stars\n        n_heavy = len(masses) // 10  # Top 10%\n        n_light = len(masses) // 10  # Bottom 10%\n        \n        r_heavy = np.mean(distances[mass_order[:n_heavy]])\n        r_light = np.mean(distances[mass_order[-n_light:]])\n        \n        segregation_ratios.append(r_light / r_heavy)\n    \n    return segregation_ratios\n\ndef calculate_virial_ratio(positions, velocities, masses):\n    \"\"\"\n    Calculate virial ratio: 2T/|U|\n    \n    For bound system in equilibrium, should equal 1.\n    \"\"\"\n    # Kinetic energy\n    T = 0.5 * np.sum(masses * np.sum(velocities**2, axis=1))\n    \n    # Potential energy\n    U = 0\n    for i in range(len(masses)):\n        for j in range(i+1, len(masses)):\n            r_ij = np.linalg.norm(positions[i] - positions[j])\n            U -= G * masses[i] * masses[j] / r_ij\n    \n    return 2 * T / abs(U)\n\ndef identify_escaping_stars(positions, velocities, masses, escape_criterion=2.0):\n    \"\"\"\n    Identify stars with velocities exceeding escape velocity.\n    \n    v_escape = sqrt(2 * |U| / m) at each star's location\n    \"\"\"\n    escaping_stars = []\n    \n    for i in range(len(masses)):\n        # Calculate potential at star i due to all other stars\n        phi_i = 0\n        for j in range(len(masses)):\n            if i != j:\n                r_ij = np.linalg.norm(positions[i] - positions[j])\n                phi_i -= G * masses[j] / r_ij\n        \n        # Escape velocity at this location\n        v_escape = np.sqrt(-2 * phi_i)\n        v_star = np.linalg.norm(velocities[i])\n        \n        if v_star \u003e escape_criterion * v_escape:\n            escaping_stars.append(i)\n    \n    return escaping_stars","position":{"start":{"line":768,"column":1},"end":{"line":838,"column":1}},"key":"qHBCoOWt3D"},{"type":"paragraph","position":{"start":{"line":840,"column":1},"end":{"line":840,"column":1}},"children":[{"type":"strong","position":{"start":{"line":840,"column":1},"end":{"line":840,"column":1}},"children":[{"type":"text","value":"Cluster Snapshot Generation for Project 3","position":{"start":{"line":840,"column":1},"end":{"line":840,"column":1}},"key":"jAcZyxmYWE"}],"key":"fnudIrucnV"},{"type":"text","value":":","position":{"start":{"line":840,"column":1},"end":{"line":840,"column":1}},"key":"ZGSlvj1pYh"}],"key":"Ct9zYsP0lN"},{"type":"code","lang":"python","value":"def generate_cluster_snapshots(cluster_mass=1000, n_stars=200, \n                              evolution_times=[0, 5, 20, 50]):\n    \"\"\"\n    Generate stellar cluster at multiple evolutionary phases.\n    These snapshots will be used in Project 3 for radiation calculations.\n    \n    Parameters:\n    -----------\n    cluster_mass : float\n        Total cluster mass [M☉]\n    n_stars : int\n        Number of stars in cluster\n    evolution_times : list\n        Times to save snapshots [Myr]\n        \n    Returns:\n    --------\n    snapshots : list of dict\n        Each dict contains stellar properties at one time\n    \"\"\"\n    # Initialize cluster\n    imf = StellarIMF(imf_type='kroupa')\n    masses = imf.sample_inverse_transform(n_stars)\n    masses = masses * (cluster_mass / np.sum(masses))  # Normalize total mass\n    \n    plummer = PlummerSphere(total_mass=cluster_mass, scale_radius=1.0)\n    positions = plummer.sample_positions(n_stars)\n    velocities = plummer.calculate_virial_velocities(positions, masses)\n    \n    # Calculate stellar properties for radiation (from Project 1)\n    stellar_props = mass_to_stellar_properties(masses)\n    \n    # Set up adaptive simulator\n    simulator = AdaptiveNBodySimulator(\n        positions, velocities, masses,\n        initial_dt=0.01, energy_tolerance=1e-6\n    )\n    \n    snapshots = []\n    \n    for t_target in evolution_times:\n        if t_target == 0:\n            # Initial conditions\n            snapshot = create_snapshot(\n                time=0, \n                positions=simulator.positions,\n                velocities=simulator.velocities,\n                masses=masses,\n                stellar_props=stellar_props\n            )\n        else:\n            # Evolve to target time\n            results = simulator.evolve(t_target)\n            \n            # Extract final state\n            final_positions = results['positions'][-1]\n            final_velocities = results['velocities'][-1]\n            \n            snapshot = create_snapshot(\n                time=t_target,\n                positions=final_positions,\n                velocities=final_velocities,\n                masses=masses,\n                stellar_props=stellar_props\n            )\n        \n        snapshots.append(snapshot)\n        print(f\"Snapshot created at t = {t_target} Myr\")\n    \n    return snapshots\n\ndef create_snapshot(time, positions, velocities, masses, stellar_props):\n    \"\"\"Create comprehensive cluster snapshot.\"\"\"\n    # Calculate cluster center and properties\n    center = np.average(positions, weights=masses, axis=0)\n    centered_positions = positions - center\n    \n    # Structural parameters\n    distances = np.linalg.norm(centered_positions, axis=1)\n    half_mass_radius = np.median(distances)\n    \n    # Core radius (radius containing 10% of mass)\n    mass_order = np.argsort(distances)\n    core_mass_index = int(0.1 * len(masses))\n    core_radius = distances[mass_order[core_mass_index]]\n    \n    snapshot = {\n        'time': time,\n        'n_stars': len(masses),\n        'total_mass': np.sum(masses),\n        \n        # Stellar properties\n        'positions': centered_positions,  # Centered on cluster\n        'velocities': velocities,\n        'masses': masses,\n        'luminosities': stellar_props['luminosities'],\n        'temperatures': stellar_props['temperatures'],\n        'radii': stellar_props['radii'],\n        \n        # Cluster structure\n        'center': center,\n        'half_mass_radius': half_mass_radius,\n        'core_radius': core_radius,\n        'virial_ratio': calculate_virial_ratio(positions, velocities, masses),\n        \n        # Evolution diagnostics\n        'mass_segregation_ratio': analyze_mass_segregation([positions], masses, [time])[0],\n        'escaping_stars': identify_escaping_stars(positions, velocities, masses)\n    }\n    \n    return snapshot\n\ndef save_snapshots_for_project3(snapshots, filename='cluster_evolution.pkl'):\n    \"\"\"Save snapshots in format suitable for Project 3.\"\"\"\n    import pickle\n    \n    with open(filename, 'wb') as f:\n        pickle.dump(snapshots, f)\n    \n    print(f\"Saved {len(snapshots)} cluster snapshots to {filename}\")\n    print(\"These will be used as radiation sources in Project 3\")","position":{"start":{"line":841,"column":1},"end":{"line":963,"column":1}},"key":"A7ENWgQP43"},{"type":"heading","depth":4,"position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"children":[{"type":"text","value":"Task 3: Performance Analysis and Optimization (30 min)","position":{"start":{"line":965,"column":1},"end":{"line":965,"column":1}},"key":"pFILEanN3N"}],"identifier":"task-3-performance-analysis-and-optimization-30-min","label":"Task 3: Performance Analysis and Optimization (30 min)","html_id":"task-3-performance-analysis-and-optimization-30-min","implicit":true,"key":"tcwDK9swv3"},{"type":"paragraph","position":{"start":{"line":966,"column":1},"end":{"line":966,"column":1}},"children":[{"type":"strong","position":{"start":{"line":966,"column":1},"end":{"line":966,"column":1}},"children":[{"type":"text","value":"Goal","position":{"start":{"line":966,"column":1},"end":{"line":966,"column":1}},"key":"jFhlVSs3cz"}],"key":"etODD4Nfav"},{"type":"text","value":": Analyze computational efficiency and identify optimization opportunities","position":{"start":{"line":966,"column":1},"end":{"line":966,"column":1}},"key":"DCkUlso41V"}],"key":"G7XdQDwp59"},{"type":"paragraph","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"children":[{"type":"strong","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"children":[{"type":"text","value":"Performance Studies","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"key":"z813KZGsix"}],"key":"YKa2kCPpVp"},{"type":"text","value":":","position":{"start":{"line":968,"column":1},"end":{"line":968,"column":1}},"key":"ITwB1jtyrN"}],"key":"naAo46MZ6W"},{"type":"code","lang":"python","value":"def scaling_analysis():\n    \"\"\"Study how computational cost scales with cluster size.\"\"\"\n    import time\n    \n    N_values = [50, 100, 200, 400]\n    times_force = []\n    times_integration = []\n    \n    for N in N_values:\n        # Generate test cluster\n        masses = np.random.uniform(0.1, 10, N)\n        positions = np.random.randn(N, 3)\n        velocities = np.random.randn(N, 3)\n        \n        # Time force calculation\n        start = time.time()\n        for _ in range(10):  # Multiple iterations for averaging\n            forces = gravitational_forces_vectorized(positions, masses)\n        times_force.append((time.time() - start) / 10)\n        \n        # Time full integration step\n        simulator = AdaptiveNBodySimulator(positions, velocities, masses)\n        start = time.time()\n        for _ in range(10):\n            simulator.adaptive_step()\n        times_integration.append((time.time() - start) / 10)\n    \n    # Analyze scaling: should be O(N²) for force calculation\n    print(\"Scaling Analysis:\")\n    for i, N in enumerate(N_values):\n        print(f\"N={N}: Force={times_force[i]:.4f}s, Integration={times_integration[i]:.4f}s\")\n\ndef memory_optimization_analysis():\n    \"\"\"Analyze memory usage and suggest optimizations.\"\"\"\n    # Profile memory usage during simulation\n    # Identify opportunities for optimization\n    pass","position":{"start":{"line":969,"column":1},"end":{"line":1007,"column":1}},"key":"Sqk0sPBzY7"},{"type":"paragraph","position":{"start":{"line":1009,"column":1},"end":{"line":1009,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1009,"column":1},"end":{"line":1009,"column":1}},"children":[{"type":"text","value":"Week 3 Deliverable","position":{"start":{"line":1009,"column":1},"end":{"line":1009,"column":1}},"key":"vQcqMNQB67"}],"key":"bJ4ykMHjR5"},{"type":"text","value":": Complete adaptive N-body simulator with realistic cluster evolution and snapshots for Project 3","position":{"start":{"line":1009,"column":1},"end":{"line":1009,"column":1}},"key":"OF8AACgZxl"}],"key":"MbgfDc9qwB"},{"type":"thematicBreak","position":{"start":{"line":1011,"column":1},"end":{"line":1011,"column":1}},"key":"hZ9pRsXfG2"},{"type":"heading","depth":2,"position":{"start":{"line":1013,"column":1},"end":{"line":1013,"column":1}},"children":[{"type":"text","value":"Assessment and Grading","position":{"start":{"line":1013,"column":1},"end":{"line":1013,"column":1}},"key":"Oo2v1TDtPz"}],"identifier":"assessment-and-grading","label":"Assessment and Grading","html_id":"assessment-and-grading","implicit":true,"key":"juBjwU3ZJM"},{"type":"heading","depth":3,"position":{"start":{"line":1015,"column":1},"end":{"line":1015,"column":1}},"children":[{"type":"text","value":"Grading Breakdown","position":{"start":{"line":1015,"column":1},"end":{"line":1015,"column":1}},"key":"ixQKPQSboS"}],"identifier":"grading-breakdown","label":"Grading Breakdown","html_id":"grading-breakdown","implicit":true,"key":"tIDblasDRM"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1016,"column":1},"end":{"line":1019,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1016,"column":1},"end":{"line":1016,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1016,"column":1},"end":{"line":1016,"column":1}},"children":[{"type":"text","value":"Week 1","position":{"start":{"line":1016,"column":1},"end":{"line":1016,"column":1}},"key":"QAeCI8iFzH"}],"key":"HHP9iWO7k2"},{"type":"text","value":": ODE solvers and validation (30%)","position":{"start":{"line":1016,"column":1},"end":{"line":1016,"column":1}},"key":"bdSH32oV4B"}],"key":"HO1JkETqfr"},{"type":"listItem","spread":true,"position":{"start":{"line":1017,"column":1},"end":{"line":1017,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1017,"column":1},"end":{"line":1017,"column":1}},"children":[{"type":"text","value":"Week 2","position":{"start":{"line":1017,"column":1},"end":{"line":1017,"column":1}},"key":"jVzju6l7E3"}],"key":"BoROOh2ihM"},{"type":"text","value":": Statistical sampling and vectorization (35%)","position":{"start":{"line":1017,"column":1},"end":{"line":1017,"column":1}},"key":"f1FJWiZKK3"}],"key":"j8NMlDCYWD"},{"type":"listItem","spread":true,"position":{"start":{"line":1018,"column":1},"end":{"line":1019,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1018,"column":1},"end":{"line":1018,"column":1}},"children":[{"type":"text","value":"Week 3","position":{"start":{"line":1018,"column":1},"end":{"line":1018,"column":1}},"key":"BiNY1bhnUy"}],"key":"JPt9jHaYuD"},{"type":"text","value":": Adaptive methods and cluster evolution (35%)","position":{"start":{"line":1018,"column":1},"end":{"line":1018,"column":1}},"key":"oktm82Vtby"}],"key":"nU4wTx51vf"}],"key":"QdJi1Z79Ge"},{"type":"heading","depth":3,"position":{"start":{"line":1020,"column":1},"end":{"line":1020,"column":1}},"children":[{"type":"text","value":"Evaluation Criteria","position":{"start":{"line":1020,"column":1},"end":{"line":1020,"column":1}},"key":"wflmPMQjj5"}],"identifier":"evaluation-criteria","label":"Evaluation Criteria","html_id":"evaluation-criteria","implicit":true,"key":"Ap0DrK3Bc5"},{"type":"heading","depth":4,"position":{"start":{"line":1022,"column":1},"end":{"line":1022,"column":1}},"children":[{"type":"text","value":"Technical Implementation (60%)","position":{"start":{"line":1022,"column":1},"end":{"line":1022,"column":1}},"key":"qsod1VtUAu"}],"identifier":"technical-implementation-60","label":"Technical Implementation (60%)","html_id":"technical-implementation-60","implicit":true,"key":"eOVVHdHxN0"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1023,"column":1},"end":{"line":1027,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1023,"column":1},"end":{"line":1023,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1023,"column":1},"end":{"line":1023,"column":1}},"children":[{"type":"text","value":"Algorithm Correctness","position":{"start":{"line":1023,"column":1},"end":{"line":1023,"column":1}},"key":"Xm1ZN702TP"}],"key":"vXSlTUs9IA"},{"type":"text","value":": Do integrators conserve energy appropriately?","position":{"start":{"line":1023,"column":1},"end":{"line":1023,"column":1}},"key":"XXWKX9HFBN"}],"key":"y2VKnY8OS6"},{"type":"listItem","spread":true,"position":{"start":{"line":1024,"column":1},"end":{"line":1024,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1024,"column":1},"end":{"line":1024,"column":1}},"children":[{"type":"text","value":"Sampling Accuracy","position":{"start":{"line":1024,"column":1},"end":{"line":1024,"column":1}},"key":"M2LajwiYh6"}],"key":"gZwcLH02gg"},{"type":"text","value":": Do distributions match theoretical expectations?","position":{"start":{"line":1024,"column":1},"end":{"line":1024,"column":1}},"key":"ZMcItjCszS"}],"key":"qbfvH8rNVy"},{"type":"listItem","spread":true,"position":{"start":{"line":1025,"column":1},"end":{"line":1025,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1025,"column":1},"end":{"line":1025,"column":1}},"children":[{"type":"text","value":"Vectorization Efficiency","position":{"start":{"line":1025,"column":1},"end":{"line":1025,"column":1}},"key":"zbOnQV98be"}],"key":"Xb6lc3UQG3"},{"type":"text","value":": Significant speedup over naive implementations","position":{"start":{"line":1025,"column":1},"end":{"line":1025,"column":1}},"key":"UMRhQlRqiv"}],"key":"NoXZCfto8x"},{"type":"listItem","spread":true,"position":{"start":{"line":1026,"column":1},"end":{"line":1027,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1026,"column":1},"end":{"line":1026,"column":1}},"children":[{"type":"text","value":"Adaptive Control","position":{"start":{"line":1026,"column":1},"end":{"line":1026,"column":1}},"key":"QgOgKHs1g7"}],"key":"WoRAGFVLMA"},{"type":"text","value":": Proper timestep adjustment based on energy errors","position":{"start":{"line":1026,"column":1},"end":{"line":1026,"column":1}},"key":"GfSrIQ1qJc"}],"key":"cVeNP8vvhb"}],"key":"pbVMcDGg72"},{"type":"heading","depth":4,"position":{"start":{"line":1028,"column":1},"end":{"line":1028,"column":1}},"children":[{"type":"text","value":"Scientific Understanding (25%)","position":{"start":{"line":1028,"column":1},"end":{"line":1028,"column":1}},"key":"Hrp5vUhPxk"}],"identifier":"scientific-understanding-25","label":"Scientific Understanding (25%)","html_id":"scientific-understanding-25","implicit":true,"key":"D53jhd8TTr"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1029,"column":1},"end":{"line":1032,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1029,"column":1},"end":{"line":1029,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1029,"column":1},"end":{"line":1029,"column":1}},"children":[{"type":"text","value":"Physics Validation","position":{"start":{"line":1029,"column":1},"end":{"line":1029,"column":1}},"key":"SbHuK1EIBY"}],"key":"aEX7TRt1yd"},{"type":"text","value":": Energy conservation, virial equilibrium, orbital mechanics","position":{"start":{"line":1029,"column":1},"end":{"line":1029,"column":1}},"key":"BZ4tvkBHMu"}],"key":"f4K0UcevUP"},{"type":"listItem","spread":true,"position":{"start":{"line":1030,"column":1},"end":{"line":1030,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1030,"column":1},"end":{"line":1030,"column":1}},"children":[{"type":"text","value":"Statistical Analysis","position":{"start":{"line":1030,"column":1},"end":{"line":1030,"column":1}},"key":"xl0XTR0UB0"}],"key":"lCJhNsegII"},{"type":"text","value":": IMF and spatial distribution validation","position":{"start":{"line":1030,"column":1},"end":{"line":1030,"column":1}},"key":"njFcZzgiEB"}],"key":"CPNletyktg"},{"type":"listItem","spread":true,"position":{"start":{"line":1031,"column":1},"end":{"line":1032,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1031,"column":1},"end":{"line":1031,"column":1}},"children":[{"type":"text","value":"Cluster Evolution","position":{"start":{"line":1031,"column":1},"end":{"line":1031,"column":1}},"key":"u28LbXfyqt"}],"key":"YxGR47TRhy"},{"type":"text","value":": Understanding of mass segregation and stellar escape","position":{"start":{"line":1031,"column":1},"end":{"line":1031,"column":1}},"key":"pQPDQp2Dba"}],"key":"CN2PgxBAY2"}],"key":"fDsRJ3IILs"},{"type":"heading","depth":4,"position":{"start":{"line":1033,"column":1},"end":{"line":1033,"column":1}},"children":[{"type":"text","value":"Code Quality and Performance (15%)","position":{"start":{"line":1033,"column":1},"end":{"line":1033,"column":1}},"key":"DPTsuBY2AM"}],"identifier":"code-quality-and-performance-15","label":"Code Quality and Performance (15%)","html_id":"code-quality-and-performance-15","implicit":true,"key":"DiNGAa356U"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1034,"column":1},"end":{"line":1038,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1034,"column":1},"end":{"line":1034,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1034,"column":1},"end":{"line":1034,"column":1}},"children":[{"type":"text","value":"Documentation","position":{"start":{"line":1034,"column":1},"end":{"line":1034,"column":1}},"key":"sanHnoENBs"}],"key":"H32GOpkcV8"},{"type":"text","value":": Clear docstrings and code organization","position":{"start":{"line":1034,"column":1},"end":{"line":1034,"column":1}},"key":"lHwnWVXbJ0"}],"key":"BtLj2jRWNr"},{"type":"listItem","spread":true,"position":{"start":{"line":1035,"column":1},"end":{"line":1035,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1035,"column":1},"end":{"line":1035,"column":1}},"children":[{"type":"text","value":"Testing","position":{"start":{"line":1035,"column":1},"end":{"line":1035,"column":1}},"key":"xyQjHDvj52"}],"key":"ZYQ6V9bTkb"},{"type":"text","value":": Validation against analytical solutions","position":{"start":{"line":1035,"column":1},"end":{"line":1035,"column":1}},"key":"vJflsX3xMG"}],"key":"I53kcaw8Sd"},{"type":"listItem","spread":true,"position":{"start":{"line":1036,"column":1},"end":{"line":1036,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1036,"column":1},"end":{"line":1036,"column":1}},"children":[{"type":"text","value":"Optimization","position":{"start":{"line":1036,"column":1},"end":{"line":1036,"column":1}},"key":"a6i5Suknbb"}],"key":"PitxpsJlrM"},{"type":"text","value":": Efficient use of NumPy vectorization","position":{"start":{"line":1036,"column":1},"end":{"line":1036,"column":1}},"key":"yDYoiLEXk1"}],"key":"IJexzYyCHm"},{"type":"listItem","spread":true,"position":{"start":{"line":1037,"column":1},"end":{"line":1038,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1037,"column":1},"end":{"line":1037,"column":1}},"children":[{"type":"text","value":"Reproducibility","position":{"start":{"line":1037,"column":1},"end":{"line":1037,"column":1}},"key":"V179d5A3MV"}],"key":"td4aCBBK0d"},{"type":"text","value":": Proper random seed handling","position":{"start":{"line":1037,"column":1},"end":{"line":1037,"column":1}},"key":"RC4Ly047zM"}],"key":"gwrQzIPJE3"}],"key":"xhjgDPaLP7"},{"type":"heading","depth":3,"position":{"start":{"line":1039,"column":1},"end":{"line":1039,"column":1}},"children":[{"type":"text","value":"Connection to Project 3","position":{"start":{"line":1039,"column":1},"end":{"line":1039,"column":1}},"key":"BtpfdAPhpf"}],"identifier":"connection-to-project-3","label":"Connection to Project 3","html_id":"connection-to-project-3","implicit":true,"key":"Sarmv0Z94H"},{"type":"paragraph","position":{"start":{"line":1041,"column":1},"end":{"line":1041,"column":1}},"children":[{"type":"text","value":"The stellar cluster snapshots generated in this project become the radiation sources for Project 3:","position":{"start":{"line":1041,"column":1},"end":{"line":1041,"column":1}},"key":"xITO2yYAKl"}],"key":"x18tpKP3AE"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1042,"column":1},"end":{"line":1046,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1042,"column":1},"end":{"line":1042,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1042,"column":1},"end":{"line":1042,"column":1}},"children":[{"type":"text","value":"Stellar positions","position":{"start":{"line":1042,"column":1},"end":{"line":1042,"column":1}},"key":"DHdaAmqgNd"}],"key":"qroAp4BW8X"},{"type":"text","value":": Spatial distribution for radiation field calculations","position":{"start":{"line":1042,"column":1},"end":{"line":1042,"column":1}},"key":"EF7I44FSsP"}],"key":"GVthgBVaaW"},{"type":"listItem","spread":true,"position":{"start":{"line":1043,"column":1},"end":{"line":1043,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1043,"column":1},"end":{"line":1043,"column":1}},"children":[{"type":"text","value":"Stellar masses and luminosities","position":{"start":{"line":1043,"column":1},"end":{"line":1043,"column":1}},"key":"zUMOy1G3TQ"}],"key":"m9HOVEtX2W"},{"type":"text","value":": Heating source strengths","position":{"start":{"line":1043,"column":1},"end":{"line":1043,"column":1}},"key":"QIwf63KatO"}],"key":"Li88qtUYl2"},{"type":"listItem","spread":true,"position":{"start":{"line":1044,"column":1},"end":{"line":1044,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1044,"column":1},"end":{"line":1044,"column":1}},"children":[{"type":"text","value":"Cluster evolution","position":{"start":{"line":1044,"column":1},"end":{"line":1044,"column":1}},"key":"fEnPdKPV6s"}],"key":"qgSf5DnLIr"},{"type":"text","value":": How radiation field changes with time","position":{"start":{"line":1044,"column":1},"end":{"line":1044,"column":1}},"key":"ACUnc3N8lP"}],"key":"UuWIqz63Oj"},{"type":"listItem","spread":true,"position":{"start":{"line":1045,"column":1},"end":{"line":1046,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1045,"column":1},"end":{"line":1045,"column":1}},"children":[{"type":"text","value":"Realistic populations","position":{"start":{"line":1045,"column":1},"end":{"line":1045,"column":1}},"key":"CFKaMi3fju"}],"key":"XLVbR2MvRB"},{"type":"text","value":": IMF-sampled masses give proper luminosity functions","position":{"start":{"line":1045,"column":1},"end":{"line":1045,"column":1}},"key":"FuTGDXJy8d"}],"key":"QRZntjXUSA"}],"key":"gm27aVvGVN"},{"type":"heading","depth":3,"position":{"start":{"line":1047,"column":1},"end":{"line":1047,"column":1}},"children":[{"type":"text","value":"Deliverables","position":{"start":{"line":1047,"column":1},"end":{"line":1047,"column":1}},"key":"fMsv9NB4qP"}],"identifier":"deliverables","label":"Deliverables","html_id":"deliverables","implicit":true,"key":"XsxIa8zwUX"},{"type":"heading","depth":4,"position":{"start":{"line":1049,"column":1},"end":{"line":1049,"column":1}},"children":[{"type":"text","value":"Final Submission","position":{"start":{"line":1049,"column":1},"end":{"line":1049,"column":1}},"key":"ERZQiv7zfo"}],"identifier":"final-submission","label":"Final Submission","html_id":"final-submission","implicit":true,"key":"TqiEfh1mr9"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":1050,"column":1},"end":{"line":1064,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1050,"column":1},"end":{"line":1055,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1050,"column":1},"end":{"line":1050,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1050,"column":1},"end":{"line":1050,"column":1}},"children":[{"type":"text","value":"N-Body Simulation Library","position":{"start":{"line":1050,"column":1},"end":{"line":1050,"column":1}},"key":"vyW1awjQhM"}],"key":"WtnB3orgtv"},{"type":"text","value":":","position":{"start":{"line":1050,"column":1},"end":{"line":1050,"column":1}},"key":"kKnFBnzzfq"}],"key":"JPqkECFdGV"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1051,"column":1},"end":{"line":1055,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1051,"column":1},"end":{"line":1051,"column":1}},"children":[{"type":"inlineCode","value":"ode_solvers.py","position":{"start":{"line":1051,"column":1},"end":{"line":1051,"column":1}},"key":"W7tTw18nYl"},{"type":"text","value":": Integration method implementations","position":{"start":{"line":1051,"column":1},"end":{"line":1051,"column":1}},"key":"gIyZQ8UL2l"}],"key":"CdGrxDVtpi"},{"type":"listItem","spread":true,"position":{"start":{"line":1052,"column":1},"end":{"line":1052,"column":1}},"children":[{"type":"inlineCode","value":"stellar_sampling.py","position":{"start":{"line":1052,"column":1},"end":{"line":1052,"column":1}},"key":"F9LgjIIhQk"},{"type":"text","value":": IMF and Plummer sphere classes","position":{"start":{"line":1052,"column":1},"end":{"line":1052,"column":1}},"key":"gxSjGBx509"}],"key":"A1pIvlg78n"},{"type":"listItem","spread":true,"position":{"start":{"line":1053,"column":1},"end":{"line":1053,"column":1}},"children":[{"type":"inlineCode","value":"nbody_simulator.py","position":{"start":{"line":1053,"column":1},"end":{"line":1053,"column":1}},"key":"z6FkUIqnwj"},{"type":"text","value":": Complete adaptive N-body framework","position":{"start":{"line":1053,"column":1},"end":{"line":1053,"column":1}},"key":"AoGWFpo6f2"}],"key":"JI8nYq0yHw"},{"type":"listItem","spread":true,"position":{"start":{"line":1054,"column":1},"end":{"line":1055,"column":1}},"children":[{"type":"inlineCode","value":"cluster_analysis.py","position":{"start":{"line":1054,"column":1},"end":{"line":1054,"column":1}},"key":"RAfZ4Gtpj7"},{"type":"text","value":": Evolution analysis tools","position":{"start":{"line":1054,"column":1},"end":{"line":1054,"column":1}},"key":"AJmivhsUN9"}],"key":"YEEocY9KOi"}],"key":"S5LKkb5sc5"}],"key":"Z1AmvU2BuW"},{"type":"listItem","spread":true,"position":{"start":{"line":1056,"column":1},"end":{"line":1060,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1056,"column":1},"end":{"line":1056,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1056,"column":1},"end":{"line":1056,"column":1}},"children":[{"type":"text","value":"Validation Notebooks","position":{"start":{"line":1056,"column":1},"end":{"line":1056,"column":1}},"key":"S2qnQIaTqg"}],"key":"QfgCodaHLG"},{"type":"text","value":":","position":{"start":{"line":1056,"column":1},"end":{"line":1056,"column":1}},"key":"J1fGWBka2R"}],"key":"aHL9sp9mOw"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1057,"column":1},"end":{"line":1060,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1057,"column":1},"end":{"line":1057,"column":1}},"children":[{"type":"inlineCode","value":"orbital_mechanics_validation.ipynb","position":{"start":{"line":1057,"column":1},"end":{"line":1057,"column":1}},"key":"h607OPQ3Cr"},{"type":"text","value":": Two-body problem tests","position":{"start":{"line":1057,"column":1},"end":{"line":1057,"column":1}},"key":"AEy4bVHr3R"}],"key":"G1wIq1RXuR"},{"type":"listItem","spread":true,"position":{"start":{"line":1058,"column":1},"end":{"line":1058,"column":1}},"children":[{"type":"inlineCode","value":"sampling_validation.ipynb","position":{"start":{"line":1058,"column":1},"end":{"line":1058,"column":1}},"key":"ZPiVIyvdy4"},{"type":"text","value":": IMF and spatial distribution verification","position":{"start":{"line":1058,"column":1},"end":{"line":1058,"column":1}},"key":"lpxQw9o1cm"}],"key":"asU7OqCGQd"},{"type":"listItem","spread":true,"position":{"start":{"line":1059,"column":1},"end":{"line":1060,"column":1}},"children":[{"type":"inlineCode","value":"cluster_evolution_analysis.ipynb","position":{"start":{"line":1059,"column":1},"end":{"line":1059,"column":1}},"key":"JWxIhxceGr"},{"type":"text","value":": Mass segregation and dynamics","position":{"start":{"line":1059,"column":1},"end":{"line":1059,"column":1}},"key":"DFCtZDUTGS"}],"key":"qnszFAPgas"}],"key":"rnxT6X1Dyy"}],"key":"aX27un3EAk"},{"type":"listItem","spread":true,"position":{"start":{"line":1061,"column":1},"end":{"line":1064,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":1061,"column":1},"end":{"line":1061,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1061,"column":1},"end":{"line":1061,"column":1}},"children":[{"type":"text","value":"Project 3 Interface","position":{"start":{"line":1061,"column":1},"end":{"line":1061,"column":1}},"key":"mwNFwT9feg"}],"key":"AAfgNKGXyA"},{"type":"text","value":":","position":{"start":{"line":1061,"column":1},"end":{"line":1061,"column":1}},"key":"bfftLpzJRD"}],"key":"NWxbSmQLdb"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1062,"column":1},"end":{"line":1064,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1062,"column":1},"end":{"line":1062,"column":1}},"children":[{"type":"inlineCode","value":"cluster_snapshots.pkl","position":{"start":{"line":1062,"column":1},"end":{"line":1062,"column":1}},"key":"LNPxuClfjY"},{"type":"text","value":": Saved stellar cluster evolution data","position":{"start":{"line":1062,"column":1},"end":{"line":1062,"column":1}},"key":"C3iP5Hl2uk"}],"key":"xbzqeMma9F"},{"type":"listItem","spread":true,"position":{"start":{"line":1063,"column":1},"end":{"line":1064,"column":1}},"children":[{"type":"inlineCode","value":"snapshot_format.md","position":{"start":{"line":1063,"column":1},"end":{"line":1063,"column":1}},"key":"sUGBw5TKt9"},{"type":"text","value":": Documentation of data structure","position":{"start":{"line":1063,"column":1},"end":{"line":1063,"column":1}},"key":"HDzjH3Jo8f"}],"key":"PE0bhXr1sA"}],"key":"k9SJFjhTA3"}],"key":"ysD4dC83cM"}],"key":"eKZFNm7SBw"},{"type":"paragraph","position":{"start":{"line":1065,"column":1},"end":{"line":1065,"column":1}},"children":[{"type":"text","value":"This project establishes the realistic stellar systems needed for sophisticated radiation calculations while teaching essential computational physics skills: numerical integration, statistical sampling, vectorization, and adaptive methods.","position":{"start":{"line":1065,"column":1},"end":{"line":1065,"column":1}},"key":"PGrEr6cwNg"}],"key":"YwsMN65kmn"}],"key":"IiFBqZ2Qcu"}],"key":"Ak31XK8brg"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"ASTR 596 Project 1: Python Fundamentals + Numerical Analysis + Stellar Physics","url":"/project1-description","group":"Short Projects"},"next":{"title":"ASTR 596 Project 3: Monte Carlo Radiative Transfer + MCMC + Bayesian Statistics","url":"/project3-description","group":"Short Projects"}}},"domain":"http://localhost:3001"},"project":{"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"MIT","url":"https://opensource.org/licenses/MIT","name":"MIT License","free":true,"osi":true}},"subject":"Modeling the Universe","title":"ASTR 596: Modeling the Universe","description":"Graduate-level computational astrophysics course emphasizing glass-box modeling and modern computational frameworks","authors":[{"nameParsed":{"literal":"Anna Rosen","given":"Anna","family":"Rosen"},"name":"Anna Rosen","orcid":"0000-0003-4423-0660","email":"alrosen@sdsu.edu","affiliations":["San Diego State University"],"id":"contributors-myst-generated-uid-0","corresponding":true}],"venue":{"title":"ASTR 596 - Fall 2025","url":"https://www.anna-rosen.com"},"github":"https://github.com/astrobytes-edu/astr596-modeling-universe","keywords":["computational astrophysics","python","numerical methods","machine learning","monte carlo","neural networks","radiative transfer","bayesian inference","JAX"],"affiliations":[{"id":"San Diego State University","name":"San Diego State University"}],"id":"76c4875f-ba4c-4a35-bc58-52304ee2705e","thebe":{"kernelName":"python3"},"exports":[],"bibliography":[],"index":"index","pages":[{"title":"Course Info","level":1},{"slug":"syllabus","title":"Syllabus - ASTR 596: Modeling the Universe","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"schedule","title":"Course Schedule \u0026 Important Dates","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"ai-guidelines-final","title":"ASTR 596 AI Policy \u0026 Learning Framework","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"learning-guide-final","title":"Troubleshooting \u0026 Learning Guide","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"course-overview-final","title":"Understanding Your Learning Journey in ASTR 596","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"why-different-final","title":"Why ASTR 596 is Designed This Way","description":"","date":"","thumbnail":"/build/growth-mindset-f09d688b3b9e3cf1880effa6bda2802e.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Getting Started","level":1},{"slug":"software-setup-guide-orig","title":"Software Setup Guide","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"git-intro-guide-orig","title":"Introduction to Git and GitHub","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"cli-intro-guide-orig","title":"Introduction to the Command Line Interface (CLI)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Python","level":1},{"title":"Python Fundamentals","level":2},{"slug":"python-enrivonment-revised","title":"Chapter 1: Computational Environments \u0026 Scientific Workflows","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"python-calculator-orig","title":"Chapter 2: Python as a Calculator \u0026 Basic Data Types","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"python-control-flow-orig","title":"Chapter 3: Control Flow \u0026 Logic","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"python-data-structures-orig","title":"Chapter 4: Data Structures","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"python-functions-modules-orig","title":"Chapter 5: Functions \u0026 Modules - Building Reusable Scientific Code","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"python-oop-orig","title":"Chapter 6: Object-Oriented Programming - Organizing Scientific Code","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Scientific Computing Core","level":2},{"slug":"python-numpy-scientific-orig","title":"Chapter 7: NumPy - The Foundation of Scientific Computing","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"python-matplotlib-scientific-orig","title":"Chapter 8: Matplotlib - Creating Publication-Quality Scientific Visualizations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"python-robust-computing-orig","title":"Chapter 9: Robust Computing Fundamentals - Error Handling and Best Practices","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Computational Methods","level":1},{"slug":"index-1","title":"Computational Methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Machine Learning","level":2},{"slug":"index-2","title":"Machine Learning","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Modern Frameworks","level":2},{"slug":"index-3","title":"Modern Frameworks","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Numerical Methods","level":2},{"slug":"index-4","title":"Numerical Methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Python Fundamentals V1","level":2},{"title":"Python Fundamentals","level":3},{"slug":"index-5","title":"Python Fundamentals","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"slug":"chapter1-python-calculator","title":"Chapter 1: Python as a Scientific Calculator","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"slug":"chapter2-control-flow","title":"Chapter 2: Control Flow \u0026 Logic - Teaching Computers to Think","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"slug":"chapter3-functions","title":"Chapter 3: Functions - The Art of Abstraction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Astrophysics","level":1},{"slug":"index-6","title":"Astrophysics Applications","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Advanced Topics","level":2},{"slug":"index-7","title":"Advanced Topics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Gravitational Dynamics","level":2},{"slug":"index-8","title":"Gravitational Dynamics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Radiative Transfer","level":2},{"slug":"index-9","title":"Radiative Transfer","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Stellar Physics","level":2},{"slug":"index-10","title":"Stellar Physics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Short Projects","level":1},{"slug":"index-11","title":"Short Projects Overview","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"project-submission-guide","title":"ASTR 596: Project Submission Guide","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"project1-description","title":"ASTR 596 Project 1: Python Fundamentals + Numerical Analysis + Stellar Physics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"project2-description","title":"ASTR 596 Project 2: N-Body Dynamics + Statistical Sampling + Stellar Systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"project3-description","title":"ASTR 596 Project 3: Monte Carlo Radiative Transfer + MCMC + Bayesian Statistics","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Final Project","level":1},{"slug":"index-12","title":"Final Project: Neural Networks \u0026 JAX","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"astr596-project-outline","title":"ASTR596: Modeling the Universe - Complete Scaffolded Project Progression","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"final-project-guide","title":"ASTR 596: Final Project Guide","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"Reference","level":1},{"slug":"index-13","title":"Reference Materials","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"cli-advanced-guide","title":"Advanced CLI Guide (Optional)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"title":"External Resources","level":2},{"slug":"index-14","title":"External Resources","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Quick References","level":2},{"slug":"index-15","title":"Quick References","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"title":"Troubleshooting","level":2},{"slug":"index-16","title":"Troubleshooting","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/build/manifest-B2B2E6A5.js";
import * as route0 from "/build/root-IB5726YR.js";
import * as route1 from "/build/routes/$-LXLHKVOR.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/build/entry.client-UNPC4GT3.js");</script></body></html>